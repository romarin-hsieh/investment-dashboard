const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dataVersionService-D9lXNh-_.js","assets/vendor-DopR3Z58.js","assets/utils-C6BRd-cb.js"])))=>i.map(i=>d[i]);
var Cs=Object.defineProperty;var Ts=(n,e,a)=>e in n?Cs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var Ae=(n,e,a)=>Ts(n,typeof e!="symbol"?e+"":e,a);import{c as h,a as t,b as se,d as $,w as xe,r as Ds,e as V,o as u,f as A,g as ft,h as As,i as _,t as l,n as G,j as w,F as E,k as F,l as H,v as pt,m as Je,p as Is,q as me,s as ht,u as ds,x as le,y as xs,z as Ms,A as Ns}from"./vendor-DopR3Z58.js";import{s as x,e as De,u as Ls,l as lt,o as W,n as N,b as J,a as vt,r as Me,c as K,Z as Ps}from"./utils-C6BRd-cb.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function a(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=a(s);fetch(s.href,i)}})();const R=(n,e)=>{const a=n.__vccOpts||n;for(const[o,s]of e)a[o]=s;return a},$s={name:"Layout"},Rs={class:"layout"},Es={class:"header"},Fs={class:"nav"},Os={class:"container"},Us={class:"nav-list"},Vs={class:"main-content"},Ws={class:"container"};function Bs(n,e,a,o,s,i){const r=V("router-link");return u(),h("div",Rs,[t("header",Es,[t("nav",Fs,[t("div",Os,[e[3]||(e[3]=t("div",{class:"nav-brand"},[t("h1",null,"Investment Dashboard")],-1)),t("ul",Us,[t("li",null,[$(r,{to:"/market-overview",class:"nav-link"},{default:xe(()=>[...e[0]||(e[0]=[A("Market Overview",-1)])]),_:1})]),t("li",null,[$(r,{to:"/stock-overview",class:"nav-link"},{default:xe(()=>[...e[1]||(e[1]=[A("Stock Overview",-1)])]),_:1})]),t("li",null,[$(r,{to:"/system-manager",class:"nav-link"},{default:xe(()=>[...e[2]||(e[2]=[A("Control Panel",-1)])]),_:1})])])])])]),t("main",Vs,[t("div",Ws,[Ds(n.$slots,"default",{},void 0)])]),e[4]||(e[4]=se('<footer class="footer" data-v-881562bf><div class="container" data-v-881562bf><div class="footer-content" data-v-881562bf><span class="copyright" data-v-881562bf>¬© 2025 Investment Dashboard POC</span><span class="separator" data-v-881562bf>‚Ä¢</span><span class="attribution" data-v-881562bf> Market data powered by <a href="https://www.tradingview.com/" target="_blank" rel="noopener noreferrer" class="tradingview-link" data-v-881562bf> TradingView </a></span></div></div></footer>',1))])}const qs=R($s,[["render",Bs],["__scopeId","data-v-881562bf"]]),Hs={name:"App",components:{Layout:qs}},zs={id:"app"};function js(n,e,a,o,s,i){const r=V("router-view"),d=V("Layout");return u(),h("div",zs,[$(d,null,{default:xe(()=>[$(r,null,{default:xe(({Component:c,route:g})=>[(u(),ft(As(c),{key:g.path}))]),_:1})]),_:1})])}const Gs=R(Hs,[["render",js]]);class Qs{constructor(){this.preloadedScripts=new Set,this.scriptPromises=new Map}preloadScript(e){if(this.preloadedScripts.has(e))return Promise.resolve();if(this.scriptPromises.has(e))return this.scriptPromises.get(e);const a=new Promise((o,s)=>{const i=document.createElement("link");i.rel="preload",i.as="script",i.href=e,i.crossOrigin="anonymous",i.onload=()=>{this.preloadedScripts.add(e),o()},i.onerror=()=>{s(new Error(`Failed to preload script: ${e}`))},document.head.appendChild(i)});return this.scriptPromises.set(e,a),a}async preloadAllScripts(){const e=["https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js","https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js"];try{await Promise.all(e.map(a=>this.preloadScript(a))),console.log("All TradingView scripts preloaded successfully")}catch(a){console.warn("Some TradingView scripts failed to preload:",a)}}isPreloaded(e){return this.preloadedScripts.has(e)}}const gt=new Qs;typeof window<"u"&&window.addEventListener("load",()=>{setTimeout(()=>{gt.preloadAllScripts()},1e3)});const Ys="modulepreload",Xs=function(n){return"/investment-dashboard/"+n},us={},st=function(e,a,o){let s=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));s=Promise.allSettled(a.map(c=>{if(c=Xs(c),c in us)return;us[c]=!0;const g=c.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${v}`))return;const f=document.createElement("link");if(f.rel=g?"stylesheet":Ys,g||(f.as="script"),f.crossOrigin="",f.href=c,d&&f.setAttribute("nonce",d),document.head.appendChild(f),g)return new Promise((m,T)=>{f.addEventListener("load",m),f.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return s.then(r=>{for(const d of r||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})};let Ks=class{constructor(){this.metrics=new Map,this.startTimes=new Map}start(e){this.startTimes.set(e,performance.now()),console.log(`‚è±Ô∏è Started timing: ${e}`)}end(e){const a=this.startTimes.get(e);if(!a)return console.warn(`No start time found for: ${e}`),null;const o=performance.now()-a;return this.metrics.set(e,o),this.startTimes.delete(e),console.log(`‚úÖ Completed: ${e} - ${o.toFixed(2)}ms`),o}getMetric(e){return this.metrics.get(e)}getAllMetrics(){return Object.fromEntries(this.metrics)}clear(){this.metrics.clear(),this.startTimes.clear()}async measureAsync(e,a){this.start(e);try{const o=await a();return this.end(e),o}catch(o){throw this.end(e),console.error(`‚ùå Error in ${e}:`,o),o}}generateReport(){const e=this.getAllMetrics(),a={timestamp:new Date().toISOString(),metrics:e,summary:{totalOperations:Object.keys(e).length,totalTime:Object.values(e).reduce((o,s)=>o+s,0),averageTime:Object.values(e).reduce((o,s)=>o+s,0)/Object.keys(e).length||0,slowestOperation:this.getSlowestOperation(),fastestOperation:this.getFastestOperation()}};return console.log("üìä Performance Report:",a),a}getSlowestOperation(){let e={name:null,time:0};for(const[a,o]of this.metrics)o>e.time&&(e={name:a,time:o});return e}getFastestOperation(){let e={name:null,time:1/0};for(const[a,o]of this.metrics)o<e.time&&(e={name:a,time:o});return e.time===1/0?{name:null,time:0}:e}checkPerformanceWarnings(){const e=[],a=this.getAllMetrics();Object.entries(a).forEach(([s,i])=>{i>5e3&&e.push({type:"SLOW_OPERATION",operation:s,time:i,message:`Operation "${s}" took ${i.toFixed(2)}ms (>5s)`})});const o=Object.values(a).reduce((s,i)=>s+i,0);return o>1e4&&e.push({type:"SLOW_TOTAL_LOAD",time:o,message:`Total load time ${o.toFixed(2)}ms (>10s)`}),e.length>0&&console.warn("‚ö†Ô∏è Performance Warnings:",e),e}};const Ce=new Ks;class Js{constructor(){this.memoryCache=new Map,this.localStoragePrefix="investment_dashboard_cache_",this.defaultTTL=24*60*60*1e3}set(e,a,o=this.defaultTTL){const s={data:a,timestamp:Date.now(),ttl:o};this.memoryCache.set(e,s);try{localStorage.setItem(this.localStoragePrefix+e,JSON.stringify(s))}catch(i){console.warn("Failed to save to localStorage:",i)}}get(e){if(this.memoryCache.has(e)){const a=this.memoryCache.get(e);if(this.isValid(a))return a.data;this.memoryCache.delete(e)}try{const a=localStorage.getItem(this.localStoragePrefix+e);if(a){const o=JSON.parse(a);if(this.isValid(o))return this.memoryCache.set(e,o),o.data;localStorage.removeItem(this.localStoragePrefix+e)}}catch(a){console.warn("Failed to read from localStorage:",a)}return null}isValid(e){return!e||!e.timestamp?!1:Date.now()-e.timestamp<e.ttl}has(e){return this.get(e)!==null}delete(e){this.memoryCache.delete(e);try{localStorage.removeItem(this.localStoragePrefix+e)}catch(a){console.warn("Failed to remove from localStorage:",a)}}clear(){this.memoryCache.clear();try{Object.keys(localStorage).forEach(a=>{a.startsWith(this.localStoragePrefix)&&localStorage.removeItem(a)})}catch(e){console.warn("Failed to clear localStorage:",e)}}getStats(){const e=this.memoryCache.size;let a=0;try{a=Object.keys(localStorage).filter(s=>s.startsWith(this.localStoragePrefix)).length}catch(o){console.warn("Failed to get localStorage stats:",o)}return{memoryCache:e,localStorage:a,totalSize:e+a}}async preload(e,a,o=this.defaultTTL){if(this.has(e))return this.get(e);try{const s=await a();return this.set(e,s,o),s}catch(s){throw console.error(`Failed to preload data for key ${e}:`,s),s}}async batchPreload(e){const a=new Map,o=e.map(async({key:s,loader:i,ttl:r})=>{try{const d=await this.preload(s,i,r);a.set(s,d)}catch(d){console.error(`Failed to preload ${s}:`,d),a.set(s,null)}});return await Promise.all(o),a}}const X=new Js,et={QUOTES_SNAPSHOT:"quotes_snapshot",DAILY_SNAPSHOT:"daily_snapshot",METADATA_BATCH:"metadata_batch",SYMBOLS_CONFIG:"symbols_config",STOCK_OVERVIEW_DATA:"stock_overview_data"};class Zs{constructor(){this.updateIntervals=new Map,this.isRunning=!1,this.config={technicalIndicators:{enabled:!0,interval:24*60*60*1e3,retryAttempts:3,retryDelay:5*60*1e3},metadata:{enabled:!0,interval:24*60*60*1e3,retryAttempts:2,retryDelay:30*60*1e3},cacheCleanup:{enabled:!0,interval:6*60*60*1e3,maxAge:7*24*60*60*1e3}}}start(){if(this.isRunning){console.log("‚ö†Ô∏è Auto update scheduler is already running");return}console.log("üöÄ Starting auto update scheduler..."),this.isRunning=!0,this.performInitialUpdate(),this.scheduleUpdates(),console.log("‚úÖ Auto update scheduler started successfully")}stop(){if(!this.isRunning){console.log("‚ö†Ô∏è Auto update scheduler is not running");return}console.log("üõë Stopping auto update scheduler...");for(const[e,a]of this.updateIntervals)clearInterval(a),console.log(`   Cleared interval: ${e}`);this.updateIntervals.clear(),this.isRunning=!1,console.log("‚úÖ Auto update scheduler stopped")}async performInitialUpdate(){console.log("üîÑ Performing initial update check...");try{this.config.technicalIndicators.enabled&&await this.checkAndUpdateTechnicalIndicators(),this.config.metadata.enabled&&await this.checkAndUpdateMetadata(),this.config.cacheCleanup.enabled&&await this.performCacheCleanup()}catch(e){console.error("‚ùå Initial update failed:",e)}}scheduleUpdates(){if(this.config.technicalIndicators.enabled){const e=setInterval(()=>this.checkAndUpdateTechnicalIndicators(),this.config.technicalIndicators.interval);this.updateIntervals.set("technicalIndicators",e),console.log(`üìä Scheduled technical indicators update every ${this.config.technicalIndicators.interval/6e4} minutes`)}if(this.config.metadata.enabled){const e=setInterval(()=>this.checkAndUpdateMetadata(),this.config.metadata.interval);this.updateIntervals.set("metadata",e),console.log(`üìã Scheduled metadata update every ${this.config.metadata.interval/36e5} hours`)}if(this.config.cacheCleanup.enabled){const e=setInterval(()=>this.performCacheCleanup(),this.config.cacheCleanup.interval);this.updateIntervals.set("cacheCleanup",e),console.log(`üßπ Scheduled cache cleanup every ${this.config.cacheCleanup.interval/36e5} hours`)}}async checkAndUpdateTechnicalIndicators(){const e="auto_update_technical_indicators";Ce.start(e);try{console.log("üîç Checking technical indicators update...");const{dataVersionService:a}=await st(async()=>{const{dataVersionService:s}=await import("./dataVersionService-D9lXNh-_.js");return{dataVersionService:s}},__vite__mapDeps([0,1,2]));if(await a.checkDataVersionAndRefresh()){console.log("‚úÖ Data version changed - technical indicators refreshed automatically");return}else{console.log("‚úÖ Technical indicators are up to date (version unchanged)");return}}catch(a){console.error("‚ùå Technical indicators version check failed:",a);try{await this.checkTechnicalIndicatorsAge()&&(console.log("üîÑ Fallback: Clearing cache due to data age"),this.clearTechnicalIndicatorsCache())}catch(o){console.error("‚ùå Fallback check also failed:",o)}}finally{Ce.end(e)}}async checkAndUpdateMetadata(){const e="auto_update_metadata";Ce.start(e);try{console.log("üîç Checking metadata update...");const{dataVersionService:a}=await st(async()=>{const{dataVersionService:s}=await import("./dataVersionService-D9lXNh-_.js");return{dataVersionService:s}},__vite__mapDeps([0,1,2]));if(await a.checkDataVersionAndRefresh()){console.log("‚úÖ Data version changed - metadata refreshed automatically");return}else{console.log("‚úÖ Metadata is up to date (version unchanged)");return}}catch(a){console.error("‚ùå Metadata version check failed:",a);try{await this.checkMetadataAge()&&(console.log("üîÑ Fallback: Clearing metadata cache due to age"),this.clearMetadataCache())}catch(o){console.error("‚ùå Metadata fallback check failed:",o)}}finally{Ce.end(e)}}async checkTechnicalIndicatorsAge(){try{const{paths:e}=await st(async()=>{const{paths:d}=await Promise.resolve().then(()=>vs);return{paths:d}},void 0),a=await fetch(e.technicalIndicatorsIndex());if(!a.ok)return console.log("üìä No precomputed data found, update needed"),!0;const o=await a.json(),s=new Date(o.generatedAt),r=(new Date-s)/(1e3*60*60);return console.log(`üìä Technical indicators age: ${r.toFixed(1)} hours`),r>24}catch(e){return console.error("Error checking technical indicators age:",e),!0}}async checkMetadataAge(){try{const e=X.get(et.METADATA_BATCH);if(!e)return!0;const o=(Date.now()-e.timestamp)/(1e3*60*60);return console.log(`üìã Metadata cache age: ${o.toFixed(1)} hours`),o>24}catch(e){return console.error("Error checking metadata age:",e),!0}}async updateTechnicalIndicatorsData(){console.log("üîÑ Technical indicators update requested"),console.log("‚ö†Ô∏è Note: Actual precomputation requires server-side execution");try{this.clearTechnicalIndicatorsCache(),console.log("‚úÖ Technical indicators cache cleared, data will be refreshed on next load")}catch(e){throw console.error("Failed to update technical indicators:",e),e}}async updateMetadataData(){X.delete(et.METADATA_BATCH),console.log("üóëÔ∏è Cleared metadata cache to force refresh")}clearTechnicalIndicatorsCache(){try{const e=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);o&&(o.includes("technical_indicators_")||o.includes("precomputed_")||o.includes("TECHNICAL_INDICATORS")||o.includes("hybrid_technical_"))&&e.push(o)}e.forEach(a=>{localStorage.removeItem(a),console.log(`üóëÔ∏è Cleared cache key: ${a}`)}),typeof X<"u"&&X.clear&&console.log("üóëÔ∏è Cleared performance cache items"),console.log(`‚úÖ Cleared ${e.length} technical indicators cache entries`)}catch(e){console.error("Error clearing technical indicators cache:",e)}}clearMetadataCache(){X.delete(et.METADATA_BATCH),X.delete(et.STOCK_OVERVIEW_DATA),console.log("üóëÔ∏è Cleared metadata and stock overview cache")}async performCacheCleanup(){console.log("üßπ Performing cache cleanup...");try{const e=X.getStats();console.log("üìä Cache stats before cleanup:",e);const a=X.getStats();console.log("üìä Cache stats after cleanup:",a),console.log("‚úÖ Cache cleanup completed")}catch(e){console.error("‚ùå Cache cleanup failed:",e)}}async retryUpdate(e,a){const o=this.config[e];!o||!o.retryAttempts||(console.log(`üîÑ Retrying ${e} update in ${o.retryDelay/6e4} minutes...`),setTimeout(async()=>{try{e==="technicalIndicators"?await this.checkAndUpdateTechnicalIndicators():e==="metadata"&&await this.checkAndUpdateMetadata()}catch(s){console.error(`‚ùå Retry failed for ${e}:`,s)}},o.retryDelay))}getStatus(){return{isRunning:this.isRunning,activeIntervals:Array.from(this.updateIntervals.keys()),config:this.config,nextUpdates:this.getNextUpdateTimes()}}getNextUpdateTimes(){const e=Date.now();return{technicalIndicators:new Date(e+this.config.technicalIndicators.interval),metadata:new Date(e+this.config.metadata.interval),cacheCleanup:new Date(e+this.config.cacheCleanup.interval)}}async triggerManualUpdate(e="all"){console.log(`üîÑ Manual update triggered: ${e}`);try{(e==="all"||e==="technicalIndicators")&&await this.checkAndUpdateTechnicalIndicators(),(e==="all"||e==="metadata")&&await this.checkAndUpdateMetadata(),(e==="all"||e==="cache")&&await this.performCacheCleanup(),console.log("‚úÖ Manual update completed")}catch(a){throw console.error("‚ùå Manual update failed:",a),a}}}const ne=new Zs;typeof window<"u"&&window.location.hostname!=="localhost"&&setTimeout(()=>{ne.start()},3e4);class ea{constructor(){this.baseUrl=this.getCorrectBaseUrl(),this.cache=new Map,this.cacheTimeout=60*60*1e3,this.indexCache=null,this.indexCacheTimestamp=null,this.indexCacheTimeout=10*60*1e3,console.log("PrecomputedIndicatorsAPI initialized:",{hostname:window.location.hostname,pathname:window.location.pathname,baseUrl:this.baseUrl,fullUrl:window.location.href})}getCorrectBaseUrl(){return"/investment-dashboard/data/technical-indicators/"}getTodayString(){return new Date().toISOString().split("T")[0]}async getCachedIndex(){if(this.indexCache&&this.indexCacheTimestamp&&Date.now()-this.indexCacheTimestamp<this.indexCacheTimeout)return console.log("üì¶ Using cached index data"),this.indexCache;try{console.log("üîÑ Loading latest_index.json...");const e=await fetch(`${this.baseUrl}latest_index.json`);if(e.ok){const a=await e.json();return this.indexCache=a,this.indexCacheTimestamp=Date.now(),console.log(`‚úÖ Loaded latest_index.json: ${a.symbols.length} symbols, date: ${a.date}`),a}else return console.warn("‚ö†Ô∏è latest_index.json not found, using fallback"),null}catch(e){return console.error("‚ùå Failed to load latest_index.json:",e),null}}async getTechnicalIndicators(e){var o;const a=`precomputed_${e}`;if(this.cache.has(a)){const s=this.cache.get(a);if(Date.now()-s.timestamp<this.cacheTimeout)return console.log(`üì¶ Using precomputed cache for ${e}`),s.data}try{const s=await this.getCachedIndex();let i=this.getTodayString();if(s&&(i=s.date,!s.symbols.includes(e)))throw new Error(`Symbol ${e} not found in precomputed data`);const r=`${this.baseUrl}${i}_${e}.json`;console.log(`üîç Fetching precomputed data for ${e} from ${r}`);const d=await fetch(r);if(!d.ok)throw new Error(`Precomputed data not found for ${e} (${d.status})`);const c=await d.json(),g={...c.indicators,source:"Precomputed",lastUpdated:c.computedAt,dataAge:this.calculateDataAge(c.computedAt),precomputedDate:c.date,symbol:e};return console.log(`üîç YFinance data check for ${e}:`,{hasYFInRaw:!!(c.indicators&&c.indicators.yf),hasYFInProcessed:!!g.yf,yfKeys:g.yf?Object.keys(g.yf):"none",rawYF:(o=c.indicators)==null?void 0:o.yf}),this.cache.set(a,{data:g,timestamp:Date.now()}),console.log(`‚úÖ Loaded precomputed data for ${e} (date: ${i}, age: ${g.dataAge})`),g}catch(s){throw console.error(`‚ùå Failed to load precomputed data for ${e}:`,s),s}}calculateDataAge(e){const a=new Date,o=new Date(e),s=a-o,i=Math.floor(s/(1e3*60*60)),r=Math.floor(s%(1e3*60*60)/(1e3*60));return i>0?`${i}h ${r}m ago`:`${r}m ago`}async getAvailableData(){return await this.getCachedIndex()}async isPrecomputedDataAvailable(e){try{const a=await this.getCachedIndex();return a&&a.symbols.includes(e)}catch{return!1}}clearCache(){this.cache.clear(),this.indexCache=null,this.indexCacheTimestamp=null,console.log("üóëÔ∏è Cleared all precomputed caches")}getCacheStats(){const e={size:this.cache.size,indexCached:!!this.indexCache,indexAge:this.indexCacheTimestamp?Date.now()-this.indexCacheTimestamp:null,items:[]};for(const[a,o]of this.cache.entries())e.items.push({key:a,age:Date.now()-o.timestamp,expired:Date.now()-o.timestamp>this.cacheTimeout});return e}}const ct=new ea;class ta{constructor(){this.cachePrefix="technical_indicators_",this.cacheTimeout=24*60*60*1e3,this.memoryCache=new Map,this.indexCache=null,this.indexCacheTimestamp=null,this.indexCacheTimeout=5*60*1e3}async getLatestIndexTimestamp(){if(this.indexCache&&this.indexCacheTimestamp&&Date.now()-this.indexCacheTimestamp<this.indexCacheTimeout)return this.indexCache.generatedAt||this.indexCache.yf_updated;try{const a=await fetch(`/investment-dashboard/data/technical-indicators/latest_index.json?t=${Date.now()}`);if(a.ok){const o=await a.json();return this.indexCache=o,this.indexCacheTimestamp=Date.now(),o.yf_updated||o.generatedAt}}catch(e){console.warn("Failed to get latest_index timestamp:",e)}return null}async getCacheKey(e){const a=await this.getLatestIndexTimestamp();if(a){const o=new Date(a).toISOString().split("T")[0];return`${this.cachePrefix}${e}_${o}`}else{const o=new Date().toISOString().split("T")[0];return`${this.cachePrefix}${e}_${o}`}}async getTechnicalIndicators(e){const a=await this.getCacheKey(e),o=await this.getLatestIndexTimestamp();if(this.memoryCache.has(a)){const s=this.memoryCache.get(a);if(o&&s.indexTimestamp!==o)console.log(`Cache invalidated for ${e} due to index update`),this.memoryCache.delete(a);else{if(Date.now()-s.timestamp<this.cacheTimeout)return console.log(`Using memory cache for ${e}`),{...s.data,source:"Daily Cache (Memory)"};this.memoryCache.delete(a)}}try{const s=localStorage.getItem(a);if(s){const i=JSON.parse(s);if(o&&i.indexTimestamp!==o)console.log(`LocalStorage cache invalidated for ${e} due to index update`),localStorage.removeItem(a);else{if(Date.now()-i.timestamp<this.cacheTimeout)return console.log(`Using localStorage cache for ${e}`),this.memoryCache.set(a,i),{...i.data,source:"Daily Cache (LocalStorage)"};localStorage.removeItem(a)}}}catch(s){console.warn(`Failed to read cache for ${e}:`,s)}return null}async setTechnicalIndicators(e,a){const o=await this.getCacheKey(e),s=await this.getLatestIndexTimestamp(),i={data:a,timestamp:Date.now(),symbol:e,date:new Date().toISOString().split("T")[0],indexTimestamp:s};try{localStorage.setItem(o,JSON.stringify(i)),this.memoryCache.set(o,i),console.log(`Cached technical indicators for ${e}`),this.cleanupOldCache()}catch(r){console.warn(`Failed to cache technical indicators for ${e}:`,r)}}cleanupOldCache(){try{const e=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith(this.cachePrefix))try{const s=JSON.parse(localStorage.getItem(o));Date.now()-s.timestamp>this.cacheTimeout&&e.push(o)}catch{e.push(o)}}e.forEach(a=>{localStorage.removeItem(a),console.log(`Removed expired cache: ${a}`)});for(const[a,o]of this.memoryCache.entries())Date.now()-o.timestamp>this.cacheTimeout&&this.memoryCache.delete(a)}catch(e){console.warn("Failed to cleanup old cache:",e)}}async clearSymbolCache(e){const a=await this.getCacheKey(e);localStorage.removeItem(a),this.memoryCache.delete(a),console.log(`Cleared cache for ${e}`)}clearAllCache(){try{const e=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);o&&o.startsWith(this.cachePrefix)&&e.push(o)}e.forEach(a=>localStorage.removeItem(a)),this.memoryCache.clear(),console.log(`Cleared all technical indicators cache (${e.length} items)`)}catch(e){console.warn("Failed to clear all cache:",e)}}getCacheStats(){const e={memoryCache:this.memoryCache.size,localStorageCache:0,totalSize:0};try{for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith(this.cachePrefix)){e.localStorageCache++;const s=localStorage.getItem(o);s&&(e.totalSize+=s.length)}}}catch(a){console.warn("Failed to get cache stats:",a)}return e}}const ge=new ta,it=1e-12;function sa(n){return Math.max(0,Math.min(100,n))}function aa(n,e){const a=new Array(n.length);for(let o=0;o<n.length;o++)if(o<e-1)a[o]=NaN;else{let s=-1/0;for(let i=o-e+1;i<=o;i++)isNaN(n[i])||(s=Math.max(s,n[i]));a[o]=s===-1/0?NaN:s}return a}function na(n,e){const a=new Array(n.length);for(let o=0;o<n.length;o++)if(o<e-1)a[o]=NaN;else{let s=1/0;for(let i=o-e+1;i<=o;i++)isNaN(n[i])||(s=Math.min(s,n[i]));a[o]=s===1/0?NaN:s}return a}function ia(n,e,a="strict",o=null){if(e<=0)throw new Error("Period must be positive");const s=n.length,i=new Array(s).fill(NaN);o===null&&(o=e);for(let r=0;r<s;r++){if(r<e-1)continue;const d=n.slice(r-e+1,r+1);if(a==="strict")d.some(c=>isNaN(c))?i[r]=NaN:i[r]=d.reduce((c,g)=>c+g,0)/d.length;else if(a==="skipna"){const c=d.filter(g=>!isNaN(g));c.length<o?i[r]=NaN:i[r]=c.reduce((g,v)=>g+v,0)/c.length}}return i}function at(n,e,a=null,o="sma_seed",s="strict_recover"){if(e<=0)throw new Error("Period must be positive");const i=n.length,r=new Array(i).fill(NaN);if(a===null&&(a=2/(e+1)),a<=0||a>1)throw new Error("Alpha must be in (0, 1]");if(o==="first_value"){let d=-1;for(let c=0;c<i;c++)if(!isNaN(n[c])){d=c;break}if(d===-1)return r;r[d]=n[d];for(let c=d+1;c<i;c++)isNaN(n[c])?s==="hold_last"?r[c]=r[c-1]:r[c]=NaN:isNaN(r[c-1])?s==="strict_recover"?r[c]=NaN:r[c]=NaN:r[c]=a*n[c]+(1-a)*r[c-1]}else if(o==="sma_seed"){for(let d=0;d<i;d++)if(!(d<e-1))if(d===e-1){const c=n.slice(0,e);c.some(g=>isNaN(g))?r[d]=NaN:r[d]=c.reduce((g,v)=>g+v,0)/c.length}else if(isNaN(n[d]))s==="hold_last"?r[d]=r[d-1]:s==="strict_break"?r[d]=NaN:s==="strict_recover"&&(r[d]=NaN);else if(isNaN(r[d-1]))if(s==="strict_recover"){const c=n.slice(d-e+1,d+1);c.some(g=>isNaN(g))?r[d]=NaN:r[d]=c.reduce((g,v)=>g+v,0)/c.length}else r[d]=NaN;else r[d]=a*n[d]+(1-a)*r[d-1]}return r}function Ie(n,e){if(e<=0)throw new Error("Period must be positive");const a=new Array(n.length);for(let c=0;c<e-1;c++)a[c]=NaN;if(n.length<e)return console.log(`Wilder: Insufficient data length ${n.length} < ${e}`),a;let o=0,s=0,i=[];for(let c=0;c<n.length&&i.length<e;c++)isNaN(n[c])||(i.push(c),o+=n[c],s++);if(console.log(`Wilder: Found ${s} valid values in first ${e} positions for SMA initialization`),s<e)return console.warn(`Wilder: Insufficient valid data for SMA initialization: ${s} < ${e}`),a;const r=Math.max(e-1,i[e-1]);a[r]=o/e,console.log(`Wilder: Initialized at index ${r} with value ${a[r]}`);for(let c=r+1;c<n.length;c++)isNaN(a[c-1])||isNaN(n[c])?a[c]=NaN:a[c]=(a[c-1]*(e-1)+n[c])/e;const d=a.filter(c=>!isNaN(c)).length;return console.log(`Wilder: Generated ${d} valid smoothed values`),a}function dt(n,e=5,a=null,o="sma_seed",s="strict_recover"){return at(n,e,a,o,s)}function ut(n,e=5,a="strict",o=null){return ia(n,e,a,o)}function gs(n,e,a=26){const o=aa(n,a),s=na(e,a),i=new Array(n.length);for(let r=0;r<n.length;r++)isNaN(o[r])||isNaN(s[r])?i[r]=NaN:i[r]=(o[r]+s[r])/2;return i}function oa(n,e,a=9){return gs(n,e,a)}function ra(n,e=26){if(e<0)throw new Error("Shift must be non-negative");const a=new Array(n.length);for(let o=0;o<n.length;o++)o+e<n.length?a[o]=n[o]:a[o]=NaN;return a}function la(n,e,a=20){const o=new Array(n.length);for(let s=0;s<n.length;s++)if(s<a-1)o[s]=NaN;else{let i=0,r=0;for(let d=s-a+1;d<=s;d++)!isNaN(n[d])&&!isNaN(e[d])&&(i+=n[d]*e[d],r+=e[d]);o[s]=r<=it?NaN:i/r}return o}function ca(n,e=14){if(n.length<e+1)return new Array(n.length).fill(NaN);const a=new Array(n.length),o=new Array(n.length),s=new Array(n.length);a[0]=NaN,o[0]=NaN,s[0]=NaN;for(let c=1;c<n.length;c++)isNaN(n[c])||isNaN(n[c-1])?(a[c]=NaN,o[c]=NaN,s[c]=NaN):(a[c]=n[c]-n[c-1],o[c]=Math.max(a[c],0),s[c]=Math.max(-a[c],0));const i=Ie(o.slice(1),e),r=Ie(s.slice(1),e),d=new Array(n.length);d[0]=NaN;for(let c=1;c<n.length;c++){const g=i[c-1],v=r[c-1];if(isNaN(g)||isNaN(v))d[c]=NaN;else if(v<=it)d[c]=100;else{const m=100-100/(1+g/v);d[c]=sa(m)}}return d}function da(n,e,a,o=14){const s=Math.min(n.length,e.length,a.length);if(s<o*2)return console.warn(`ADX: Insufficient data length ${s} < ${o*2} for period ${o}`),{adx:new Array(s).fill(NaN),plusDI:new Array(s).fill(NaN),minusDI:new Array(s).fill(NaN)};let i=0;for(let y=0;y<s;y++)!isNaN(n[y])&&!isNaN(e[y])&&!isNaN(a[y])&&i++;if(console.log(`ADX: Processing ${s} data points, ${i} valid OHLC points`),i<o*2)return console.warn(`ADX: Insufficient valid OHLC data ${i} < ${o*2}`),{adx:new Array(s).fill(NaN),plusDI:new Array(s).fill(NaN),minusDI:new Array(s).fill(NaN)};const r=new Array(s),d=new Array(s),c=new Array(s),g=new Array(s),v=new Array(s);r[0]=NaN,d[0]=NaN,c[0]=NaN,g[0]=NaN,v[0]=NaN;for(let y=1;y<s;y++){if(isNaN(n[y])||isNaN(e[y])||isNaN(a[y])||isNaN(n[y-1])||isNaN(e[y-1])||isNaN(a[y-1])){r[y]=NaN,d[y]=NaN,c[y]=NaN,g[y]=NaN,v[y]=NaN;continue}r[y]=n[y]-n[y-1],d[y]=e[y-1]-e[y],r[y]>d[y]&&r[y]>0?c[y]=r[y]:c[y]=0,d[y]>r[y]&&d[y]>0?g[y]=d[y]:g[y]=0;const O=n[y]-e[y],C=Math.abs(n[y]-a[y-1]),M=Math.abs(e[y]-a[y-1]);v[y]=Math.max(O,C,M)}const f=Ie(v.slice(1),o),m=Ie(c.slice(1),o),T=Ie(g.slice(1),o);console.log(`ADX: Wilder smoothing results - TR valid: ${f.filter(y=>!isNaN(y)).length}, +DM valid: ${m.filter(y=>!isNaN(y)).length}, -DM valid: ${T.filter(y=>!isNaN(y)).length}`);const S=new Array(s),D=new Array(s),b=new Array(s);S[0]=NaN,D[0]=NaN,b[0]=NaN;for(let y=1;y<s;y++){const O=f[y-1],C=m[y-1],M=T[y-1];if(isNaN(O)||isNaN(C)||isNaN(M)||O<=it)S[y]=NaN,D[y]=NaN,b[y]=NaN;else{S[y]=100*C/O,D[y]=100*M/O;const p=S[y]+D[y];p<=it?b[y]=NaN:b[y]=100*Math.abs(S[y]-D[y])/p}}const P=Ie(b.slice(1),o);console.log(`ADX: Final ADX smoothing - DX valid: ${b.filter(y=>!isNaN(y)).length}, ADX valid: ${P.filter(y=>!isNaN(y)).length}`);const I=new Array(s);I[0]=NaN;for(let y=1;y<s;y++)I[y]=P[y-1];const L=I.filter(y=>!isNaN(y)).length;return console.log(`ADX: Final result - ${L} valid ADX values out of ${s} total`),{adx:I,plusDI:S,minusDI:D}}function ua(n,e=12,a=26,o=9){a<=e&&console.warn("Slow period should be greater than fast period");const s=at(n,e),i=at(n,a),r=new Array(n.length);for(let g=0;g<n.length;g++)isNaN(s[g])||isNaN(i[g])?r[g]=NaN:r[g]=s[g]-i[g];const d=at(r,o),c=new Array(n.length);for(let g=0;g<n.length;g++)isNaN(r[g])||isNaN(d[g])?c[g]=NaN:c[g]=r[g]-d[g];return{macd:r,signal:d,histogram:c}}function ha(n){const{open:e,high:a,low:o,close:s,volume:i}=n,r=s.length;if(a.length!==r||o.length!==r||e.length!==r||i.length!==r)throw new Error("All OHLCV arrays must have the same length");const d={MA_5:dt(s,5),MA_10:dt(s,10),MA_30:dt(s,30),SMA_5:ut(s,5),SMA_10:ut(s,10),SMA_30:ut(s,30),ICHIMOKU_BASELINE_26:gs(a,o,26),ICHIMOKU_CONVERSIONLINE_9:oa(a,o,9),ICHIMOKU_LAGGINGSPAN_26:ra(s,26),VWMA_20:la(s,i,20),RSI_14:ca(s,14),...(()=>{const c=ua(s,12,26,9);return{MACD_12_26_9:c.macd,MACD_SIGNAL_9:c.signal,MACD_HIST:c.histogram}})(),...(()=>{const c=da(a,o,s,14);return{ADX_14:c.adx,ADX_14_PLUS_DI:c.plusDI,ADX_14_MINUS_DI:c.minusDI}})()};for(const[c,g]of Object.entries(d))g.length!==r&&console.error(`Length mismatch for ${c}: expected ${r}, got ${g.length}`);return d}class ga{constructor(){this.corsProxies=["https://api.allorigins.win/raw?url=","https://corsproxy.io/?","https://cors.sh/","https://proxy-cors.isomorphic-git.org/","https://thingproxy.freeboard.io/fetch/","https://cors-proxy.htmldriven.com/?url=","https://cors-anywhere.herokuapp.com/"],this.baseUrl="https://query1.finance.yahoo.com/v8/finance/chart/",this.cache=new Map,this.cacheTimeout=5*60*1e3,this.currentProxyIndex=0}async getTechnicalIndicators(e){const a=await ge.getTechnicalIndicators(e);if(a)return a;const o=await this.fetchTechnicalIndicatorsFromAPI(e);return o&&!o.error&&await ge.setTechnicalIndicators(e,o),o}async fetchTechnicalIndicatorsFromAPI(e){var o,s;const a=`technical_${e}`;if(this.cache.has(a)){const i=this.cache.get(a);if(Date.now()-i.timestamp<this.cacheTimeout)return console.log(`Using cached data for ${e}`),i.data}for(let i=0;i<this.corsProxies.length;i++)try{const r=(this.currentProxyIndex+i)%this.corsProxies.length,d=this.corsProxies[r];console.log(`Fetching data for ${e} using proxy ${r+1}...`);const c=`${this.baseUrl}${e}?interval=1d&range=6mo&indicators=quote&includePrePost=false`,g=`${d}${encodeURIComponent(c)}`;console.log(`Request URL: ${g}`);const v=await fetch(g,{method:"GET"});if(console.log(`Response status: ${v.status}`),!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const f=await v.json();if(console.log("Raw data structure:",f),!f.chart||!f.chart.result||f.chart.result.length===0)throw new Error("No chart data available");const m=f.chart.result[0];if(!m.indicators||!m.indicators.quote||!m.indicators.quote[0])throw new Error("Invalid data structure - missing indicators");const T=m.indicators.quote[0],S={open:T.open||[],high:T.high||[],low:T.low||[],close:T.close||[],volume:T.volume||[]},D=S.close.length,b={open:new Array(D),high:new Array(D),low:new Array(D),close:new Array(D),volume:new Array(D)};let P=0;for(let C=0;C<D;C++)b.open[C]=S.open[C]!==null?S.open[C]:NaN,b.high[C]=S.high[C]!==null?S.high[C]:NaN,b.low[C]=S.low[C]!==null?S.low[C]:NaN,b.close[C]=S.close[C]!==null?S.close[C]:NaN,b.volume[C]=S.volume[C]!==null?S.volume[C]:NaN,!isNaN(b.open[C])&&!isNaN(b.high[C])&&!isNaN(b.low[C])&&!isNaN(b.close[C])&&P++;if(console.log(`Found ${D} total data points, ${P} valid OHLC points for ${e}`),P<28&&console.warn(`‚ö†Ô∏è Insufficient valid data for ADX calculation: ${P} < 28`),D<50)throw new Error(`Insufficient data points (${D}) for technical analysis`);const I=ha(b),L=C=>{if(!C||!Array.isArray(C))return console.warn("getLastValue: Invalid series data"),null;for(let M=C.length-1;M>=0;M--){const p=C[M];if(p!=null&&!isNaN(p)&&isFinite(p))return console.log(`getLastValue: Found valid value ${p} at index ${M} of ${C.length}`),p}return console.warn(`getLastValue: No valid values found in series of length ${C.length}`),null},y=(C,M=null)=>{const p=L(C),B=L(b.close);let j="NEUTRAL";return M&&p!==null&&B!==null&&(M.type==="price_comparison"?B>p*M.buy?j="BUY":B<p*M.sell&&(j="SELL"):M.type==="rsi"?p>M.overbought?j="OVERBOUGHT":p<M.oversold&&(j="OVERSOLD"):M.type==="adx"&&(p>M.strong?j="STRONG_TREND":p<M.weak&&(j="WEAK_TREND"))),{value:p!==null?p.toFixed(2):null,signal:j,currentPrice:B!==null?B.toFixed(2):null}},O={ma5:y(I.MA_5,{type:"price_comparison",buy:1.02,sell:.98}),sma5:y(I.SMA_5,{type:"price_comparison",buy:1.02,sell:.98}),ma10:y(I.MA_10,{type:"price_comparison",buy:1.02,sell:.98}),sma10:y(I.SMA_10,{type:"price_comparison",buy:1.02,sell:.98}),ma30:y(I.MA_30,{type:"price_comparison",buy:1.02,sell:.98}),sma30:y(I.SMA_30,{type:"price_comparison",buy:1.02,sell:.98}),sma50:{value:null,signal:"N/A"},ichimokuBaseLine:y(I.ICHIMOKU_BASELINE_26,{type:"price_comparison",buy:1.01,sell:.99}),ichimokuConversionLine:y(I.ICHIMOKU_CONVERSIONLINE_9,{type:"price_comparison",buy:1.01,sell:.99}),ichimokuLaggingSpan:y(I.ICHIMOKU_LAGGINGSPAN_26),vwma20:y(I.VWMA_20,{type:"price_comparison",buy:1.02,sell:.98}),rsi14:y(I.RSI_14,{type:"rsi",overbought:70,oversold:30}),adx14:(()=>{console.log("üîç Processing ADX results..."),console.log("ADX_14 series:",I.ADX_14),console.log("ADX_14_PLUS_DI series:",I.ADX_14_PLUS_DI),console.log("ADX_14_MINUS_DI series:",I.ADX_14_MINUS_DI);const C=L(I.ADX_14),M=L(I.ADX_14_PLUS_DI),p=L(I.ADX_14_MINUS_DI);console.log("ADX extracted values:",{adxValue:C,plusDI:M,minusDI:p});let B="NEUTRAL";C!==null&&!isNaN(C)&&(C>25?B="STRONG_TREND":C<20&&(B="WEAK_TREND"));const j={value:C!==null&&!isNaN(C)?C.toFixed(2):null,signal:B,plusDI:M!==null&&!isNaN(M)?M.toFixed(2):null,minusDI:p!==null&&!isNaN(p)?p.toFixed(2):null};return console.log("ADX final result:",j),j})(),macd:(()=>{const C=L(I.MACD_12_26_9),M=L(I.MACD_SIGNAL_9),p=L(I.MACD_HIST);let B="NEUTRAL";return C!==null&&M!==null&&p!==null&&(C>M&&p>0?B="BUY":C<M&&p<0&&(B="SELL")),{value:C!==null?C.toFixed(2):null,signal:B,signalLine:M!==null?M.toFixed(2):null,histogram:p!==null?p.toFixed(2):null}})(),lastUpdated:new Date().toISOString(),dataPoints:D,proxy:`Proxy ${r+1}`,source:"Yahoo Finance API (Fresh) - Core v1.0.0",fullSeries:I,priceRange:{min:Math.min(...b.close.filter(C=>!isNaN(C))).toFixed(2),max:Math.max(...b.close.filter(C=>!isNaN(C))).toFixed(2),latest:((o=L(b.close))==null?void 0:o.toFixed(2))||"N/A",first:((s=b.close.find(C=>!isNaN(C)))==null?void 0:s.toFixed(2))||"N/A"}};return console.log(`Price data for ${e}:`,{dataPoints:D,priceRange:O.priceRange,samplePrices:b.close.slice(-10).filter(C=>!isNaN(C))}),console.log(`Calculated indicators for ${e}:`,O),this.cache.set(a,{data:O,timestamp:Date.now()}),this.currentProxyIndex=r,O}catch(r){if(console.warn(`Proxy ${i+1} failed for ${e}:`,r.message),i===this.corsProxies.length-1)return console.error(`All proxies failed for ${e}:`,r),{ma5:{value:null,signal:"N/A"},sma5:{value:null,signal:"N/A"},ma10:{value:null,signal:"N/A"},sma10:{value:null,signal:"N/A"},ma30:{value:null,signal:"N/A"},sma30:{value:null,signal:"N/A"},sma50:{value:null,signal:"N/A"},ichimokuBaseLine:{value:null,signal:"N/A"},ichimokuConversionLine:{value:null,signal:"N/A"},ichimokuLaggingSpan:{value:null,signal:"N/A"},vwma20:{value:null,signal:"N/A"},rsi14:{value:null,signal:"N/A"},adx14:{value:null,signal:"N/A"},macd:{value:null,signal:"N/A"},lastUpdated:new Date().toISOString(),error:`All proxies failed: ${r.message}`,source:"Error"}}}clearCache(){this.cache.clear()}async getStockInfo(e){const a=`info_${e}`,o=24*60*60*1e3;if(this.cache.has(a)){const s=this.cache.get(a);if(Date.now()-s.timestamp<o)return console.log(`Using cached stock info for ${e}`),s.data}for(let s=0;s<this.corsProxies.length;s++)try{const i=(this.currentProxyIndex+s)%this.corsProxies.length,r=this.corsProxies[i];console.log(`Fetching stock info for ${e} using proxy ${i+1}...`);const d=`https://query1.finance.yahoo.com/v10/finance/quoteSummary/${e}?modules=summaryProfile,price,defaultKeyStatistics`,c=`${r}${encodeURIComponent(d)}`,g=await fetch(c,{method:"GET"});if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const v=await g.json();if(!v.quoteSummary||!v.quoteSummary.result||v.quoteSummary.result.length===0)throw new Error("No quoteSummary data available");const f=v.quoteSummary.result[0],m=f.summaryProfile||{},T=f.price||{},S=f.defaultKeyStatistics||{},D={symbol:e,sector:m.sector||"Unknown",industry:m.industry||"Unknown Industry",exchange:T.exchangeName||T.exchange||this.getDefaultExchange(e),marketCap:T.marketCap?T.marketCap.raw:null,marketCapFormatted:T.marketCap?T.marketCap.fmt:"N/A",currency:T.currency||"USD",country:m.country||"Unknown",website:m.website||null,employees:m.fullTimeEmployees||null,businessSummary:m.longBusinessSummary||null,marketCapCategory:this.getMarketCapCategory(T.marketCap?T.marketCap.raw:null),lastUpdated:new Date().toISOString(),source:"Yahoo Finance API (Live)",proxy:`Proxy ${i+1}`,confidence:.95};return console.log(`Stock info for ${e}:`,D),this.cache.set(a,{data:D,timestamp:Date.now()}),this.currentProxyIndex=i,D}catch(i){if(console.warn(`Proxy ${s+1} failed for stock info ${e}:`,i.message),s===this.corsProxies.length-1){console.error(`All proxies failed for stock info ${e}:`,i);const r={symbol:e,sector:"Unknown",industry:"Unknown Industry",exchange:this.getDefaultExchange(e),marketCap:null,marketCapFormatted:"N/A",currency:"USD",country:"Unknown",website:null,employees:null,businessSummary:null,marketCapCategory:"unknown",lastUpdated:new Date().toISOString(),source:"Default (API Failed)",error:`All proxies failed: ${i.message}`,confidence:0};return this.cache.set(a,{data:r,timestamp:Date.now()}),r}}}getDefaultExchange(e){const a=["AAPL","MSFT","GOOGL","GOOG","AMZN","TSLA","NVDA","META","NFLX","RKLB","ASTS","RIVN","MDB","ONDS","PL","AVAV","CRM","AVGO","LEU","SMR","CRWV","IONQ","PLTR","HIMS"],o=["TSM","ORCL","RDW"];return a.includes(e)?"NASDAQ":o.includes(e)?"NYSE":"NASDAQ"}getMarketCapCategory(e){return!e||e<=0?"unknown":e>=2e11?"mega_cap":e>=1e10?"large_cap":e>=2e9?"mid_cap":e>=3e8?"small_cap":"micro_cap"}clearDailyCache(){ge.clearAllCache()}getCacheStats(){const e={};for(const[a,o]of this.cache.entries())e[a]={age:Date.now()-o.timestamp,expired:Date.now()-o.timestamp>this.cacheTimeout};return{apiCache:e,dailyCache:ge.getCacheStats()}}buildProxyUrl(e){return`${this.corsProxies[this.currentProxyIndex]}${encodeURIComponent(e)}`}async getOhlcv(e,a="1d",o="3mo"){const s=`ohlcv_${e}_${a}_${o}`;if(this.cache.has(s)){const i=this.cache.get(s);if(Date.now()-i.timestamp<this.cacheTimeout)return console.log(`üìä Using cached OHLCV data for ${e}`),i.data}for(let i=0;i<this.corsProxies.length;i++)try{const r=(this.currentProxyIndex+i)%this.corsProxies.length,d=this.corsProxies[r];console.log(`üìä Fetching OHLCV data for ${e} using proxy ${r+1}...`);const c=`${this.baseUrl}${e}?interval=${a}&range=${o}&indicators=quote&includePrePost=false`,g=this.buildProxyUrl(c),v=await fetch(g,{method:"GET"});if(!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const f=await v.json();if(!f.chart||!f.chart.result||f.chart.result.length===0)throw new Error("No chart data available");const m=f.chart.result[0];if(!m.indicators||!m.indicators.quote||!m.indicators.quote[0])throw new Error("Invalid data structure - missing indicators");const T=m.indicators.quote[0],D={timestamps:m.timestamp||[],open:T.open||[],high:T.high||[],low:T.low||[],close:T.close||[],volume:T.volume||[]},b=D.timestamps.length;if(b<20)throw new Error(`Insufficient OHLCV data points: ${b} < 20`);let P=0;for(let L=0;L<b;L++)D.open[L]!=null&&D.high[L]!=null&&D.low[L]!=null&&D.close[L]!=null&&D.volume[L]!=null&&P++;if(console.log(`üìä OHLCV data for ${e}: ${b} total points, ${P} valid points`),P<15)throw new Error(`Insufficient valid OHLCV data: ${P} < 15`);const I={...D,metadata:{symbol:e,period:a,range:o,totalPoints:b,validPoints:P,fetchedAt:new Date().toISOString(),source:"Yahoo Finance API",proxy:`Proxy ${r+1}`}};return this.cache.set(s,{data:I,timestamp:Date.now()}),this.currentProxyIndex=r,I}catch(r){if(console.warn(`üìä Proxy ${i+1} failed for OHLCV ${e}:`,r.message),i===this.corsProxies.length-1)throw console.error(`üìä All proxies failed for OHLCV ${e}:`,r),new Error(`Failed to fetch OHLCV data: ${r.message}`)}}}const ie=new ga;class ma{constructor(){this.preferPrecomputed=!0,this.maxPrecomputedAge=24*60*60*1e3,this.fallbackToRealtime=!0}async getTechnicalIndicators(e){console.log(`üîç Getting technical indicators for ${e}`);try{if(this.preferPrecomputed){const o=await this.tryPrecomputedData(e);if(o&&this.isADXValid(o))return console.log(`‚úÖ Using precomputed data with valid ADX for ${e}`),console.log(`üîç YFinance data check for ${e}:`,{hasYF:!!o.yf,yfKeys:o.yf?Object.keys(o.yf):"none"}),o;o&&console.log(`‚ö†Ô∏è Precomputed data has invalid ADX for ${e}, falling back to real-time`)}const a=await ge.getTechnicalIndicators(e);if(a&&this.isADXValid(a))return console.log(`üì¶ Using daily cache with valid ADX for ${e}`),a;if(a&&console.log(`‚ö†Ô∏è Cached data has invalid ADX for ${e}, falling back to real-time`),this.fallbackToRealtime){console.log(`‚ö° Using real-time calculation for ${e}`);const o=await ie.fetchTechnicalIndicatorsFromAPI(e);if(o&&!o.error)return await ge.setTechnicalIndicators(e,o),o}throw new Error("All data sources failed")}catch(a){return console.error(`‚ùå Failed to get technical indicators for ${e}:`,a),this.createErrorResponse(e,a.message)}}isADXValid(e){if(!e||!e.adx14)return!1;const a=e.adx14.value;if(a==null||a==="N/A")return!1;if(e.fullSeries&&e.fullSeries.ADX_14){const s=e.fullSeries.ADX_14.filter(i=>i!=null&&!isNaN(i)).length;if(s<5)return console.log(`ADX validation failed: only ${s} valid values`),!1}return!0}async tryPrecomputedData(e){try{console.log(`üîÑ Trying precomputed data for ${e}`);const a=await ct.getTechnicalIndicators(e),o=new Date(a.lastUpdated);return Date.now()-o.getTime()<=this.maxPrecomputedAge?(console.log(`‚úÖ Using precomputed data for ${e} (${a.dataAge})`),{...a,source:`Precomputed (${a.dataAge})`,loadTime:"<50ms"}):(console.log(`‚è∞ Precomputed data too old for ${e} (${a.dataAge})`),null)}catch(a){return console.log(`‚ùå Precomputed data not available for ${e}: ${a.message}`),null}}createErrorResponse(e,a){return{ma5:{value:null,signal:"N/A"},sma5:{value:null,signal:"N/A"},ma10:{value:null,signal:"N/A"},sma10:{value:null,signal:"N/A"},ma30:{value:null,signal:"N/A"},sma30:{value:null,signal:"N/A"},sma50:{value:null,signal:"N/A"},ichimokuBaseLine:{value:null,signal:"N/A"},ichimokuConversionLine:{value:null,signal:"N/A"},ichimokuLaggingSpan:{value:null,signal:"N/A"},vwma20:{value:null,signal:"N/A"},rsi14:{value:null,signal:"N/A"},adx14:{value:null,signal:"N/A"},macd:{value:null,signal:"N/A"},lastUpdated:new Date().toISOString(),error:a,source:"Error",symbol:e}}async refreshTechnicalIndicators(e){console.log(`üîÑ Force refreshing data for ${e}`),ge.clearSymbolCache(e),ct.clearCache();const a=this.fallbackToRealtime,o=this.preferPrecomputed;this.fallbackToRealtime=!0,this.preferPrecomputed=!1;try{return await this.getTechnicalIndicators(e)}finally{this.fallbackToRealtime=a,this.preferPrecomputed=o}}async getBatchTechnicalIndicators(e,a=3){const o=new Map,s=[];for(let i=0;i<e.length;i+=a)s.push(e.slice(i,i+a));console.log(`üì¶ Processing ${e.length} symbols in ${s.length} batches`);for(const i of s){const r=i.map(async c=>{try{const g=await this.getTechnicalIndicators(c);return{symbol:c,success:!0,data:g}}catch(g){return{symbol:c,success:!1,error:g.message}}});(await Promise.all(r)).forEach(c=>{o.set(c.symbol,c)}),s.indexOf(i)<s.length-1&&await new Promise(c=>setTimeout(c,100))}return o}async getDataSourceStatus(){const e={precomputed:{available:!1,symbols:[],lastUpdate:null},cache:ge.getCacheStats(),realtime:{available:!0,proxies:ie.corsProxies.length}};try{const a=await ct.getAvailableData();a&&(e.precomputed={available:!0,symbols:a.symbols,lastUpdate:a.generatedAt,successful:a.successful,failed:a.failed})}catch(a){console.warn("Failed to get precomputed status:",a)}return e}setPreferences(e){e.preferPrecomputed!==void 0&&(this.preferPrecomputed=e.preferPrecomputed),e.fallbackToRealtime!==void 0&&(this.fallbackToRealtime=e.fallbackToRealtime),e.maxPrecomputedAge!==void 0&&(this.maxPrecomputedAge=e.maxPrecomputedAge),console.log("Updated preferences:",{preferPrecomputed:this.preferPrecomputed,fallbackToRealtime:this.fallbackToRealtime,maxPrecomputedAge:this.maxPrecomputedAge})}}const Te=new ma;class fa{constructor(){this.isWarming=!1,this.warmupProgress=0,this.warmupResults=new Map,this.warmupStartTime=null,this.warmupEndTime=null,this.config={maxConcurrent:2,batchDelay:2e3,retryAttempts:2,retryDelay:5e3,enableAutoWarmup:this.isProductionEnvironment(),warmupOnVersionChange:!1,warmupOnFirstLoad:!1,warmupInterval:24*60*60*1e3,minCacheCoverage:.95},this.trackedSymbols=["ASTS","RIVN","PL","ONDS","RDW","AVAV","MDB","ORCL","TSM","RKLB","CRM","NVDA","AVGO","AMZN","GOOG","META","NFLX","LEU","SMR","CRWV","IONQ","PLTR","HIMS","TSLA"]}async start(){if(console.log("üî• Starting Cache Warmup Service..."),!this.isProductionEnvironment()){console.log("üö´ Cache warmup disabled in development environment");return}try{const e=await this.shouldPerformWarmup();e.needed?(console.log(`üî• Warmup needed: ${e.reason}`),await this.performWarmup()):console.log("‚úÖ Cache warmup not needed"),this.config.enableAutoWarmup&&this.schedulePeriodicWarmup()}catch(e){console.error("‚ùå Failed to start cache warmup service:",e)}}async shouldPerformWarmup(){try{const e=await this.getCurrentVersion(),a=this.getLastWarmupVersion();if(this.config.warmupOnVersionChange&&e!==a)return{needed:!0,reason:`Version changed from ${a} to ${e}`};const o=this.getLastWarmupTime();if(this.config.warmupOnFirstLoad&&!o)return{needed:!0,reason:"First load - no previous warmup found"};if(o){const i=Date.now()-o;if(i>this.config.warmupInterval)return{needed:!0,reason:`Time interval exceeded (${Math.round(i/36e5)}h ago)`}}const s=await this.getCacheStats();return s.coverage<this.config.minCacheCoverage?{needed:!0,reason:`Low cache coverage (${Math.round(s.coverage*100)}%)`}:{needed:!1,reason:"Cache is fresh and complete"}}catch(e){return console.error("Error checking warmup need:",e),{needed:!0,reason:"Error checking - performing warmup as fallback"}}}async performWarmup(){if(this.isWarming)return console.log("‚ö†Ô∏è Warmup already in progress"),this.warmupResults;console.log(`üî• Starting cache warmup for ${this.trackedSymbols.length} symbols...`),this.isWarming=!0,this.warmupProgress=0,this.warmupResults.clear(),this.warmupStartTime=Date.now();const e="cache_warmup_total";Ce.start(e);try{const a=this.createBatches(this.trackedSymbols,this.config.maxConcurrent);for(let i=0;i<a.length;i++){const r=a[i];console.log(`üî• Processing batch ${i+1}/${a.length}: ${r.join(", ")}`);const d=r.map(g=>this.warmupSymbol(g));(await Promise.all(d)).forEach((g,v)=>{this.warmupResults.set(r[v],g)}),this.warmupProgress=(i+1)/a.length*100,console.log(`üìä Warmup progress: ${Math.round(this.warmupProgress)}%`),i<a.length-1&&(console.log(`‚è≥ Waiting ${this.config.batchDelay}ms before next batch...`),await this.sleep(this.config.batchDelay))}this.warmupEndTime=Date.now();const o=this.warmupEndTime-this.warmupStartTime,s=this.getWarmupStats();return console.log(`üéâ Cache warmup completed in ${Math.round(o/1e3)}s`),console.log(`üìä Results: ${s.successful}/${s.total} successful (${s.successRate}%)`),this.saveWarmupRecord(s),this.warmupResults}catch(a){throw console.error("‚ùå Cache warmup failed:",a),a}finally{this.isWarming=!1,Ce.end(e)}}async warmupSymbol(e,a=1){const o=Date.now();try{console.log(`üî• Warming up ${e} (attempt ${a}/${this.config.retryAttempts+1})`);const s=await Te.getTechnicalIndicators(e),i=Date.now()-o;if(s&&!s.error)return console.log(`‚úÖ ${e} warmed up successfully in ${i}ms (${s.source})`),{success:!0,duration:i,source:s.source,timestamp:new Date().toISOString()};throw new Error((s==null?void 0:s.error)||"Unknown error")}catch(s){return console.error(`‚ùå Failed to warm up ${e} (attempt ${a}): ${s.message}`),a<=this.config.retryAttempts?(console.log(`üîÑ Retrying ${e} in ${this.config.retryDelay}ms...`),await this.sleep(this.config.retryDelay),this.warmupSymbol(e,a+1)):{success:!1,error:s.message,duration:Date.now()-o,timestamp:new Date().toISOString()}}}createBatches(e,a){const o=[];for(let s=0;s<e.length;s+=a)o.push(e.slice(s,s+a));return o}async getCurrentVersion(){try{const e=this.getPackageJsonUrl(),a=await fetch(e);if(a.ok)return(await a.json()).version||"1.0.0"}catch(e){return console.warn("Failed to fetch package.json:",e),Date.now().toString()}return"1.0.0"}getPackageJsonUrl(){return st(async()=>{const{paths:a}=await Promise.resolve().then(()=>vs);return{paths:a}},void 0).then(({paths:a})=>a.packageJson()),"/investment-dashboard/package.json"}getLastWarmupVersion(){return localStorage.getItem("cache_warmup_version")||null}getLastWarmupTime(){const e=localStorage.getItem("cache_warmup_time");return e?parseInt(e):null}async getCacheStats(){let e=0;for(const a of this.trackedSymbols)try{X.get(`technical_indicators_${a}`)&&e++}catch{}return{total:this.trackedSymbols.length,cached:e,coverage:e/this.trackedSymbols.length}}getWarmupStats(){const e=Array.from(this.warmupResults.values()),a=e.filter(s=>s.success).length,o=e.filter(s=>!s.success).length;return{total:e.length,successful:a,failed:o,successRate:Math.round(a/e.length*100),duration:this.warmupEndTime-this.warmupStartTime,averageDuration:e.reduce((s,i)=>s+i.duration,0)/e.length}}saveWarmupRecord(e){const a=this.getCurrentVersion();localStorage.setItem("cache_warmup_version",a),localStorage.setItem("cache_warmup_time",Date.now().toString()),localStorage.setItem("cache_warmup_stats",JSON.stringify(e)),console.log("üíæ Warmup record saved")}schedulePeriodicWarmup(){console.log(`‚è∞ Scheduled periodic warmup every ${this.config.warmupInterval/36e5} hours`),setInterval(async()=>{console.log("‚è∞ Periodic warmup triggered");try{await this.performWarmup()}catch(e){console.error("‚ùå Periodic warmup failed:",e)}},this.config.warmupInterval)}async triggerManualWarmup(){return console.log("üî• Manual warmup triggered"),this.performWarmup()}getWarmupStatus(){return{isWarming:this.isWarming,progress:this.warmupProgress,results:Object.fromEntries(this.warmupResults),lastWarmupTime:this.getLastWarmupTime(),lastWarmupVersion:this.getLastWarmupVersion(),trackedSymbols:this.trackedSymbols,config:this.config}}sleep(e){return new Promise(a=>setTimeout(a,e))}isProductionEnvironment(){return!0}updateConfig(e){this.config={...this.config,...e},console.log("üîß Cache warmup config updated:",this.config)}addTrackedSymbol(e){this.trackedSymbols.includes(e)||(this.trackedSymbols.push(e),console.log(`‚ûï Added ${e} to tracked symbols`))}removeTrackedSymbol(e){const a=this.trackedSymbols.indexOf(e);a>-1&&(this.trackedSymbols.splice(a,1),console.log(`‚ûñ Removed ${e} from tracked symbols`))}}const mt=new fa;class pa{constructor(){this.maxConcurrent=3,this.currentLoading=0,this.queue=[],this.loadingWidgets=new Set,this.stats={totalRequests:0,completedRequests:0,failedRequests:0,averageLoadTime:0,loadTimes:[]}}async addToQueue(e,a,o=2){return new Promise((s,i)=>{const r={id:a,loadFunction:e,priority:o,resolve:s,reject:i,createdAt:Date.now()};if(this.loadingWidgets.has(a)){console.warn(`Widget ${a} is already loading, skipping duplicate request`),i(new Error("Widget already loading"));return}this.insertByPriority(r),this.stats.totalRequests++,console.log(`WidgetLoadManager: Added ${a} to queue (priority: ${o}, queue size: ${this.queue.length})`),this.processQueue()})}insertByPriority(e){let a=this.queue.length;for(let o=0;o<this.queue.length;o++)if(e.priority<this.queue[o].priority){a=o;break}this.queue.splice(a,0,e)}async processQueue(){if(this.currentLoading>=this.maxConcurrent||this.queue.length===0)return;const e=this.queue.shift();this.currentLoading++,this.loadingWidgets.add(e.id);const a=Date.now();console.log(`WidgetLoadManager: Starting load for ${e.id} (${this.currentLoading}/${this.maxConcurrent} slots used)`);try{await e.loadFunction();const o=Date.now()-a;this.updateStats(o,!0),console.log(`WidgetLoadManager: Successfully loaded ${e.id} in ${o}ms`),e.resolve()}catch(o){const s=Date.now()-a;this.updateStats(s,!1),console.error(`WidgetLoadManager: Failed to load ${e.id} after ${s}ms:`,o),e.reject(o)}finally{this.currentLoading--,this.loadingWidgets.delete(e.id),setTimeout(()=>this.processQueue(),100)}}updateStats(e,a){a?this.stats.completedRequests++:this.stats.failedRequests++,this.stats.loadTimes.push(e),this.stats.loadTimes.length>100&&this.stats.loadTimes.shift(),this.stats.averageLoadTime=this.stats.loadTimes.reduce((o,s)=>o+s,0)/this.stats.loadTimes.length}cancelWidget(e){const a=this.queue.findIndex(o=>o.id===e);return a!==-1?(this.queue.splice(a,1)[0].reject(new Error("Widget load cancelled")),console.log(`WidgetLoadManager: Cancelled queued widget ${e}`),!0):!1}clearQueue(){const e=this.queue.length;this.queue.forEach(a=>{a.reject(new Error("Queue cleared"))}),this.queue=[],console.log(`WidgetLoadManager: Cleared queue, cancelled ${e} tasks`)}getStatus(){return{currentLoading:this.currentLoading,queueSize:this.queue.length,maxConcurrent:this.maxConcurrent,stats:{...this.stats}}}setMaxConcurrent(e){this.maxConcurrent=Math.max(1,Math.min(10,e)),console.log(`WidgetLoadManager: Max concurrent set to ${this.maxConcurrent}`),this.currentLoading<this.maxConcurrent&&this.processQueue()}resetStats(){this.stats={totalRequests:0,completedRequests:0,failedRequests:0,averageLoadTime:0,loadTimes:[]},console.log("WidgetLoadManager: Stats reset")}}const yt=new pa,va={name:"LazyTradingViewWidget",props:{widgetType:{type:String,required:!0},config:{type:Object,required:!0},scriptUrl:{type:String,required:!0},height:{type:String,default:"400px"},priority:{type:Number,default:1}},data(){return{isVisible:!1,loaded:!1,error:!1,observer:null,loadStartTime:0}},computed:{containerId(){return`lazy-widget-${this.widgetType}-${Date.now()}`}},mounted(){this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupIntersectionObserver(){const n={1:"200px",2:"100px",3:"50px"};this.observer=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&!this.loaded&&!this.error&&(this.isVisible=!0,this.loadWidget(),this.observer.disconnect())})},{rootMargin:n[this.priority]||"100px",threshold:.1}),this.observer.observe(this.$refs.container)},async loadWidget(){this.loadStartTime=performance.now();try{const e={1:0,2:500,3:1e3}[this.priority]||0;e>0&&await new Promise(o=>setTimeout(o,e));const a=`lazy-${this.widgetType}-${this.containerId}`;await yt.addToQueue(()=>this.createWidget(),a,this.priority)}catch(n){console.error("Failed to load widget:",n),this.error=!0}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(()=>{const a=this.$refs.container;if(!a){e(new Error("Container not found"));return}const o=a.querySelector(".widget-placeholder, .widget-loading");o&&(o.style.display="none");try{const s=document.createElement("div");s.className="tradingview-widget-container",s.style.height="100%",s.style.width="100%";const i=document.createElement("div");i.className="tradingview-widget-container__widget",i.style.height="100%",i.style.width="100%",s.appendChild(i);const r=document.createElement("script");r.type="text/javascript",r.src=this.scriptUrl,r.async=!0;const d=JSON.stringify(this.config);r.innerHTML=d,console.log(`üîß Creating ${this.widgetType} widget with config:`,this.config),console.log("üìù Config JSON:",d);const g=setTimeout(()=>{console.warn(`${this.widgetType} widget load timeout`),this.error=!0,e(new Error("Widget load timeout"))},{1:8e3,2:1e4,3:12e3}[this.priority]||1e4);r.onload=()=>{clearTimeout(g),this.loaded=!0;const v=performance.now()-this.loadStartTime;console.log(`‚úÖ ${this.widgetType} widget loaded in ${v.toFixed(2)}ms (Priority: ${this.priority})`),n()},r.onerror=v=>{clearTimeout(g),console.error(`‚ùå ${this.widgetType} script load failed:`,v),this.error=!0,e(new Error("Script load failed"))},i.appendChild(r),a.appendChild(s)}catch(s){console.error(`‚ùå ${this.widgetType} widget creation failed:`,s),this.error=!0,e(s)}})})},async retry(){this.error=!1,this.loaded=!1,await this.loadWidget()}}},ya=["id"],wa={key:0,class:"widget-placeholder"},Sa={class:"placeholder-content"},ba={class:"placeholder-text"},_a={key:1,class:"widget-loading"},ka={key:2,class:"widget-error"};function Ca(n,e,a,o,s,i){return u(),h("div",{class:"lazy-widget",id:i.containerId,ref:"container",style:G({height:a.height})},[!s.isVisible&&!s.loaded?(u(),h("div",wa,[t("div",Sa,[e[1]||(e[1]=t("div",{class:"placeholder-icon"},"üìä",-1)),t("div",ba,l(a.widgetType)+" Widget",1),e[2]||(e[2]=t("div",{class:"placeholder-subtext"},"Scroll to load",-1))])])):_("",!0),s.isVisible&&!s.loaded&&!s.error?(u(),h("div",_a,[e[3]||(e[3]=t("div",{class:"loading-spinner"},null,-1)),t("span",null,"Loading "+l(a.widgetType)+"...",1)])):_("",!0),s.error?(u(),h("div",ka,[e[4]||(e[4]=t("span",null,"‚ö†Ô∏è Failed to load",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0)],12,ya)}const wt=R(va,[["render",Ca],["__scopeId","data-v-f6167f96"]]),Ta={name:"VixWidget",data(){return{loading:!0,error:!1,widgetId:`vix-widget-${Date.now()}`}},mounted(){this.loadVixWidget()},methods:{async loadVixWidget(){this.loading=!0,this.error=!1;try{const n=this.$refs.vixContainer;if(!n)return;for(;n.firstChild;)n.removeChild(n.firstChild);console.log("üîß Starting VIX widget creation with FRED:VIXCLS..."),await this.createWidget()}catch(n){console.error("‚ùå VIX widget creation failed:",n),this.error=!0,this.loading=!1}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(()=>{const a=this.$refs.vixContainer;if(!a){e(new Error("Container not found"));return}try{const o=document.createElement("div");o.className="tradingview-widget-container",o.style.height="100%",o.style.width="100%";const s=document.createElement("div");s.className="tradingview-widget-container__widget",s.style.height="100%",s.style.width="100%",o.appendChild(s);const i=document.createElement("script");i.type="text/javascript",i.src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",i.async=!0;const r={lineWidth:2,lineType:2,chartType:"line",showVolume:!1,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[["FRED:VIXCLS|12M"]],dateRanges:["12m|1D","60m|1W","all|1M"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,hideMarketStatus:!1,hideSymbolLogo:!1},d=JSON.stringify(r);i.innerHTML=d,console.log("üîß FRED:VIXCLS Config:",r),console.log("üìù Config JSON:",d);const c=setTimeout(()=>{console.warn("‚è∞ VIX widget load timeout"),this.error=!0,this.loading=!1,e(new Error("Widget load timeout"))},8e3);i.onload=()=>{clearTimeout(c),console.log("‚úÖ FRED:VIXCLS widget script loaded"),this.loading=!1,n()},i.onerror=g=>{clearTimeout(c),console.error("‚ùå VIX widget script failed:",g),this.error=!0,this.loading=!1,e(new Error("Script load failed"))},s.appendChild(i),a.appendChild(o)}catch(o){console.error("‚ùå VIX widget creation failed:",o),this.error=!0,this.loading=!1,e(o)}})})}}},Da={class:"vix-widget-container",ref:"vixContainer",style:{height:"600px"}},Aa={key:0,class:"loading-state"},Ia={key:1,class:"error-state"};function xa(n,e,a,o,s,i){return u(),h("div",Da,[s.loading?(u(),h("div",Aa,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading VIX Index...",-1)])])):_("",!0),s.error?(u(),h("div",Ia,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load VIX",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.loadVixWidget&&i.loadVixWidget(...r)),class:"retry-btn"},"Retry")])):_("",!0)],512)}const Ma=R(Ta,[["render",xa],["__scopeId","data-v-d1b725d9"]]),Na={name:"ZeiiermanFearGreedGauge",data(){return{components:{sp125:65,hl52:52,mcsi:60,putCall:45,vix50:55,safe:62,yieldSpread:67},lastUpdate:new Date}},computed:{fearGreedValue(){const n=Object.values(this.components);return n.reduce((a,o)=>a+o,0)/n.length},needleAngle(){return(this.fearGreedValue-50)*1.8},needleX(){const n=this.needleAngle*(Math.PI/180);return 200+140*Math.sin(n)},needleY(){const n=this.needleAngle*(Math.PI/180);return 200-140*Math.cos(n)},currentSentiment(){return this.fearGreedValue<=25?"Extreme Fear":this.fearGreedValue<=45?"Fear":this.fearGreedValue<=55?"Neutral":this.fearGreedValue<=75?"Greed":"Extreme Greed"},sentimentClass(){return this.fearGreedValue<=25?"extreme-fear":this.fearGreedValue<=45?"fear":this.fearGreedValue<=55?"neutral":this.fearGreedValue<=75?"greed":"extreme-greed"},sentimentDescription(){return this.fearGreedValue<=25?"Market showing extreme pessimism and panic selling conditions":this.fearGreedValue<=45?"Elevated market anxiety with defensive investor positioning":this.fearGreedValue<=55?"Balanced market sentiment with mixed investor signals":this.fearGreedValue<=75?"Optimistic market conditions with increased risk appetite":"Excessive market euphoria indicating potential overvaluation"}},mounted(){console.log("Zeiierman Fear & Greed Index loaded with fixed value:",this.fearGreedValue)},methods:{updateComponents(){this.lastUpdate=new Date,console.log("Zeiierman Fear & Greed Index:",this.fearGreedValue)}}},La={class:"fear-greed-gauge-container"},Pa={class:"market-fng-gauge__meter-container"},$a={class:"left-side"},Ra={class:"sentiment-indicator"},Ea={class:"sentiment-text"},Fa={class:"sentiment-description"},Oa={class:"gauge-wrapper"},Ua={class:"gauge-svg",viewBox:"0 0 400 240",xmlns:"http://www.w3.org/2000/svg"},Va={class:"needle-group"},Wa=["x2","y2"],Ba={x:"200",y:"230","text-anchor":"middle",class:"gauge-value"},qa={class:"components-section"},Ha={class:"components-grid"},za={class:"component-item"},ja={class:"component-bar"},Ga={class:"component-value"},Qa={class:"component-item"},Ya={class:"component-bar"},Xa={class:"component-value"},Ka={class:"component-item"},Ja={class:"component-bar"},Za={class:"component-value"},en={class:"component-item"},tn={class:"component-bar"},sn={class:"component-value"},an={class:"component-item"},nn={class:"component-bar"},on={class:"component-value"},rn={class:"component-item"},ln={class:"component-bar"},cn={class:"component-value"},dn={class:"component-item"},un={class:"component-bar"},hn={class:"component-value"};function gn(n,e,a,o,s,i){return u(),h("div",La,[e[13]||(e[13]=t("div",{class:"widget-header"},[t("h3",null,"Fear & Greed Index Gauge"),t("div",{class:"chart-info"},[t("span",{class:"chart-description"},"Based on Zeiierman's Algorithm")])],-1)),t("div",Pa,[t("div",$a,[t("div",{class:w(["current-sentiment",i.sentimentClass])},[t("div",Ra,[e[0]||(e[0]=t("div",{class:"sentiment-dot"},null,-1)),t("span",Ea,l(i.currentSentiment),1)]),t("div",Fa,l(i.sentimentDescription),1)],2),t("div",Oa,[(u(),h("svg",Ua,[e[3]||(e[3]=se('<defs data-v-fc51b373><linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-fc51b373><stop offset="0%" style="stop-color:#e57373;stop-opacity:1;" data-v-fc51b373></stop><stop offset="12.5%" style="stop-color:#ef5350;stop-opacity:1;" data-v-fc51b373></stop><stop offset="25%" style="stop-color:#ffb74d;stop-opacity:1;" data-v-fc51b373></stop><stop offset="35%" style="stop-color:#ffcc80;stop-opacity:1;" data-v-fc51b373></stop><stop offset="45%" style="stop-color:#ffd54f;stop-opacity:1;" data-v-fc51b373></stop><stop offset="50%" style="stop-color:#fff176;stop-opacity:1;" data-v-fc51b373></stop><stop offset="55%" style="stop-color:#fff59d;stop-opacity:1;" data-v-fc51b373></stop><stop offset="65%" style="stop-color:#aed581;stop-opacity:1;" data-v-fc51b373></stop><stop offset="75%" style="stop-color:#81c784;stop-opacity:1;" data-v-fc51b373></stop><stop offset="87.5%" style="stop-color:#66bb6a;stop-opacity:1;" data-v-fc51b373></stop><stop offset="100%" style="stop-color:#4db6ac;stop-opacity:1;" data-v-fc51b373></stop></linearGradient></defs><path d="M 40 200 A 160 160 0 0 1 360 200" fill="none" stroke="url(#gaugeGradient)" stroke-width="20" stroke-linecap="round" data-v-fc51b373></path>',2)),t("g",Va,[t("line",{x1:200,y1:200,x2:i.needleX,y2:i.needleY,stroke:"#333","stroke-width":"4","stroke-linecap":"round",class:"gauge-needle"},null,8,Wa),e[1]||(e[1]=t("circle",{cx:"200",cy:"200",r:"8",fill:"#333"},null,-1)),e[2]||(e[2]=t("circle",{cx:"200",cy:"200",r:"4",fill:"#fff"},null,-1))]),t("text",Ba,l(i.fearGreedValue.toFixed(0)),1)])),e[4]||(e[4]=se('<div class="gauge-labels" data-v-fc51b373><div class="label-item extreme-fear" data-v-fc51b373><span class="label-text" data-v-fc51b373>Extreme Fear</span><span class="label-range" data-v-fc51b373>0-25</span></div><div class="label-item fear" data-v-fc51b373><span class="label-text" data-v-fc51b373>Fear</span><span class="label-range" data-v-fc51b373>25-45</span></div><div class="label-item neutral" data-v-fc51b373><span class="label-text" data-v-fc51b373>Neutral</span><span class="label-range" data-v-fc51b373>45-55</span></div><div class="label-item greed" data-v-fc51b373><span class="label-text" data-v-fc51b373>Greed</span><span class="label-range" data-v-fc51b373>55-75</span></div><div class="label-item extreme-greed" data-v-fc51b373><span class="label-text" data-v-fc51b373>Extreme Greed</span><span class="label-range" data-v-fc51b373>75-100</span></div></div>',1))])]),t("div",qa,[e[12]||(e[12]=t("h4",null,"Index Components",-1)),t("div",Ha,[t("div",za,[e[5]||(e[5]=t("span",{class:"component-name"},"S&P 500 vs 125-day MA",-1)),t("div",ja,[t("div",{class:"component-fill",style:G({width:s.components.sp125+"%"})},null,4),t("span",Ga,l(s.components.sp125),1)])]),t("div",Qa,[e[6]||(e[6]=t("span",{class:"component-name"},"52-Week High/Low Strength",-1)),t("div",Ya,[t("div",{class:"component-fill",style:G({width:s.components.hl52+"%"})},null,4),t("span",Xa,l(s.components.hl52),1)])]),t("div",Ka,[e[7]||(e[7]=t("span",{class:"component-name"},"Market Breadth (McClellan)",-1)),t("div",Ja,[t("div",{class:"component-fill",style:G({width:s.components.mcsi+"%"})},null,4),t("span",Za,l(s.components.mcsi),1)])]),t("div",en,[e[8]||(e[8]=t("span",{class:"component-name"},"Put/Call Ratio",-1)),t("div",tn,[t("div",{class:"component-fill",style:G({width:s.components.putCall+"%"})},null,4),t("span",sn,l(s.components.putCall),1)])]),t("div",an,[e[9]||(e[9]=t("span",{class:"component-name"},"VIX vs 50-day MA",-1)),t("div",nn,[t("div",{class:"component-fill",style:G({width:s.components.vix50+"%"})},null,4),t("span",on,l(s.components.vix50),1)])]),t("div",rn,[e[10]||(e[10]=t("span",{class:"component-name"},"Safe Haven Demand",-1)),t("div",ln,[t("div",{class:"component-fill",style:G({width:s.components.safe+"%"})},null,4),t("span",cn,l(s.components.safe),1)])]),t("div",dn,[e[11]||(e[11]=t("span",{class:"component-name"},"Junk Bond Demand",-1)),t("div",un,[t("div",{class:"component-fill",style:G({width:s.components.yieldSpread+"%"})},null,4),t("span",hn,l(s.components.yieldSpread),1)])])])])])])}const mn=R(Na,[["render",gn],["__scopeId","data-v-fc51b373"]]),fn={name:"MarketOverviewSkeleton"},pn={class:"market-overview-skeleton"},vn={class:"skeleton-widget-container"},yn={class:"skeleton-ticker-area"},wn={class:"skeleton-widget-container large"},Sn={class:"skeleton-stories-area"},bn={class:"skeleton-widget-container"},_n={class:"skeleton-heatmap-area"},kn={class:"skeleton-heatmap-grid"},Cn={class:"skeleton-widget-container"},Tn={class:"skeleton-performance-area"};function Dn(n,e,a,o,s,i){return u(),h("div",pn,[t("div",vn,[e[0]||(e[0]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",yn,[(u(),h(E,null,F(6,r=>t("div",{class:"skeleton-ticker-item",key:r})),64))])]),e[6]||(e[6]=se('<div class="skeleton-widget-container" data-v-9478c3a3><div class="skeleton-widget-header" data-v-9478c3a3><div class="skeleton-title" data-v-9478c3a3></div></div><div class="skeleton-gauge-area" data-v-9478c3a3><div class="skeleton-gauge-circle" data-v-9478c3a3></div><div class="skeleton-gauge-info" data-v-9478c3a3><div class="skeleton-gauge-value" data-v-9478c3a3></div><div class="skeleton-gauge-label" data-v-9478c3a3></div></div></div></div>',1)),t("div",wn,[e[2]||(e[2]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Sn,[(u(),h(E,null,F(8,r=>t("div",{class:"skeleton-story-item",key:r},[...e[1]||(e[1]=[t("div",{class:"skeleton-story-time"},null,-1),t("div",{class:"skeleton-story-title"},null,-1),t("div",{class:"skeleton-story-content"},null,-1)])])),64))])]),e[7]||(e[7]=se('<div class="skeleton-widget-container large" data-v-9478c3a3><div class="skeleton-widget-header" data-v-9478c3a3><div class="skeleton-title" data-v-9478c3a3></div></div><div class="skeleton-insight-grid" data-v-9478c3a3><div class="skeleton-insight-section" data-v-9478c3a3><div class="skeleton-section-header" data-v-9478c3a3><div class="skeleton-section-title" data-v-9478c3a3></div></div><div class="skeleton-chart-area" data-v-9478c3a3><div class="skeleton-chart" data-v-9478c3a3></div></div></div><div class="skeleton-insight-section" data-v-9478c3a3><div class="skeleton-section-header" data-v-9478c3a3><div class="skeleton-section-title" data-v-9478c3a3></div></div><div class="skeleton-chart-area" data-v-9478c3a3><div class="skeleton-chart" data-v-9478c3a3></div></div></div></div></div>',1)),t("div",bn,[e[3]||(e[3]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",_n,[t("div",kn,[(u(),h(E,null,F(20,r=>t("div",{class:"skeleton-heatmap-cell",key:r})),64))])])]),t("div",Cn,[e[5]||(e[5]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Tn,[(u(),h(E,null,F(4,r=>t("div",{class:"skeleton-performance-item",key:r},[...e[4]||(e[4]=[t("div",{class:"skeleton-performance-label"},null,-1),t("div",{class:"skeleton-performance-value"},null,-1)])])),64))])])])}const An=R(fn,[["render",Dn],["__scopeId","data-v-9478c3a3"]]),In={name:"MarketDashboard",components:{LazyTradingViewWidget:wt,VixWidget:Ma,ZeiiermanFearGreedGauge:mn,MarketOverviewSkeleton:An},data(){return{loading:!0,error:null,vixKey:Date.now()}},mounted(){this.scrollToTop(),this.initializePage()},watch:{$route(){this.scrollToTop()}},methods:{async initializePage(){try{await new Promise(n=>setTimeout(n,800)),this.loading=!1}catch(n){this.error=String(n),this.loading=!1}},async refresh(){this.loading=!0,this.error=null,this.vixKey=Date.now(),await this.initializePage()},scrollToTop(){this.$nextTick(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),setTimeout(()=>{window.scrollTo(0,0)},100)})},refreshVixWidget(){this.vixKey=Date.now(),console.log("VIX widget refreshed with key:",this.vixKey)}},computed:{tickersConfig(){return{symbols:[{proName:"FOREXCOM:SPXUSD",title:"S&P 500 Index"},{proName:"NASDAQ:NDX",title:"NASDAQ 100 Index"},{proName:"OPOFINANCE:DJIUSD",title:"Dow Jone Index"},{proName:"CAPITALCOM:RTY",title:"US Russel 2000"},{proName:"INDEX:BTCUSD",title:"BTC"},{proName:"TVC:GOLD",title:"GOLD"}],colorTheme:"light",locale:"en",largeChartUrl:"",isTransparent:!0,showSymbolLogo:!0}},topStoriesConfig(){return{displayMode:"regular",feedMode:"market",colorTheme:"light",isTransparent:!0,locale:"en",market:"stock",width:"100%",height:"100%"}},dailyConfig(){return{lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[["VANTAGE:SP500|6M"],["NASDAQ:NDX|6M"],["OPOFINANCE:DJIUSD|6M"],["CAPITALCOM:RTY|6M"],["INDEX:BTCUSD|6M"],["TVC:GOLD|6M"]],dateRanges:["6m|1D"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"5",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1}},weeklyConfig(){return{lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[["VANTAGE:SP500|6M"],["NASDAQ:NDX|6M"],["OPOFINANCE:DJIUSD|6M"],["CAPITALCOM:RTY|6M"],["INDEX:BTCUSD|6M"],["TVC:GOLD|6M"]],dateRanges:["6m|1W"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"4",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1}},heatmapConfig(){return{exchanges:[],dataSource:"SPX500",grouping:"sector",blockSize:"market_cap_basic",blockColor:"change",locale:"en",symbolUrl:"",colorTheme:"light",hasTopBar:!1,isDataSetEnabled:!1,isZoomEnabled:!0,hasSymbolTooltip:!0,width:"100%",height:"100%"}}}},xn={class:"market-dashboard"},Mn={key:0,class:"loading-with-skeleton"},Nn={key:1,class:"error"},Ln={class:"text-danger"},Pn={key:2},$n={class:"widget-container-ticker"},Rn={class:"widget-container"},En={class:"widget-container vix-container"},Fn={class:"widget-header"},On={class:"widget-container"},Un={class:"insight-grid"},Vn={class:"insight-section"},Wn={class:"insight-section weekly-section"},Bn={class:"widget-container"};function qn(n,e,a,o,s,i){const r=V("MarketOverviewSkeleton"),d=V("LazyTradingViewWidget"),c=V("ZeiiermanFearGreedGauge"),g=V("VixWidget");return u(),h("div",xn,[e[9]||(e[9]=t("h2",null,"Market Overview",-1)),e[10]||(e[10]=t("p",{class:"text-muted mb-3"},"Global markets overview and macro indicators",-1)),s.loading?(u(),h("div",Mn,[$(r)])):s.error?(u(),h("div",Nn,[t("p",Ln,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...v)=>i.refresh&&i.refresh(...v)),class:"btn btn-secondary"},"Retry")])):(u(),h("div",Pn,[t("div",$n,[e[2]||(e[2]=t("div",{class:"widget-header"},[t("h3",null,"Market Index")],-1)),$(d,{"widget-type":"Market Index",config:i.tickersConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-tickers.js",height:"100px",priority:1},null,8,["config"])]),t("div",Rn,[e[3]||(e[3]=t("div",{class:"widget-header"},[t("h3",null,"Top Stories")],-1)),$(d,{"widget-type":"Top Stories",config:i.topStoriesConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-timeline.js",height:"650px",priority:2},null,8,["config"])]),$(c),t("div",En,[t("div",Fn,[e[4]||(e[4]=t("h3",null,"VIX Index (Volatility Index)",-1)),t("button",{onClick:e[1]||(e[1]=(...v)=>i.refreshVixWidget&&i.refreshVixWidget(...v)),class:"btn btn-sm btn-secondary"}," üîÑ Refresh VIX ")]),(u(),ft(g,{key:`vix-${s.vixKey}`}))]),t("div",On,[e[7]||(e[7]=t("div",{class:"widget-header"},[t("h3",null,"Market Insight")],-1)),t("div",Un,[t("div",Vn,[e[5]||(e[5]=t("div",{class:"section-header"},[t("h4",null,"Market Daily Insight (MA5)")],-1)),$(d,{"widget-type":"Market Daily Insight",config:i.dailyConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",height:"600px",priority:2},null,8,["config"])]),t("div",Wn,[e[6]||(e[6]=t("div",{class:"section-header"},[t("h4",null,"Market Weekly Insight (MA4)")],-1)),$(d,{"widget-type":"Market Weekly Insight",config:i.weeklyConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",height:"600px",priority:3},null,8,["config"])])])]),t("div",Bn,[e[8]||(e[8]=t("div",{class:"widget-header"},[t("h3",null,"Stock Heatmap")],-1)),$(d,{"widget-type":"Stock Heatmap",config:i.heatmapConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-stock-heatmap.js",height:"500px",priority:3},null,8,["config"])])]))])}const Hn=R(In,[["render",qn],["__scopeId","data-v-7202e62a"]]);class zn{constructor(){this.cache=null,this.lastUpdate=null,this.cacheTimeout=5*60*1e3}getConfigUrl(){return"/investment-dashboard/config/stocks.json"}async loadConfig(){try{if(this.cache&&this.lastUpdate&&Date.now()-this.lastUpdate<this.cacheTimeout)return this.cache;const e=this.getConfigUrl(),a=await fetch(`${e}?t=${Date.now()}`);if(!a.ok)throw new Error(`HTTP ${a.status}`);const o=await a.json();if(!o.stocks||!Array.isArray(o.stocks))throw new Error("Invalid config format: missing stocks array");return this.cache=o,this.lastUpdate=Date.now(),console.log(`‚úÖ Loaded ${o.stocks.length} stocks from config/stocks.json`),o}catch(e){return console.error("‚ùå Failed to load stocks config:",e),this.cache?(console.warn("‚ö†Ô∏è Using cached config due to load failure"),this.cache):this.getFallbackConfig()}}async getEnabledSymbols(){return(await this.loadConfig()).stocks.filter(a=>a.enabled).map(a=>a.symbol)}async getSymbolsByPriority(e=1){return(await this.loadConfig()).stocks.filter(o=>o.enabled&&o.priority===e).map(o=>o.symbol)}async getStockExchange(e){const o=(await this.loadConfig()).stocks.find(s=>s.symbol===e);return o?o.exchange:"NASDAQ"}async getStockSector(e){const o=(await this.loadConfig()).stocks.find(s=>s.symbol===e);return o?o.sector:"Unknown"}async getStockIndustry(e){const o=(await this.loadConfig()).stocks.find(s=>s.symbol===e);return o?o.industry:"Unknown"}async getStockInfo(e){return(await this.loadConfig()).stocks.find(o=>o.symbol===e)||null}async getExchanges(){var a;return((a=(await this.loadConfig()).metadata)==null?void 0:a.exchanges)||["NYSE","NASDAQ","AMEX"]}async getSectors(){var a;return((a=(await this.loadConfig()).metadata)==null?void 0:a.sectors)||[]}async getStocksByExchange(){const e=await this.loadConfig(),a={};return e.stocks.filter(o=>o.enabled).forEach(o=>{a[o.exchange]||(a[o.exchange]=[]),a[o.exchange].push(o.symbol)}),a}async getStocksBySector(){const e=await this.loadConfig(),a={};return e.stocks.filter(o=>o.enabled).forEach(o=>{a[o.sector]||(a[o.sector]=[]),a[o.sector].push(o.symbol)}),a}async getStats(){const e=await this.loadConfig(),a=e.stocks.filter(o=>o.enabled);return{total:e.stocks.length,enabled:a.length,disabled:e.stocks.length-a.length,exchanges:[...new Set(a.map(o=>o.exchange))],sectors:[...new Set(a.map(o=>o.sector))],version:e.version,lastUpdated:e.last_updated}}clearCache(){this.cache=null,this.lastUpdate=null,console.log("üóëÔ∏è StocksConfigService cache cleared")}async refresh(){return this.clearCache(),await this.loadConfig()}getFallbackConfig(){return console.warn("‚ö†Ô∏è Using emergency fallback config"),{version:"1.0.0-fallback",stocks:[{symbol:"ASTS",exchange:"NASDAQ",sector:"Technology",industry:"Communication Equipment",enabled:!0,priority:1},{symbol:"RIVN",exchange:"NASDAQ",sector:"Consumer Cyclical",industry:"Auto Manufacturers",enabled:!0,priority:1},{symbol:"PL",exchange:"NYSE",sector:"Industrials",industry:"Aerospace & Defense",enabled:!0,priority:1},{symbol:"CRM",exchange:"NYSE",sector:"Technology",industry:"Software - Application",enabled:!0,priority:1},{symbol:"NVDA",exchange:"NASDAQ",sector:"Technology",industry:"Semiconductors",enabled:!0,priority:1},{symbol:"TSLA",exchange:"NASDAQ",sector:"Consumer Cyclical",industry:"Auto Manufacturers",enabled:!0,priority:1},{symbol:"RR",exchange:"NASDAQ",sector:"Technology",industry:"Software - Application",enabled:!0,priority:2}],metadata:{total_stocks:7,enabled_stocks:7,exchanges:["NYSE","NASDAQ"],sectors:["Technology","Consumer Cyclical","Industrials"]}}}async isValidSymbol(e){return(await this.loadConfig()).stocks.some(o=>o.symbol===e&&o.enabled)}async getSymbolsList(){return await this.getEnabledSymbols()}getConfigSource(){return this.cache?"stocks.json":"fallback"}getCacheInfo(){return{cached:!!this.cache,lastUpdate:this.lastUpdate,cacheAge:this.lastUpdate?Date.now()-this.lastUpdate:0,cacheTimeout:this.cacheTimeout}}}const jn=new zn;class Gn{constructor(){this.cache=new Map,this.loadingPromises=new Map,this.maxCacheSize=50,this.cacheTimeout=5*60*1e3}generateKey(e,a,o){return`${e}-${a}-${o}`}has(e,a,o){const s=this.generateKey(e,a,o),i=this.cache.get(s);return i?Date.now()-i.timestamp>this.cacheTimeout?(this.cache.delete(s),!1):!0:!1}get(e,a,o){const s=this.generateKey(e,a,o),i=this.cache.get(s);return i&&Date.now()-i.timestamp<=this.cacheTimeout?i.data:null}set(e,a,o,s){const i=this.generateKey(e,a,o);if(this.cache.size>=this.maxCacheSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(i,{data:s,timestamp:Date.now()})}isLoading(e,a,o){const s=this.generateKey(e,a,o);return this.loadingPromises.has(s)}setLoading(e,a,o,s){const i=this.generateKey(e,a,o);return this.loadingPromises.set(i,s),s.finally(()=>{this.loadingPromises.delete(i)}),s}getLoadingPromise(e,a,o){const s=this.generateKey(e,a,o);return this.loadingPromises.get(s)}clear(){this.cache.clear(),this.loadingPromises.clear()}clearExpired(){const e=Date.now();for(const[a,o]of this.cache.entries())e-o.timestamp>this.cacheTimeout&&this.cache.delete(a)}getStats(){return{cacheSize:this.cache.size,loadingCount:this.loadingPromises.size,maxCacheSize:this.maxCacheSize}}}const _e=new Gn;setInterval(()=>{_e.clearExpired()},6e4);const Qn={name:"FastTradingViewWidget",props:{widgetType:{type:String,required:!0,validator:n=>["overview","technical"].includes(n)},symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},priority:{type:Number,default:1}},data(){return{loaded:!1,error:!1,loadStartTime:0,isVisible:!1,observer:null}},computed:{containerId(){return`fast-widget-${this.widgetType}-${this.symbol}-${Date.now()}`},cacheKey(){return`${this.widgetType}-${this.symbol}-${this.exchange}`}},async mounted(){this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupIntersectionObserver(){const n={1:"300px",2:"150px",3:"50px"};this.observer=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&!this.loaded&&!this.error&&(this.isVisible=!0,this.loadWidget(),this.observer.disconnect())})},{rootMargin:n[this.priority]||"150px",threshold:.1}),this.observer.observe(this.$refs.container)},async loadWidget(){this.loadStartTime=performance.now(),this.loaded=!1,this.error=!1;try{const e={1:0,2:300,3:600}[this.priority]||0;if(e>0&&await new Promise(s=>setTimeout(s,e)),_e.has(this.widgetType,this.symbol,this.exchange)){const s=_e.get(this.widgetType,this.symbol,this.exchange);if(s){this.renderCachedWidget(s);return}}if(_e.isLoading(this.widgetType,this.symbol,this.exchange)){await _e.getLoadingPromise(this.widgetType,this.symbol,this.exchange);return}const a=`fast-${this.widgetType}-${this.symbol}-${this.containerId}`,o=yt.addToQueue(()=>this.createWidget(),a,this.priority);_e.setLoading(this.widgetType,this.symbol,this.exchange,o),await o}catch(n){console.error("Failed to load widget:",n),this.error=!0}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(async()=>{const a=this.$refs.container;if(!a){e(new Error("Container not found"));return}const o=this.getWidgetConfig(),s=this.getScriptUrl();if(!gt.isPreloaded(s))try{await gt.preloadScript(s)}catch(c){console.warn("Script preload failed, continuing with normal load:",c)}const i=document.createElement("script");i.type="text/javascript",i.src=s,i.async=!0,i.innerHTML=JSON.stringify(o);const d=setTimeout(()=>{this.error=!0,e(new Error("Widget load timeout"))},{1:3e3,2:5e3,3:8e3}[this.priority]||5e3);i.onload=()=>{clearTimeout(d),this.loaded=!0;const c=performance.now()-this.loadStartTime;console.log(`Widget ${this.cacheKey} loaded in ${c.toFixed(2)}ms (Priority: ${this.priority})`),_e.set(this.widgetType,this.symbol,this.exchange,{config:o,scriptUrl:s}),n()},i.onerror=()=>{clearTimeout(d),this.error=!0,e(new Error("Script load failed"))},a.appendChild(i)})})},getWidgetConfig(){if(this.widgetType==="overview")return{lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[[this.symbol,`${this.exchange}:${this.symbol}|1D`]],dateRanges:["1d|1","1m|30","3m|60","12m|1D","60m|1W","all|1M"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:9,maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1};if(this.widgetType==="technical")return{interval:"1D",width:"100%",height:"100%",isTransparent:!1,symbol:`${this.exchange}:${this.symbol}`,showIntervalTabs:!0,locale:"en",colorTheme:"light"}},getScriptUrl(){if(this.widgetType==="overview")return"https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js";if(this.widgetType==="technical")return"https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js"},renderCachedWidget(n){this.$nextTick(()=>{const e=this.$refs.container;if(!e)return;const a=document.createElement("script");a.type="text/javascript",a.src=n.scriptUrl,a.async=!0,a.innerHTML=JSON.stringify(n.config),a.onload=()=>{this.loaded=!0;const o=performance.now()-this.loadStartTime;console.log(`Cached widget ${this.cacheKey} loaded in ${o.toFixed(2)}ms`)},e.appendChild(a)})},async retry(){this.setupIntersectionObserver()}}},Yn=["id"],Xn={key:0,class:"fast-loading"},Kn={key:1,class:"fast-error"};function Jn(n,e,a,o,s,i){return u(),h("div",{class:w(["fast-widget",{"overview-widget":a.widgetType==="overview"}]),id:i.containerId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",Xn,[e[1]||(e[1]=t("div",{class:"loading-spinner"},null,-1)),t("span",null,"Loading "+l(a.widgetType)+"...",1)])):_("",!0),s.error?(u(),h("div",Kn,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0)],10,Yn)}const ms=R(Qn,[["render",Jn],["__scopeId","data-v-a0fc77ab"]]),Zn={name:"TechnicalAnalysisWidget",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},priority:{type:Number,default:2}},data(){return{loaded:!1,error:!1,loadStartTime:0,isVisible:!1,observer:null,retryCount:0}},computed:{containerId(){return`technical-analysis-${this.symbol}-${Date.now()}`}},async mounted(){this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupIntersectionObserver(){const n={1:"300px",2:"150px",3:"50px"};this.observer=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&!this.loaded&&!this.error&&(this.isVisible=!0,this.loadWidget(),this.observer.disconnect())})},{rootMargin:n[this.priority]||"150px",threshold:.1}),this.observer.observe(this.$refs.container)},async loadWidget(){this.loadStartTime=performance.now(),this.loaded=!1,this.error=!1;try{const e={1:0,2:300,3:600}[this.priority]||0;e>0&&await new Promise(o=>setTimeout(o,e));const a=`technical-analysis-${this.symbol}-${this.containerId}`;await yt.addToQueue(()=>this.createWidget(),a,this.priority)}catch(n){console.error("Failed to load Technical Analysis widget:",n),this.error=!0}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(async()=>{const a=this.$refs.container;if(!a){e(new Error("Container not found"));return}const o=this.getWidgetConfig(),s="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js",i=document.createElement("script");i.type="text/javascript",i.src=s,i.async=!0,i.innerHTML=JSON.stringify(o);const r={1:8e3,2:12e3,3:15e3},d=this.retryCount||0,c=r[this.priority]+d*3e3,g=setTimeout(()=>{this.error=!0,e(new Error(`Widget load timeout after ${c}ms (retry: ${d})`))},c);i.onload=()=>{clearTimeout(g),this.loaded=!0;const f=performance.now()-this.loadStartTime;console.log(`Technical Analysis widget ${this.symbol} loaded in ${f.toFixed(2)}ms (retry: ${d})`),n()},i.onerror=()=>{clearTimeout(g),this.error=!0,e(new Error("Script load failed"))};const v=a.querySelector(".tradingview-widget-container__widget");v?v.appendChild(i):a.appendChild(i)})})},getWidgetConfig(){return{colorTheme:"light",displayMode:"single",isTransparent:!0,locale:"en",interval:"1D",disableInterval:!1,width:"100%",height:"100%",symbol:`${this.exchange}:${this.symbol}`,showIntervalTabs:!0}},async retry(){this.retryCount=(this.retryCount||0)+1;const n=2;if(this.retryCount>n){console.error(`Technical Analysis widget ${this.symbol} exceeded max retries (${n})`);return}const e=Math.min(1e3*Math.pow(2,this.retryCount-1),5e3);console.log(`Technical Analysis widget ${this.symbol} retrying in ${e}ms (attempt ${this.retryCount}/${n})`),await new Promise(a=>setTimeout(a,e)),this.setupIntersectionObserver()}}},ei=["id"],ti={key:0,class:"fast-loading"},si={key:1,class:"fast-error"},ai={class:"tradingview-widget-container"};function ni(n,e,a,o,s,i){return u(),h("div",{class:"fast-widget overview-widget",id:i.containerId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",ti,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading Technical Analysis...",-1)])])):_("",!0),s.error?(u(),h("div",si,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0),H(t("div",ai,[...e[3]||(e[3]=[t("div",{class:"tradingview-widget-container__widget"},null,-1)])],512),[[pt,s.loaded]])],8,ei)}const ii=R(Zn,[["render",ni],["__scopeId","data-v-a3661ec1"]]),oi={name:"TechnicalIndicators",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"}},data(){return{loading:!0,error:null,technicalData:null,cacheInfo:null}},computed:{hasYFinanceData(){var e,a;const n=this.technicalData&&this.technicalData.yf;return console.log(`üîç YFinance data check for ${this.symbol}:`,{hasTechnicalData:!!this.technicalData,hasYF:n,yfData:(e=this.technicalData)==null?void 0:e.yf,yfKeys:(a=this.technicalData)!=null&&a.yf?Object.keys(this.technicalData.yf):"none"}),n}},mounted(){this.loadTechnicalData()},watch:{symbol(){this.loadTechnicalData()}},methods:{async loadTechnicalData(){var n;this.loading=!0,this.error=null,this.cacheInfo=null;try{console.log(`üîç Loading technical data for ${this.symbol}...`);const e=Date.now();this.technicalData=await Te.getTechnicalIndicators(this.symbol);const a=Date.now()-e;if(this.technicalData.error)throw new Error(this.technicalData.error);this.technicalData.source?this.technicalData.source.includes("Cache")?this.cacheInfo=`${this.technicalData.source} (${a}ms)`:this.technicalData.source.includes("Precomputed")?this.cacheInfo=`${this.technicalData.source} (${a}ms)`:this.cacheInfo=`Fresh data (${a}ms)`:this.cacheInfo=`Loaded in ${a}ms`,console.log(`‚úÖ Technical data loaded for ${this.symbol}:`,{source:this.technicalData.source,loadTime:`${a}ms`,hasADX:!!((n=this.technicalData.adx14)!=null&&n.value),hasYFinance:!!this.technicalData.yf,yfinanceKeys:this.technicalData.yf?Object.keys(this.technicalData.yf):"none",yfinanceData:this.technicalData.yf}),this.technicalData.adx14&&this.technicalData.adx14.value!==null&&this.technicalData.adx14.value!=="N/A"?console.log(`‚úÖ ADX data is valid for ${this.symbol}: ${this.technicalData.adx14.value}`):console.warn(`‚ö†Ô∏è ADX data may be invalid for ${this.symbol}:`,this.technicalData.adx14),typeof window<"u"&&window.dispatchEvent(new CustomEvent("widget-loaded",{detail:{name:`TechnicalIndicators-${this.symbol}`,time:a,priority:2}}))}catch(e){console.error(`‚ùå Failed to load technical data for ${this.symbol}:`,e),this.error=e.message,(e.message.includes("fetch")||e.message.includes("network")||e.message.includes("proxy"))&&(this.error=`Network error loading data for ${this.symbol}. Click to retry.`)}finally{this.loading=!1}},async retryLoad(){await this.loadTechnicalData()},getSignalClass(n){if(!n)return"neutral";const e=["BUY","OVERSOLD","STRONG_TREND"],a=["SELL","OVERBOUGHT"];return e.includes(n)?"bullish":a.includes(n)?"bearish":"neutral"},formatValue(n){return n==null?"N/A":typeof n=="string"?n:typeof n=="number"?n.toFixed(2):"N/A"},formatPriceDiff(n){if(!n||!this.technicalData)return"";const e=this.getCurrentPrice();if(!e)return"";const a=e-parseFloat(n),o=a/parseFloat(n)*100;if(Math.abs(a)<.01)return"¬±0.00";const s=a>0?"+":"";return`${s}${a.toFixed(2)} (${s}${o.toFixed(1)}%)`},getCurrentPrice(){var n,e,a;return this.technicalData?(n=this.technicalData.sma5)!=null&&n.currentPrice?parseFloat(this.technicalData.sma5.currentPrice):(e=this.technicalData.ma5)!=null&&e.currentPrice?parseFloat(this.technicalData.ma5.currentPrice):(a=this.technicalData.sma50)!=null&&a.currentPrice?parseFloat(this.technicalData.sma50.currentPrice):null:null},getPriceDiffClass(n){if(!n)return"neutral";const e=this.getCurrentPrice();if(!e)return"neutral";const a=e-parseFloat(n);return Math.abs(a)<.01?"neutral":a>0?"positive":"negative"},formatVolume(n){return n==null?"--":n>=1e9?`${(n/1e9).toFixed(1)}B`:n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toLocaleString()},formatMarketCap(n){return n==null?"--":n>=1e12?`$${(n/1e12).toFixed(1)}T`:n>=1e9?`$${(n/1e9).toFixed(1)}B`:n>=1e6?`$${(n/1e6).toFixed(1)}M`:`$${n.toLocaleString()}`},formatBeta(n){return n==null?"--":n.toFixed(2)},formatPercentChange(n){return n==null?"":`(${n>0?"+":""}${n.toFixed(1)}%)`},getPercentChangeClass(n){return n==null||Math.abs(n)<.1?"neutral":n>0?"positive":"negative"}}},ri={class:"technical-indicators"},li={class:"indicators-header"},ci={key:0,class:"cache-info"},di={key:0,class:"loading-state"},ui={key:1,class:"error-state"},hi=["disabled"],gi={key:2,class:"indicators-grid"},mi={class:"indicator-item"},fi={class:"indicator-value-row"},pi={class:"indicator-item"},vi={class:"indicator-value-row"},yi={class:"indicator-item"},wi={class:"indicator-value-row"},Si={class:"indicator-item"},bi={class:"indicator-value-row"},_i={class:"indicator-item"},ki={class:"indicator-value-row"},Ci={class:"indicator-item"},Ti={class:"indicator-value-row"},Di={class:"indicator-item"},Ai={class:"indicator-value-row"},Ii={class:"indicator-item"},xi={class:"indicator-value-row"},Mi={class:"indicator-item"},Ni={class:"indicator-value-row"},Li={class:"indicator-item"},Pi={class:"indicator-item"},$i={class:"indicator-item"},Ri={key:0,class:"indicator-item"},Ei={class:"indicator-value-row"},Fi={class:"indicator-value"},Oi={key:1,class:"indicator-item"},Ui={class:"indicator-value-row"},Vi={class:"indicator-value"},Wi={key:2,class:"indicator-item"},Bi={class:"indicator-value"},qi={key:3,class:"indicator-item"},Hi={class:"indicator-value"},zi={key:4,class:"indicator-item"},ji={class:"indicator-value"},Gi={key:5,class:"indicator-item"},Qi={class:"indicator-value"},Yi={class:"indicator-item",style:{"grid-column":"1 / -1",background:"#fff3cd","border-color":"#ffeaa7"}},Xi={class:"indicator-value",style:{"font-size":"0.7rem",color:"#856404"}};function Ki(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D,b,P,I,L,y,O,C,M,p,B,j,k,q,oe,ce,ee,de,ue,he,fe,re,z,pe,ve,ye,we,Se,Q,Ne,Le,Pe,$e,Re,Ee,Fe,Oe,Ue,Ve,We,Be,qe,He,ze,je,Ge,Qe,Ye,Xe,Ke,te,rt,St,bt,_t,kt,Ct,Tt,Dt,At,It,xt,Mt,Nt,Lt,Pt,$t,Rt,Et,Ft,Ot,Ut,Vt,Wt,Bt,qt,Ht,zt,jt,Gt,Qt,Yt,Xt,Kt,Jt,Zt,es,ts,ss,as,ns,is,os,rs,ls,cs;return u(),h("div",ri,[t("div",li,[e[1]||(e[1]=t("h4",null,"Technical Indicators",-1)),s.cacheInfo?(u(),h("div",ci,[t("small",null,l(s.cacheInfo),1)])):_("",!0)]),s.loading?(u(),h("div",di,[...e[2]||(e[2]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading technical data...",-1)])])):s.error?(u(),h("div",ui,[e[3]||(e[3]=t("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),t("span",null,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...ks)=>i.retryLoad&&i.retryLoad(...ks)),class:"retry-button",disabled:s.loading},l(s.loading?"Loading...":"Retry"),9,hi)])):(u(),h("div",gi,[t("div",mi,[e[4]||(e[4]=t("span",{class:"indicator-label"},"MA5",-1)),t("div",fi,[t("span",{class:w(["indicator-value",i.getSignalClass((d=(r=s.technicalData)==null?void 0:r.ma5)==null?void 0:d.signal)])},l(i.formatValue((g=(c=s.technicalData)==null?void 0:c.ma5)==null?void 0:g.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((f=(v=s.technicalData)==null?void 0:v.ma5)==null?void 0:f.value)])},l(i.formatPriceDiff((T=(m=s.technicalData)==null?void 0:m.ma5)==null?void 0:T.value)),3)])]),t("div",pi,[e[5]||(e[5]=t("span",{class:"indicator-label"},"MA10",-1)),t("div",vi,[t("span",{class:w(["indicator-value",i.getSignalClass((D=(S=s.technicalData)==null?void 0:S.ma10)==null?void 0:D.signal)])},l(i.formatValue((P=(b=s.technicalData)==null?void 0:b.ma10)==null?void 0:P.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((L=(I=s.technicalData)==null?void 0:I.ma10)==null?void 0:L.value)])},l(i.formatPriceDiff((O=(y=s.technicalData)==null?void 0:y.ma10)==null?void 0:O.value)),3)])]),t("div",yi,[e[6]||(e[6]=t("span",{class:"indicator-label"},"MA30",-1)),t("div",wi,[t("span",{class:w(["indicator-value",i.getSignalClass((M=(C=s.technicalData)==null?void 0:C.ma30)==null?void 0:M.signal)])},l(i.formatValue((B=(p=s.technicalData)==null?void 0:p.ma30)==null?void 0:B.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((k=(j=s.technicalData)==null?void 0:j.ma30)==null?void 0:k.value)])},l(i.formatPriceDiff((oe=(q=s.technicalData)==null?void 0:q.ma30)==null?void 0:oe.value)),3)])]),t("div",Si,[e[7]||(e[7]=t("span",{class:"indicator-label"},"SMA5",-1)),t("div",bi,[t("span",{class:w(["indicator-value",i.getSignalClass((ee=(ce=s.technicalData)==null?void 0:ce.sma5)==null?void 0:ee.signal)])},l(i.formatValue((ue=(de=s.technicalData)==null?void 0:de.sma5)==null?void 0:ue.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((fe=(he=s.technicalData)==null?void 0:he.sma5)==null?void 0:fe.value)])},l(i.formatPriceDiff((z=(re=s.technicalData)==null?void 0:re.sma5)==null?void 0:z.value)),3)])]),t("div",_i,[e[8]||(e[8]=t("span",{class:"indicator-label"},"SMA10",-1)),t("div",ki,[t("span",{class:w(["indicator-value",i.getSignalClass((ve=(pe=s.technicalData)==null?void 0:pe.sma10)==null?void 0:ve.signal)])},l(i.formatValue((we=(ye=s.technicalData)==null?void 0:ye.sma10)==null?void 0:we.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((Q=(Se=s.technicalData)==null?void 0:Se.sma10)==null?void 0:Q.value)])},l(i.formatPriceDiff((Le=(Ne=s.technicalData)==null?void 0:Ne.sma10)==null?void 0:Le.value)),3)])]),t("div",Ci,[e[9]||(e[9]=t("span",{class:"indicator-label"},"SMA30",-1)),t("div",Ti,[t("span",{class:w(["indicator-value",i.getSignalClass(($e=(Pe=s.technicalData)==null?void 0:Pe.sma30)==null?void 0:$e.signal)])},l(i.formatValue((Ee=(Re=s.technicalData)==null?void 0:Re.sma30)==null?void 0:Ee.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((Oe=(Fe=s.technicalData)==null?void 0:Fe.sma30)==null?void 0:Oe.value)])},l(i.formatPriceDiff((Ve=(Ue=s.technicalData)==null?void 0:Ue.sma30)==null?void 0:Ve.value)),3)])]),t("div",Di,[e[10]||(e[10]=t("span",{class:"indicator-label"},"Ichimoku Conversion (9)",-1)),t("div",Ai,[t("span",{class:w(["indicator-value",i.getSignalClass((Be=(We=s.technicalData)==null?void 0:We.ichimokuConversionLine)==null?void 0:Be.signal)])},l(i.formatValue((He=(qe=s.technicalData)==null?void 0:qe.ichimokuConversionLine)==null?void 0:He.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((je=(ze=s.technicalData)==null?void 0:ze.ichimokuConversionLine)==null?void 0:je.value)])},l(i.formatPriceDiff((Qe=(Ge=s.technicalData)==null?void 0:Ge.ichimokuConversionLine)==null?void 0:Qe.value)),3)])]),t("div",Ii,[e[11]||(e[11]=t("span",{class:"indicator-label"},"Ichimoku Base (26)",-1)),t("div",xi,[t("span",{class:w(["indicator-value",i.getSignalClass((Xe=(Ye=s.technicalData)==null?void 0:Ye.ichimokuBaseLine)==null?void 0:Xe.signal)])},l(i.formatValue((te=(Ke=s.technicalData)==null?void 0:Ke.ichimokuBaseLine)==null?void 0:te.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((St=(rt=s.technicalData)==null?void 0:rt.ichimokuBaseLine)==null?void 0:St.value)])},l(i.formatPriceDiff((_t=(bt=s.technicalData)==null?void 0:bt.ichimokuBaseLine)==null?void 0:_t.value)),3)])]),t("div",Mi,[e[12]||(e[12]=t("span",{class:"indicator-label"},"Ichimoku Lagging (26)",-1)),t("div",Ni,[t("span",{class:w(["indicator-value",i.getSignalClass((Ct=(kt=s.technicalData)==null?void 0:kt.ichimokuLaggingSpan)==null?void 0:Ct.signal)])},l(i.formatValue((Dt=(Tt=s.technicalData)==null?void 0:Tt.ichimokuLaggingSpan)==null?void 0:Dt.value)),3),t("span",{class:w(["price-diff",i.getPriceDiffClass((It=(At=s.technicalData)==null?void 0:At.ichimokuLaggingSpan)==null?void 0:It.value)])},l(i.formatPriceDiff((Mt=(xt=s.technicalData)==null?void 0:xt.ichimokuLaggingSpan)==null?void 0:Mt.value)),3)])]),t("div",Li,[e[13]||(e[13]=t("span",{class:"indicator-label"},"ADX (14)",-1)),t("span",{class:w(["indicator-value",i.getSignalClass((Lt=(Nt=s.technicalData)==null?void 0:Nt.adx14)==null?void 0:Lt.signal)])},l(i.formatValue(($t=(Pt=s.technicalData)==null?void 0:Pt.adx14)==null?void 0:$t.value)),3)]),t("div",Pi,[e[14]||(e[14]=t("span",{class:"indicator-label"},"MACD (12,26)",-1)),t("span",{class:w(["indicator-value",i.getSignalClass((Et=(Rt=s.technicalData)==null?void 0:Rt.macd)==null?void 0:Et.signal)])},l(i.formatValue((Ot=(Ft=s.technicalData)==null?void 0:Ft.macd)==null?void 0:Ot.value)),3)]),t("div",$i,[e[15]||(e[15]=t("span",{class:"indicator-label"},"VWMA (20)",-1)),t("span",{class:w(["indicator-value",i.getSignalClass((Vt=(Ut=s.technicalData)==null?void 0:Ut.vwma20)==null?void 0:Vt.signal)])},l(i.formatValue((Bt=(Wt=s.technicalData)==null?void 0:Wt.vwma20)==null?void 0:Bt.value)),3)]),i.hasYFinanceData?(u(),h("div",Ri,[e[16]||(e[16]=t("span",{class:"indicator-label"},"Volume",-1)),t("div",Ei,[t("span",Fi,l(i.formatVolume((Ht=(qt=s.technicalData)==null?void 0:qt.yf)==null?void 0:Ht.volume_last_day)),1),t("span",{class:w(["price-diff",i.getPercentChangeClass((jt=(zt=s.technicalData)==null?void 0:zt.yf)==null?void 0:jt.volume_last_day_pct)])},l(i.formatPercentChange((Qt=(Gt=s.technicalData)==null?void 0:Gt.yf)==null?void 0:Qt.volume_last_day_pct)),3)])])):_("",!0),i.hasYFinanceData?(u(),h("div",Oi,[e[17]||(e[17]=t("span",{class:"indicator-label"},"5D Avg Volume",-1)),t("div",Ui,[t("span",Vi,l(i.formatVolume((Xt=(Yt=s.technicalData)==null?void 0:Yt.yf)==null?void 0:Xt.avg_volume_5d)),1),t("span",{class:w(["price-diff",i.getPercentChangeClass((Jt=(Kt=s.technicalData)==null?void 0:Kt.yf)==null?void 0:Jt.avg_volume_5d_pct)])},l(i.formatPercentChange((es=(Zt=s.technicalData)==null?void 0:Zt.yf)==null?void 0:es.avg_volume_5d_pct)),3)])])):_("",!0),i.hasYFinanceData?(u(),h("div",Wi,[e[18]||(e[18]=t("span",{class:"indicator-label"},"Market Cap",-1)),t("span",Bi,l(i.formatMarketCap((ss=(ts=s.technicalData)==null?void 0:ts.yf)==null?void 0:ss.market_cap)),1)])):_("",!0),i.hasYFinanceData?(u(),h("div",qi,[e[19]||(e[19]=t("span",{class:"indicator-label"},"Beta (3mo)",-1)),t("span",Hi,l(i.formatBeta((ns=(as=s.technicalData)==null?void 0:as.yf)==null?void 0:ns.beta_3mo)),1)])):_("",!0),i.hasYFinanceData?(u(),h("div",zi,[e[20]||(e[20]=t("span",{class:"indicator-label"},"Beta (1y)",-1)),t("span",ji,l(i.formatBeta((os=(is=s.technicalData)==null?void 0:is.yf)==null?void 0:os.beta_1y)),1)])):_("",!0),i.hasYFinanceData?(u(),h("div",Gi,[e[21]||(e[21]=t("span",{class:"indicator-label"},"Beta (5y)",-1)),t("span",Qi,l(i.formatBeta((ls=(rs=s.technicalData)==null?void 0:rs.yf)==null?void 0:ls.beta_5y)),1)])):_("",!0),t("div",Yi,[e[22]||(e[22]=t("span",{class:"indicator-label"},"üîç YFinance Debug",-1)),t("div",Xi," hasYF: "+l(i.hasYFinanceData)+" | hasTechData: "+l(!!s.technicalData)+" | yfKeys: "+l((cs=s.technicalData)!=null&&cs.yf?Object.keys(s.technicalData.yf).join(", "):"none"),1)])]))])}const fs=R(oi,[["render",Ki],["__scopeId","data-v-bd4013bc"]]),Ji={name:"StockCard",components:{FastTradingViewWidget:ms,TechnicalAnalysisWidget:ii,TechnicalIndicators:fs},props:{quote:{type:Object,required:!0},dailyData:{type:Object,default:null},metadata:{type:Object,default:null}},computed:{isStale(){return this.quote.stale_level!=="fresh"},domId(){return`sym-${this.sanitizeSymbol(this.quote.symbol)}`}},methods:{getSector(){return!this.metadata||this.metadata.confidence<.7?"Unknown":this.metadata.sector||"Unknown"},getIndustry(){return!this.metadata||this.metadata.confidence<.7?"Unknown Industry":this.metadata.industry||this.metadata.sector||"Unknown Industry"},getIndustryCategory(){const n=this.getIndustry();return{"Industrial IoT Solutions":"tech-iot","Satellite Imaging & Analytics":"tech-satellite","Database Software":"tech-software","Enterprise Software":"tech-software",Semiconductors:"tech-hardware","Aerospace & Defense":"industrial-aerospace","Space Infrastructure":"industrial-space","Satellite Communications":"communications","Electric Vehicles":"automotive","Unknown Industry":"unknown"}[n]||"other"},getExchange(){if(this.metadata&&this.metadata.exchange)return{NYQ:"NYSE",NMS:"NASDAQ",NCM:"NASDAQ",NGM:"NASDAQ",ASE:"AMEX"}[this.metadata.exchange]||this.metadata.exchange;const n=this.quote.symbol;return["ORCL","TSM","RDW","CRM","PL","LEU","SMR","IONQ","HIMS"].includes(n)?"NYSE":(["ASTS","RIVN","ONDS","AVAV","MDB","RKLB","NVDA","AVGO","AMZN","GOOG","META","NFLX","CRWV","PLTR","TSLA"].includes(n),"NASDAQ")},getStaleText(){switch(this.quote.stale_level){case"stale":return"üü° Stale Data";case"very_stale":return"üî¥ Very Stale";default:return""}},goToDetail(){console.log("Navigating to stock detail for:",this.quote.symbol),this.$router.push({name:"stock-detail",params:{symbol:this.quote.symbol}}).catch(n=>{console.error("Navigation error:",n)})},sanitizeSymbol(n){return n.replace(/[^a-zA-Z0-9]/g,"_")}}},Zi=["id","data-symbol"],eo={class:"stock-info-header"},to={class:"symbol-info"},so={class:"symbol"},ao={class:"symbol-tags"},no={class:"exchange-tag"},io={class:"header-actions"},oo=["title"],ro={class:"widgets-container"},lo={class:"widget-overview"},co={class:"widget-overview"},uo={key:0,class:"additional-info"},ho={class:"brief-section"},go={class:"brief-text"},mo={key:1,class:"stale-indicator"};function fo(n,e,a,o,s,i){const r=V("FastTradingViewWidget"),d=V("TechnicalAnalysisWidget"),c=V("TechnicalIndicators");return u(),h("div",{class:"stock-card-pair",id:i.domId,"data-symbol":a.quote.symbol,tabindex:"-1"},[t("div",eo,[t("div",to,[t("h3",so,l(a.quote.symbol),1),t("div",ao,[t("span",no,l(i.getExchange()),1),t("span",{class:w(["industry-tag",`industry-${i.getIndustryCategory()}`])},l(i.getIndustry()),3)])]),t("div",io,[t("button",{onClick:e[0]||(e[0]=(...g)=>i.goToDetail&&i.goToDetail(...g)),class:"detail-btn",title:`View detailed analysis for ${a.quote.symbol}`},[...e[1]||(e[1]=[A(" Detail ",-1),t("span",{class:"btn-icon"},"‚Üí",-1)])],8,oo)])]),t("div",ro,[t("div",lo,[e[2]||(e[2]=t("div",{class:"widget-header"},[t("h4",null,"Symbol Overview")],-1)),$(r,{"widget-type":"overview",symbol:a.quote.symbol,exchange:i.getExchange(),priority:1},null,8,["symbol","exchange"])]),t("div",co,[e[3]||(e[3]=t("div",{class:"widget-header"},[t("h4",null,"Technical Analysis")],-1)),$(d,{symbol:a.quote.symbol,exchange:i.getExchange(),priority:2},null,8,["symbol","exchange"])])]),a.dailyData?(u(),h("div",uo,[t("div",ho,[e[4]||(e[4]=t("h5",null,"Daily Brief",-1)),t("p",go,l(a.dailyData.short_brief_zh),1)])])):_("",!0),$(c,{symbol:a.quote.symbol,exchange:i.getExchange()},null,8,["symbol","exchange"]),i.isStale?(u(),h("div",mo,[t("span",{class:w(["stale-badge",`stale-${a.quote.stale_level}`])},l(i.getStaleText()),3)])):_("",!0)],8,Zi)}const po=R(Ji,[["render",fo],["__scopeId","data-v-80d1339d"]]),vo={name:"TOCTree",props:{nodes:{type:Array,default:()=>[]},activeSymbol:{type:String,default:""},searchQuery:{type:String,default:""}},emits:["symbol-click"],methods:{onSymbolClick(n){this.$emit("symbol-click",n)},getTotalSymbolCount(n){return n.children.reduce((e,a)=>e+a.children.length,0)}}},yo={class:"toc-tree"},wo={class:"tree-label sector-label"},So=["title"],bo={class:"item-count"},_o={class:"tree-children"},ko={class:"tree-label industry-label"},Co=["title"],To={class:"item-count"},Do={class:"tree-children"},Ao=["aria-current","onClick","onKeydown"],Io=["title"],xo={class:"exchange-badge"};function Mo(n,e,a,o,s,i){return u(),h("div",yo,[(u(!0),h(E,null,F(a.nodes,r=>(u(),h("div",{key:r.id,class:"tree-node sector-node"},[t("div",wo,[t("span",{class:"label-text",title:r.label},l(r.label),9,So),t("span",bo,"("+l(i.getTotalSymbolCount(r))+")",1)]),t("div",_o,[(u(!0),h(E,null,F(r.children,d=>(u(),h("div",{key:d.id,class:"tree-node industry-node"},[t("div",ko,[t("span",{class:"label-text",title:d.label},l(d.label),9,Co),t("span",To,"("+l(d.children.length)+")",1)]),t("div",Do,[(u(!0),h(E,null,F(d.children,c=>(u(),h("button",{key:c.id,class:w(["tree-node symbol-node",{"is-active":c.symbol===a.activeSymbol}]),"aria-current":c.symbol===a.activeSymbol?"location":null,onClick:g=>i.onSymbolClick(c.symbol),onKeydown:[Je(g=>i.onSymbolClick(c.symbol),["enter"]),Je(Is(g=>i.onSymbolClick(c.symbol),["prevent"]),["space"])]},[t("span",{class:"symbol-text",title:c.label},l(c.label),9,Io),t("span",xo,l(c.metadata.exchange),1)],42,Ao))),128))])]))),128))])]))),128))])}const No=R(vo,[["render",Mo],["__scopeId","data-v-19f77406"]]),Lo={name:"NavigationPanel",components:{TOCTree:No},props:{tocTree:{type:Array,default:()=>[]},activeSymbol:{type:String,default:""},searchQuery:{type:String,default:""},isVisible:{type:Boolean,default:!0}},emits:["symbol-click","search-change"],data(){return{localSearchQuery:this.searchQuery}},computed:{filteredTocTree(){if(!this.localSearchQuery.trim())return this.tocTree;const n=this.localSearchQuery.toLowerCase().trim();return this.tocTree.map(e=>{const a={...e,children:[]};return e.children.forEach(o=>{const s={...o,children:[]};o.children.forEach(i=>{[e.label,o.label,i.label,i.symbol].some(d=>d.toLowerCase().includes(n))&&s.children.push(i)}),s.children.length>0&&a.children.push(s)}),a.children.length>0?a:null}).filter(Boolean)}},watch:{searchQuery(n){this.localSearchQuery=n}},methods:{onSymbolClick(n){this.$emit("symbol-click",n)},onSearchChange(){this.$emit("search-change",this.localSearchQuery)}}},Po={class:"panel-header"},$o={class:"search-container"},Ro={class:"panel-content"};function Eo(n,e,a,o,s,i){const r=V("TOCTree");return u(),h("div",{class:w(["navigation-panel",{"is-visible":a.isVisible}])},[t("div",Po,[e[3]||(e[3]=t("h3",null,"Quick Navigation",-1)),t("div",$o,[H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>s.localSearchQuery=d),type:"text",placeholder:"Search stocks, sectors, industries...",class:"search-input","aria-label":"Search stocks",onInput:e[1]||(e[1]=(...d)=>i.onSearchChange&&i.onSearchChange(...d))},null,544),[[me,s.localSearchQuery]]),e[2]||(e[2]=t("span",{class:"search-icon"},"üîç",-1))])]),t("div",Ro,[$(r,{nodes:i.filteredTocTree,"active-symbol":a.activeSymbol,"search-query":s.localSearchQuery,onSymbolClick:i.onSymbolClick},null,8,["nodes","active-symbol","search-query","onSymbolClick"])])],2)}const Fo=R(Lo,[["render",Eo],["__scopeId","data-v-99dc733f"]]);class Oo{constructor(){this.headerOffset=80}async scrollToSymbol(e,a=!0){try{const s=`sym-${this.sanitizeSymbol(e)}`,i=document.getElementById(s);if(!i){console.warn(`NavigationService: Element with ID "${s}" not found for symbol "${e}"`);return}const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches,c=i.offsetTop-this.getHeaderOffset(),g=window.pageYOffset,v=Math.abs(c-g),m=window.innerHeight*2,T=v>m||r,S=a&&!T;console.log(`NavigationService: Scroll distance ${v}px, threshold ${m}px, using ${S?"smooth":"instant"} scroll`),window.scrollTo({top:Math.max(0,c),behavior:S?"smooth":"instant"}),S&&await this.waitForScrollComplete(),i.focus({preventScroll:!0}),console.log(`NavigationService: Scrolled to symbol "${e}" (ID: ${s}) using ${S?"smooth":"instant"} behavior`)}catch(o){console.error("NavigationService: Error scrolling to symbol:",o)}}sanitizeSymbol(e){return e.replace(/[^a-zA-Z0-9]/g,"_")}updateQueryParam(e){console.warn("DEPRECATED: NavigationService.updateQueryParam() should not be used with Hash Router. Use Vue Router query methods instead.");try{const a=new URL(window.location);e?a.searchParams.set("focus",e):a.searchParams.delete("focus"),window.history.replaceState(null,"",a.toString()),console.log(`NavigationService: Updated URL query param to focus=${e}`)}catch(a){console.error("NavigationService: Error updating query param:",a)}}getFocusSymbolFromQuery(){console.warn("DEPRECATED: NavigationService.getFocusSymbolFromQuery() should not be used with Hash Router. Use Vue Router $route.query.focus instead.");try{return new URL(window.location).searchParams.get("focus")}catch(e){return console.error("NavigationService: Error reading query param:",e),null}}getHeaderOffset(){try{const e=document.querySelector("header, .header, .navbar, .app-header");if(e)return e.getBoundingClientRect().height+20}catch(e){console.warn("NavigationService: Could not calculate header height:",e)}return this.headerOffset}waitForScrollComplete(){return new Promise(e=>{let a=window.pageYOffset,o=null;const s=()=>{const i=window.pageYOffset;Math.abs(i-a)<1?(clearTimeout(o),e()):(a=i,o=setTimeout(s,50))};o=setTimeout(s,50),setTimeout(e,2e3)})}isSymbolValid(e){const o=`sym-${this.sanitizeSymbol(e)}`;return document.getElementById(o)!==null}}const hs=new Oo;class Uo{constructor(){this.observer=null,this.callback=null,this.observedElements=new Map,this.isActive=!1,this.observerOptions={root:null,rootMargin:"-80px 0px -50% 0px",threshold:[0,.1,.25,.5,.75,1]}}setup(e,a){try{this.cleanup(),this.callback=a,this.observedElements.clear(),this.observer=new IntersectionObserver(this.handleIntersection.bind(this),this.observerOptions),e.forEach(o=>{const s=o.dataset.symbol;s&&(this.observedElements.set(o,s),this.observer.observe(o))}),this.isActive=!0,console.log(`ScrollSpyService: Started observing ${e.length} elements`)}catch(o){console.error("ScrollSpyService: Error setting up observer:",o)}}handleIntersection(e){if(!(!this.isActive||!this.callback))try{const a=[];if(e.forEach(s=>{const i=this.observedElements.get(s.target);i&&s.isIntersecting&&a.push({element:s.target,symbol:i,intersectionRatio:s.intersectionRatio,boundingClientRect:s.boundingClientRect})}),a.length===0)return;const o=this.determineActiveSymbol(a);o&&this.debouncedCallback(o)}catch(a){console.error("ScrollSpyService: Error handling intersection:",a)}}determineActiveSymbol(e){if(e.length===0)return null;if(e.length===1)return e[0].symbol;const o=window.innerHeight/2;let s=e[0],i=this.calculateElementScore(s,o);for(let r=1;r<e.length;r++){const d=e[r],c=this.calculateElementScore(d,o);c>i&&(s=d,i=c)}return s.symbol}calculateElementScore(e,a){const{intersectionRatio:o,boundingClientRect:s}=e,i=s.top+s.height/2,c=1-Math.abs(i-a)/a;return o*.7+c*.3}debouncedCallback(e){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.callback&&this.isActive&&this.callback(e)},100)}updateActiveSymbol(e){this.callback&&this.isActive&&this.callback(e)}refresh(){if(!(!this.observer||!this.isActive))try{const e=Array.from(this.observedElements.keys()),a=[];e.forEach(s=>{const i=s.getBoundingClientRect(),r=this.observedElements.get(s);if(i.top<window.innerHeight&&i.bottom>0&&r){const d=this.calculateIntersectionRatio(i);d>0&&a.push({element:s,symbol:r,intersectionRatio:d,boundingClientRect:i})}});const o=this.determineActiveSymbol(a);o&&this.updateActiveSymbol(o)}catch(e){console.error("ScrollSpyService: Error refreshing:",e)}}calculateIntersectionRatio(e){const a=window.innerHeight,s=Math.max(e.top,80),i=Math.min(e.bottom,a);return Math.max(0,i-s)/e.height}cleanup(){try{this.observer&&(this.observer.disconnect(),this.observer=null),this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.observedElements.clear(),this.callback=null,this.isActive=!1,console.log("ScrollSpyService: Cleaned up")}catch(e){console.error("ScrollSpyService: Error during cleanup:",e)}}pause(){this.isActive=!1}resume(){this.isActive=!0,this.refresh()}}const tt=new Uo,Vo={name:"StockOverview",components:{StockCard:po,LazyTradingViewWidget:wt,NavigationPanel:Fo},data(){return{quotes:[],dailyData:null,metadata:null,loading:!1,error:null,lastUpdate:null,configuredSymbols:[],activeSymbol:"",searchQuery:""}},computed:{tickersConfig(){return{symbols:[{proName:"FOREXCOM:SPXUSD",title:"S&P 500 Index"},{proName:"NASDAQ:NDX",title:"NASDAQ 100 Index"},{proName:"OPOFINANCE:DJIUSD",title:"Dow Jone Index"},{proName:"CAPITALCOM:RTY",title:"US Russel 2000"},{proName:"INDEX:BTCUSD",title:"BTC"},{proName:"TVC:GOLD",title:"GOLD"}],colorTheme:"light",locale:"en",largeChartUrl:"",isTransparent:!0,showSymbolLogo:!0}},groupedStocks(){if(!this.quotes.length||!this.metadata)return{};const n={};this.quotes.forEach(s=>{var c,g;const i=this.metadata.items.find(v=>v.symbol===s.symbol),r=(g=(c=this.dailyData)==null?void 0:c.per_symbol)==null?void 0:g.find(v=>v.symbol===s.symbol);let d="Unknown";i&&i.confidence>=.7&&(d=i.sector||"Unknown"),n[d]||(n[d]=[]),n[d].push({quote:s,dailyData:r,metadata:i})});const e=["Technology","Financial Services","Consumer Cyclical","Communication Services","Healthcare","Industrials","Consumer Defensive","Energy","Basic Materials","Real Estate","Utilities"],a={Technology:["Semiconductors","Software - Infrastructure","Consumer Electronics","Software - Application","Information Technology Services","Semiconductor Equipment & Materials","Communication Equipment","Computer Hardware","Electronic Components","Scientific & Technical Instruments","Solar","Electronics & Computer Distribution"],"Financial Services":["Banks - Diversified","Credit Services","Asset Management","Capital Markets","Insurance - Diversified","Banks - Regional","Financial Data & Stock Exchanges","Insurance - Property & Casualty","Insurance Brokers","Insurance - Life","Insurance - Specialty","Mortgage Finance","Insurance - Reinsurance","Financial Conglomerates","Shell Companies"],"Consumer Cyclical":["Internet Retail","Auto Manufacturers","Restaurants","Home Improvement Retail","Travel Services","Apparel Retail","Auto Parts","Specialty Retail","Lodging","Residential Construction","Auto & Truck Dealerships","Packaging & Containers","Footwear & Accessories","Resorts & Casinos","Gambling","Leisure","Apparel Manufacturing","Furnishings, Fixtures & Appliances","Personal Services","Luxury Goods","Recreational Vehicles","Department Stores","Education & Training Services"],"Communication Services":["Internet Content & Information","Telecom Services","Entertainment","Advertising Agencies","Electronic Gaming & Multimedia","Publishing","Broadcasting"],Healthcare:["Drug Manufacturers - General","Biotechnology","Medical Devices","Diagnostics & Research","Healthcare Plans","Medical Instruments & Supplies","Medical Distribution","Medical Care Facilities","Drug Manufacturers - Specialty & Generic","Health Information Services","Pharmaceutical Retailers"],Industrials:["Aerospace & Defense","Specialty Industrial Machinery","Farm & Heavy Construction Machinery","Railroads","Engineering & Construction","Building Products & Equipment","Specialty Business Services","Waste Management","Industrial Distribution","Conglomerates","Integrated Freight & Logistics","Electrical Equipment & Parts","Rental & Leasing Services","Airlines","Trucking","Consulting Services","Tools & Accessories","Metal Fabrication","Pollution & Treatment Controls","Security & Protection Services","Marine Shipping","Airports & Air Services","Staffing & Employment Services","Business Equipment & Supplies","Infrastructure Operations"],"Consumer Defensive":["Discount Stores","Beverages - Non-Alcoholic","Household & Personal Products","Tobacco","Packaged Foods","Confectioners","Farm Products","Food Distribution","Grocery Stores","Education & Training Services","Beverages - Brewers","Beverages - Wineries & Distilleries"],Energy:["Oil & Gas Integrated","Oil & Gas Midstream","Oil & Gas E&P","Oil & Gas Equipment & Services","Oil & Gas Refining & Marketing","Uranium","Oil & Gas Drilling","Thermal Coal","Utilities - Independent Power Producers"],"Basic Materials":["Gold","Specialty Chemicals","Building Materials","Copper","Steel","Agricultural Inputs","Other Industrial Metals & Mining","Chemicals","Other Precious Metals & Mining","Aluminum","Lumber & Wood Production","Silver","Coking Coal","Paper & Paper Products"],"Real Estate":["REIT - Specialty","REIT - Industrial","REIT - Healthcare Facilities","REIT - Retail","REIT - Residential","Real Estate Services","REIT - Mortgage","REIT - Office","REIT - Diversified","REIT - Hotel & Motel","Real Estate - Development","Real Estate - Diversified"],Utilities:["Utilities - Regulated Electric","Utilities - Independent Power Producers","Utilities - Regulated Gas","Utilities - Diversified","Utilities - Renewable","Utilities - Regulated Water"]},o={};return e.forEach(s=>{if(n[s]&&n[s].length>0){const i=a[s]||[],r={};n[s].forEach(c=>{var v;const g=((v=c.metadata)==null?void 0:v.industry)||"Unknown Industry";r[g]||(r[g]=[]),r[g].push(c)});const d=[];i.forEach(c=>{if(r[c]){const g=r[c].sort((v,f)=>{var S,D;const m=((S=v.metadata)==null?void 0:S.market_cap)||0,T=((D=f.metadata)==null?void 0:D.market_cap)||0;return m===T?v.quote.symbol.localeCompare(f.quote.symbol):T-m});d.push(...g)}}),Object.keys(r).forEach(c=>{if(!i.includes(c)){const g=r[c].sort((v,f)=>{var S,D;const m=((S=v.metadata)==null?void 0:S.market_cap)||0,T=((D=f.metadata)==null?void 0:D.market_cap)||0;return m===T?v.quote.symbol.localeCompare(f.quote.symbol):T-m});d.push(...g)}}),o[s]=d}}),Object.keys(n).forEach(s=>{!e.includes(s)&&n[s].length>0&&(o[s]=n[s].sort((i,r)=>i.quote.symbol.localeCompare(r.quote.symbol)))}),o},tocTree(){if(!this.quotes.length||!this.metadata)return[];const n=[];return Object.entries(this.groupedStocks).forEach(([e,a])=>{const o={id:`sector-${this.sanitizeId(e)}`,type:"sector",label:e,children:[]},s={};a.forEach(i=>{var d;const r=((d=i.metadata)==null?void 0:d.industry)||"Unknown Industry";s[r]||(s[r]=[]),s[r].push(i)}),Object.entries(s).forEach(([i,r])=>{const d={id:`industry-${this.sanitizeId(e)}-${this.sanitizeId(i)}`,type:"industry",label:i,children:[]};r.forEach(c=>{var v,f;const g={id:`symbol-${this.sanitizeId(c.quote.symbol)}`,type:"symbol",label:c.quote.symbol,symbol:c.quote.symbol,metadata:{sector:e,industry:i,exchange:this.mapExchangeCode((v=c.metadata)==null?void 0:v.exchange),marketCap:((f=c.metadata)==null?void 0:f.market_cap)||0}};d.children.push(g)}),o.children.push(d)}),n.push(o)}),n},metadataMap(){var e;if(!((e=this.metadata)!=null&&e.items))return new Map;const n=new Map;return this.metadata.items.forEach(a=>{n.set(a.symbol,a)}),n},dailyDataMap(){var e;if(!((e=this.dailyData)!=null&&e.per_symbol))return new Map;const n=new Map;return this.dailyData.per_symbol.forEach(a=>{n.set(a.symbol,a)}),n}},async mounted(){await this.loadStockData(),this.initializeNavigation()},beforeRouteLeave(n,e,a){this.$route.query.focus&&(console.log("Navigation: Clearing focus parameter on route leave"),this.$router.replace({query:{...this.$route.query,focus:void 0}}).catch(()=>{})),a()},beforeUnmount(){this.cleanupNavigation()},methods:{async loadStockData(){this.loading=!0,this.error=null;try{console.log("üöÄ Starting simple stock data load...");const n="/investment-dashboard";this.configuredSymbols=await jn.getEnabledSymbols(),console.log(`‚úÖ Loaded ${this.configuredSymbols.length} symbols from config`);const e=await fetch(`${n}/data/quotes/latest.json?t=`+Date.now());if(!e.ok)throw new Error(`Failed to load quotes: HTTP ${e.status}`);const a=await e.json();a.items&&(this.quotes=a.items.filter(i=>this.configuredSymbols.includes(i.symbol)),this.lastUpdate=a.as_of,console.log(`‚úÖ Loaded ${this.quotes.length} quotes`));const o=await fetch(`${n}/data/daily/2025-12-28.json?t=`+Date.now());o.ok&&(this.dailyData=await o.json(),console.log("‚úÖ Loaded daily data"));const s=await fetch(`${n}/data/symbols_metadata.json?t=`+Date.now());s.ok&&(this.metadata=await s.json(),console.log(`‚úÖ Loaded metadata for ${this.metadata.items.length} symbols`)),console.log("‚úÖ Simple stock data load completed successfully!")}catch(n){this.error=String(n),console.error("‚ùå Simple stock data load failed:",n)}finally{this.loading=!1}},async refresh(){await this.loadStockData()},formatTime(n){if(!n)return"";try{return new Date(n).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return n}},mapExchangeCode(n){return n?{NYQ:"NYSE",NMS:"NASDAQ",NCM:"NASDAQ",NGM:"NASDAQ",ASE:"AMEX"}[n]||n:"Unknown"},sanitizeId(n){return n.replace(/[^a-zA-Z0-9]/g,"_")},async onSymbolClick(n){console.log("Navigation: Symbol clicked:",n),tt.pause();try{await this.$router.replace({query:{...this.$route.query,focus:n}}),await hs.scrollToSymbol(n),this.activeSymbol=n,this.autoExpandForSymbol(n)}finally{setTimeout(()=>{tt.resume()},500)}},onSearchChange(n){this.searchQuery=n},onToggleSection(n,e){e?this.expandedSections.add(n):this.expandedSections.delete(n),this.saveExpandedSections()},autoExpandForSymbol(n){for(const e of this.tocTree)for(const a of e.children)if(a.children.find(s=>s.symbol===n)){this.expandedSections.add(e.id),this.expandedSections.add(a.id),this.saveExpandedSections();return}},saveExpandedSections(){try{const n=Array.from(this.expandedSections);localStorage.setItem("stock-overview-expanded-sections",JSON.stringify(n))}catch(n){console.warn("Failed to save expanded sections:",n)}},loadExpandedSections(){try{const n=localStorage.getItem("stock-overview-expanded-sections");if(n){const e=JSON.parse(n);this.expandedSections=new Set(e)}}catch(n){console.warn("Failed to load expanded sections:",n),this.expandedSections=new Set}},initializeNavigation(){this.loadExpandedSections(),this.expandedSections.size===0&&this.expandAllSections();const n=this.$route.query.focus;n&&this.isSymbolValid(n)&&(console.log("Navigation: Found focus symbol in URL:",n),this.$nextTick(()=>{setTimeout(()=>{this.onSymbolClick(n)},500)})),this.$nextTick(()=>{this.setupScrollSpy()})},setupScrollSpy(){try{const n=document.querySelectorAll("[data-symbol]");if(n.length===0){console.warn("ScrollSpy: No stock card elements found");return}tt.setup(Array.from(n),e=>{console.log("ScrollSpy: Active symbol changed to:",e),this.activeSymbol=e,this.autoExpandForSymbol(e)}),console.log(`ScrollSpy: Initialized with ${n.length} elements`)}catch(n){console.error("Failed to setup ScrollSpy:",n)}},cleanupNavigation(){tt.cleanup()},isSymbolValid(n){return hs.isSymbolValid(n)},expandAllSections(){this.tocTree.forEach(n=>{this.expandedSections.add(n.id),n.children.forEach(e=>{this.expandedSections.add(e.id)})}),this.saveExpandedSections(),console.log("Navigation: Expanded all sections by default")}}},Wo={class:"stock-overview"},Bo={class:"stock-header"},qo={class:"header-right"},Ho={key:0,class:"update-info"},zo={class:"text-muted"},jo={key:0,class:"loading"},Go={key:1,class:"error"},Qo={class:"text-danger"},Yo={key:2,class:"main-layout"},Xo={class:"main-content"},Ko={class:"widget-container-ticker"},Jo={class:"sector-groups"},Zo={class:"sector-title"},er={class:"stock-count"},tr={class:"stocks-in-group"},sr={key:3,class:"no-data"};function ar(n,e,a,o,s,i){const r=V("NavigationPanel"),d=V("LazyTradingViewWidget"),c=V("StockCard");return u(),h("div",Wo,[t("div",Bo,[e[1]||(e[1]=t("h2",null,"Stock Overview",-1)),t("div",qo,[s.lastUpdate?(u(),h("div",Ho,[t("span",zo,"Last updated: "+l(i.formatTime(s.lastUpdate)),1)])):_("",!0)])]),e[5]||(e[5]=t("p",{class:"text-muted mb-3"},"Stock universe overview and analysis",-1)),s.loading?(u(),h("div",jo,[...e[2]||(e[2]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading stock data...",-1)])])):s.error?(u(),h("div",Go,[t("p",Qo,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...g)=>i.refresh&&i.refresh(...g)),class:"btn btn-secondary"},"Retry")])):(u(),h("div",Yo,[$(r,{"toc-tree":i.tocTree,"active-symbol":s.activeSymbol,"search-query":s.searchQuery,"is-visible":!0,onSymbolClick:i.onSymbolClick,onSearchChange:i.onSearchChange,class:"navigation-sidebar"},null,8,["toc-tree","active-symbol","search-query","onSymbolClick","onSearchChange"]),t("div",Xo,[t("div",Ko,[e[3]||(e[3]=t("div",{class:"widget-header"},[t("h3",null,"Market Index")],-1)),$(d,{"widget-type":"Market Index",config:i.tickersConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-tickers.js",height:"100px",priority:1},null,8,["config"])]),t("div",Jo,[(u(!0),h(E,null,F(i.groupedStocks,(g,v)=>(u(),h("div",{key:v,class:"sector-group"},[t("h4",Zo,[A(l(v)+" ",1),t("span",er,"("+l(g.length)+")",1)]),t("div",tr,[(u(!0),h(E,null,F(g,f=>(u(),ft(c,{key:f.quote.symbol,quote:f.quote,"daily-data":f.dailyData,metadata:f.metadata},null,8,["quote","daily-data","metadata"]))),128))])]))),128))])])])),!s.loading&&Object.keys(i.groupedStocks).length===0?(u(),h("div",sr,[...e[4]||(e[4]=[t("p",null,"No stock data available",-1)])])):_("",!0)])}const nr=R(Vo,[["render",ar],["__scopeId","data-v-1db938de"]]),ir={name:"PerformanceMonitor",data(){return{showMonitor:!1,expanded:!0,pageLoadTime:0,widgetsLoaded:0,totalWidgets:0,widgetTimes:[],startTime:0}},computed:{totalSize(){if(typeof performance<"u"&&performance.getEntriesByType){const e=performance.getEntriesByType("resource").reduce((a,o)=>a+(o.transferSize||0),0);return e>1024*1024?`${(e/(1024*1024)).toFixed(1)}MB`:e>1024?`${(e/1024).toFixed(1)}KB`:`${e}B`}return"N/A"},memoryUsage(){if(typeof performance<"u"&&performance.memory){const n=performance.memory.usedJSHeapSize;return n>1024*1024?`${(n/(1024*1024)).toFixed(1)}MB`:`${(n/1024).toFixed(1)}KB`}return"N/A"}},mounted(){this.startTime=performance.now(),this.setupPerformanceTracking();const n=new URLSearchParams(window.location.search).has("debug");this.showMonitor=n,document.readyState==="complete"?this.calculatePageLoadTime():window.addEventListener("load",this.calculatePageLoadTime)},beforeUnmount(){window.removeEventListener("load",this.calculatePageLoadTime)},methods:{setupPerformanceTracking(){if(window.addEventListener("widget-loaded",n=>{n.detail&&this.addWidgetTime({name:n.detail.name,time:n.detail.time,priority:n.detail.priority||1})}),typeof PerformanceObserver<"u")try{const n=new PerformanceObserver(e=>{for(const a of e.getEntries())(a.name.includes("tradingview")||a.name.includes("widget"))&&this.addWidgetTime({name:a.name.split("/").pop()||"Unknown Widget",time:Math.round(a.duration),priority:2})});n.observe({entryTypes:["resource","navigation"]}),this.$once("hook:beforeDestroy",()=>{n.disconnect()})}catch(n){console.warn("PerformanceObserver not supported:",n)}},calculatePageLoadTime(){this.pageLoadTime=Math.round(performance.now()-this.startTime)},addWidgetTime(n){var e;if(this.widgetTimes.push({id:Date.now()+Math.random(),...n}),this.widgetsLoaded++,this.totalWidgets===0){const a=((e=this.$route)==null?void 0:e.path)||window.location.pathname;a.includes("market-dashboard")?this.totalWidgets=5:a.includes("stock-dashboard")?this.totalWidgets=10:this.totalWidgets=this.widgetsLoaded+2}},getTimeClass(n){return n<1e3?"time-good":n<3e3?"time-ok":"time-slow"},toggleMonitor(){this.expanded=!this.expanded},clearMetrics(){this.widgetTimes=[],this.widgetsLoaded=0,this.totalWidgets=0,this.startTime=performance.now()},exportMetrics(){const n={pageLoadTime:this.pageLoadTime,widgetsLoaded:this.widgetsLoaded,totalWidgets:this.totalWidgets,totalSize:this.totalSize,memoryUsage:this.memoryUsage,widgetTimes:this.widgetTimes,timestamp:new Date().toISOString(),url:window.location.href},e=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=`performance-${Date.now()}.json`,o.click(),URL.revokeObjectURL(a)}}},or={key:0,class:"performance-monitor"},rr={class:"monitor-header"},lr={key:0,class:"monitor-content"},cr={class:"metrics-grid"},dr={class:"metric-card"},ur={class:"metric-value"},hr={class:"metric-card"},gr={class:"metric-value"},mr={class:"metric-card"},fr={class:"metric-value"},pr={class:"metric-card"},vr={class:"metric-value"},yr={class:"widgets-list"},wr={class:"widget-name"},Sr={class:"widget-priority"},br={class:"actions"};function _r(n,e,a,o,s,i){return s.showMonitor?(u(),h("div",or,[t("div",rr,[e[3]||(e[3]=t("h4",null,"Performance Monitor",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.toggleMonitor&&i.toggleMonitor(...r)),class:"toggle-btn"},l(s.expanded?"‚àí":"+"),1)]),s.expanded?(u(),h("div",lr,[t("div",cr,[t("div",dr,[e[4]||(e[4]=t("div",{class:"metric-label"},"Page Load",-1)),t("div",ur,l(s.pageLoadTime)+"ms",1)]),t("div",hr,[e[5]||(e[5]=t("div",{class:"metric-label"},"Widgets Loaded",-1)),t("div",gr,l(s.widgetsLoaded)+"/"+l(s.totalWidgets),1)]),t("div",mr,[e[6]||(e[6]=t("div",{class:"metric-label"},"Total Size",-1)),t("div",fr,l(i.totalSize),1)]),t("div",pr,[e[7]||(e[7]=t("div",{class:"metric-label"},"Memory Usage",-1)),t("div",vr,l(i.memoryUsage),1)])]),t("div",yr,[e[8]||(e[8]=t("h5",null,"Widget Load Times",-1)),(u(!0),h(E,null,F(s.widgetTimes,r=>(u(),h("div",{key:r.id,class:"widget-item"},[t("span",wr,l(r.name),1),t("span",{class:w(["widget-time",i.getTimeClass(r.time)])},l(r.time)+"ms ",3),t("span",Sr,"P"+l(r.priority),1)]))),128))]),t("div",br,[t("button",{onClick:e[1]||(e[1]=(...r)=>i.clearMetrics&&i.clearMetrics(...r)),class:"clear-btn"},"Clear"),t("button",{onClick:e[2]||(e[2]=(...r)=>i.exportMetrics&&i.exportMetrics(...r)),class:"export-btn"},"Export")])])):_("",!0)])):_("",!0)}const ps=R(ir,[["render",_r],["__scopeId","data-v-58a91d47"]]),kr={name:"StockDashboard",components:{StockOverview:nr,PerformanceMonitor:ps}},Cr={class:"stock-dashboard"};function Tr(n,e,a,o,s,i){const r=V("PerformanceMonitor"),d=V("StockOverview");return u(),h("div",Cr,[$(r),$(d)])}const Dr=R(kr,[["render",Tr],["__scopeId","data-v-bd53c7a2"]]),Ar={name:"Settings"},Ir={class:"settings"};function xr(n,e,a,o,s,i){return u(),h("div",Ir,[...e[0]||(e[0]=[se('<h2>Settings</h2><p class="text-muted mb-3">Configure system preferences and view diagnostics</p><div class="card"><h3>Privacy &amp; Analytics</h3><p class="text-muted">Toggle tracking and scraping preferences</p></div><div class="card"><h3>System Diagnostics</h3><p class="text-muted">View system status and data freshness</p></div><div class="card"><h3>Import/Export</h3><p class="text-muted">Backup and restore your configuration</p></div>',5)])])}const Mr=R(Ar,[["render",xr]]),Nr={name:"MarketRegimeWidget",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},priority:{type:Number,default:3}},data(){return{loaded:!1,error:!1,loadStartTime:0,isVisible:!1,observer:null}},computed:{containerId(){return`market-regime-${this.symbol}-${Date.now()}`}},async mounted(){this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupIntersectionObserver(){const n={1:"300px",2:"150px",3:"50px"};this.observer=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&!this.loaded&&!this.error&&(this.isVisible=!0,this.loadWidget(),this.observer.disconnect())})},{rootMargin:n[this.priority]||"50px",threshold:.1}),this.observer.observe(this.$refs.container)},async loadWidget(){this.loadStartTime=performance.now(),this.loaded=!1,this.error=!1;try{const e={1:0,2:300,3:600}[this.priority]||0;e>0&&await new Promise(a=>setTimeout(a,e)),await this.createWidget()}catch(n){console.error("Failed to load Market Regime widget:",n),this.error=!0}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(async()=>{const a=this.$refs.container;if(!a){e(new Error("Container not found"));return}const o=this.getWidgetConfig(),s="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js",i=document.createElement("script");i.type="text/javascript",i.src=s,i.async=!0,i.innerHTML=JSON.stringify(o);const r=setTimeout(()=>{this.error=!0,e(new Error("Widget load timeout"))},8e3);i.onload=()=>{clearTimeout(r),this.loaded=!0;const c=performance.now()-this.loadStartTime;console.log(`Market Regime widget ${this.symbol} loaded in ${c.toFixed(2)}ms`),n()},i.onerror=()=>{clearTimeout(r),this.error=!0,e(new Error("Script load failed"))};const d=a.querySelector(".tradingview-widget-container__widget");d?d.appendChild(i):a.appendChild(i)})})},getWidgetConfig(){return{allow_symbol_change:!0,calendar:!1,details:!1,hide_side_toolbar:!0,hide_top_toolbar:!1,hide_legend:!1,hide_volume:!1,hotlist:!1,interval:"D",locale:"en",save_image:!0,style:"9",symbol:`${this.exchange}:${this.symbol}`,theme:"light",timezone:"Etc/UTC",backgroundColor:"#ffffff",gridColor:"rgba(46, 46, 46, 0.06)",watchlist:[],withdateranges:!0,range:"6M",compareSymbols:[],studies:["STD;Ichimoku%1Cloud","STD;BBTrend","STD;TEMA","STD;Awesome_Oscillator","STD;Average%1Directional%1Index"],autosize:!0}},async retry(){this.setupIntersectionObserver()}}},Lr=["id"],Pr={key:0,class:"chart-loading"},$r={key:1,class:"chart-error"},Rr={class:"tradingview-widget-container",style:{height:"100%",width:"100%"}},Er={class:"tradingview-widget-copyright"},Fr=["href"],Or={class:"blue-text"};function Ur(n,e,a,o,s,i){return u(),h("div",{class:"advanced-chart-widget",id:i.containerId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",Pr,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading Market Regime...",-1)])])):_("",!0),s.error?(u(),h("div",$r,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0),H(t("div",Rr,[e[4]||(e[4]=t("div",{class:"tradingview-widget-container__widget",style:{height:"calc(100% - 32px)",width:"100%"}},null,-1)),t("div",Er,[t("a",{href:`https://www.tradingview.com/symbols/${a.exchange}-${a.symbol}/`,rel:"noopener nofollow",target:"_blank"},[t("span",Or,l(a.symbol)+" stock chart",1)],8,Fr),e[3]||(e[3]=t("span",{class:"trademark"}," by TradingView",-1))])],512),[[pt,s.loaded]])],8,Lr)}const Vr=R(Nr,[["render",Ur],["__scopeId","data-v-ae8a7688"]]),Wr={name:"TradingStrategyWidget",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},priority:{type:Number,default:4}},data(){return{loaded:!1,error:!1,loadStartTime:0,isVisible:!1,observer:null}},computed:{containerId(){return`trading-strategy-${this.symbol}-${Date.now()}`}},async mounted(){this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupIntersectionObserver(){const n={1:"300px",2:"150px",3:"50px",4:"25px"};this.observer=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&!this.loaded&&!this.error&&(this.isVisible=!0,this.loadWidget(),this.observer.disconnect())})},{rootMargin:n[this.priority]||"25px",threshold:.1}),this.observer.observe(this.$refs.container)},async loadWidget(){this.loadStartTime=performance.now(),this.loaded=!1,this.error=!1;try{const e={1:0,2:300,3:600,4:900}[this.priority]||0;e>0&&await new Promise(a=>setTimeout(a,e)),await this.createWidget()}catch(n){console.error("Failed to load Trading Strategy widget:",n),this.error=!0}},async createWidget(){return new Promise((n,e)=>{this.$nextTick(async()=>{const a=this.$refs.container;if(!a){e(new Error("Container not found"));return}const o=this.getWidgetConfig(),s="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js",i=document.createElement("script");i.type="text/javascript",i.src=s,i.async=!0,i.innerHTML=JSON.stringify(o);const r=setTimeout(()=>{this.error=!0,e(new Error("Widget load timeout"))},8e3);i.onload=()=>{clearTimeout(r),this.loaded=!0;const c=performance.now()-this.loadStartTime;console.log(`Trading Strategy widget ${this.symbol} loaded in ${c.toFixed(2)}ms`),n()},i.onerror=()=>{clearTimeout(r),this.error=!0,e(new Error("Script load failed"))};const d=a.querySelector(".tradingview-widget-container__widget");d?d.appendChild(i):a.appendChild(i)})})},getWidgetConfig(){return{allow_symbol_change:!0,calendar:!1,details:!1,hide_side_toolbar:!0,hide_top_toolbar:!1,hide_legend:!1,hide_volume:!1,hotlist:!1,interval:"D",locale:"en",save_image:!0,style:"9",symbol:`${this.exchange}:${this.symbol}`,theme:"light",timezone:"Etc/UTC",backgroundColor:"#ffffff",gridColor:"rgba(46, 46, 46, 0.06)",watchlist:[],withdateranges:!0,range:"6M",compareSymbols:[],studies:["STD;MACD","STD;Donchian_Channels","STD;TRIX","STD;RSI"],autosize:!0}},async retry(){this.setupIntersectionObserver()}}},Br=["id"],qr={key:0,class:"chart-loading"},Hr={key:1,class:"chart-error"},zr={class:"tradingview-widget-container",style:{height:"100%",width:"100%"}},jr={class:"tradingview-widget-copyright"},Gr=["href"],Qr={class:"blue-text"};function Yr(n,e,a,o,s,i){return u(),h("div",{class:"advanced-chart-widget",id:i.containerId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",qr,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading Trading Strategy...",-1)])])):_("",!0),s.error?(u(),h("div",Hr,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0),H(t("div",zr,[e[4]||(e[4]=t("div",{class:"tradingview-widget-container__widget",style:{height:"calc(100% - 32px)",width:"100%"}},null,-1)),t("div",jr,[t("a",{href:`https://www.tradingview.com/symbols/${a.exchange}-${a.symbol}/`,rel:"noopener nofollow",target:"_blank"},[t("span",Qr,l(a.symbol)+" stock chart",1)],8,Gr),e[3]||(e[3]=t("span",{class:"trademark"}," by TradingView",-1))])],512),[[pt,s.loaded]])],8,Br)}const Xr=R(Wr,[["render",Yr],["__scopeId","data-v-340bda90"]]);function Y(n){const e="/investment-dashboard/",a=String(n).replace(/^\/+/,"");return`${e}${a}`}const ot={ohlcv:n=>Y(`data/ohlcv/${n.toUpperCase()}.json`),ohlcvPrecomputed:(n,e="1d",a=90)=>Y(`data/ohlcv/${n.toLowerCase()}_${e}_${a}d.json`),ohlcvIndex:(n={})=>{const e=Y("data/ohlcv/index.json");return n.v?`${e}?v=${n.v}`:e},technicalIndicators:(n,e)=>Y(`data/technical-indicators/${n}_${e}.json`),technicalIndicatorsIndex:(n={})=>{const e=Y("data/technical-indicators/latest_index.json");return n.v?`${e}?v=${n.v}`:e},symbolsMetadata:()=>Y("data/symbols_metadata.json"),sectorIndustry:()=>Y("data/sector_industry.json"),universe:()=>Y("config/universe.json"),stocks:()=>Y("config/stocks.json"),status:(n={})=>{const e=Y("data/status.json");return n.v?`${e}?v=${n.v}`:e},packageJson:()=>Y("package.json"),quotesLatest:()=>Y("data/quotes/latest.json"),daily:n=>Y(`data/daily/${n}.json`)},vs=Object.freeze(Object.defineProperty({__proto__:null,paths:ot,withBase:Y},Symbol.toStringTag,{value:"Module"}));class Kr{constructor(){this.cache=new Map,this.cacheTimeout=30*60*1e3}async getOhlcv(e,a="1d",o="3mo"){var i;const s=`${e}_${a}_${o}`;if(this.cache.has(s)){const r=this.cache.get(s);if(Date.now()-r.timestamp<this.cacheTimeout)return console.log(`üìä Using cached OHLCV for ${e}`),r.data}try{const r=await this.fetchLocalOhlcv(e,a,o);if(r)return this.cache.set(s,{data:r,timestamp:Date.now()}),console.log(`üìä Loaded local OHLCV for ${e}: ${((i=r.timestamps)==null?void 0:i.length)||0} points`),r}catch(r){console.warn(`üìä Local OHLCV failed for ${e}:`,r.message)}if(new URLSearchParams(window.location.search).has("debug"))try{console.log(`üìä DEV mode: trying Yahoo Finance fallback for ${e}`);const r=await ie.getOhlcv(e,a,o);if(r&&this.validateOhlcvData(r))return this.cache.set(s,{data:r,timestamp:Date.now()}),console.log(`üìä Yahoo Finance fallback success for ${e}`),r}catch(r){console.warn(`üìä Yahoo Finance fallback failed for ${e}:`,r.message)}return console.warn(`üìä No OHLCV data available for ${e}`),null}async fetchLocalOhlcv(e,a,o){const s=ot.ohlcv(e),i=await fetch(s);if(!i.ok){if(i.status===404)return console.log(`üìä Local OHLCV not found for ${e} (404)`),null;throw new Error(`HTTP ${i.status}: ${i.statusText}`)}const r=await i.json();if(!this.validateOhlcvData(r))throw new Error("Invalid local OHLCV data structure");return{...r,metadata:{...r.metadata,source:"Local JSON",symbol:e,period:a,range:o,loadedAt:new Date().toISOString()}}}validateOhlcvData(e){if(!e||typeof e!="object")return!1;const a=["timestamps","open","high","low","close","volume"];for(const s of a)if(!Array.isArray(e[s]))return console.error(`üìä OHLCV validation failed: missing ${s}`),!1;const o=e.timestamps.length;for(const s of a)if(e[s].length!==o)return console.error(`üìä OHLCV validation failed: ${s} length mismatch`),!1;return o<20?(console.error(`üìä OHLCV validation failed: insufficient data (${o} < 20)`),!1):!0}async isLocalAvailable(e){try{return await this.fetchLocalOhlcv(e,"1d","3mo")!==null}catch{return!1}}clearCache(){this.cache.clear(),console.log("üìä OHLCV cache cleared")}getCacheStats(){const e={};for(const[a,o]of this.cache.entries())e[a]={age:Date.now()-o.timestamp,expired:Date.now()-o.timestamp>this.cacheTimeout};return e}}const Jr=new Kr;function Zr(n,e,a,o,s=14){if(!n||!e||!a||!o)throw new Error("MFI calculation requires high, low, close, and volume arrays");const i=Math.min(n.length,e.length,a.length,o.length);if(i<s+1)throw new Error(`Insufficient data for MFI calculation: need at least ${s+1} data points, got ${i}`);console.log(`üìä Calculating MFI with ${i} data points, period=${s}`);const r=new Array(i);for(let m=0;m<i;m++)n[m]!=null&&e[m]!=null&&a[m]!=null?r[m]=(n[m]+e[m]+a[m])/3:r[m]=null;const d=new Array(i);for(let m=0;m<i;m++)r[m]!=null&&o[m]!=null?d[m]=r[m]*o[m]:d[m]=null;const c=new Array(i),g=new Array(i);c[0]=0,g[0]=0;for(let m=1;m<i;m++)r[m]!=null&&r[m-1]!=null&&d[m]!=null?r[m]>r[m-1]?(c[m]=d[m],g[m]=0):r[m]<r[m-1]?(c[m]=0,g[m]=d[m]):(c[m]=0,g[m]=0):(c[m]=0,g[m]=0);const v=new Array(i).fill(null);for(let m=s;m<i;m++){let T=0,S=0,D=0;for(let b=m-s+1;b<=m;b++)c[b]!=null&&g[b]!=null&&(T+=c[b],S+=g[b],D++);if(D>=Math.floor(s*.7))if(S===0)v[m]=100;else{const b=T/S;v[m]=100-100/(1+b)}}const f=v.filter(m=>m!==null).length;return console.log(`üìä MFI calculation complete: ${f}/${i} valid values`),v}function el(n){return n==null||isNaN(n)?"NEUTRAL":n>=80?"OVERBOUGHT":n<=20?"OVERSOLD":"NEUTRAL"}function tl(n,e=14){try{const a=Zr(n.high,n.low,n.close,n.volume,e);let o=null;for(let g=a.length-1;g>=0;g--)if(a[g]!=null&&!isNaN(a[g])){o=a[g];break}const s=el(o),i=a.filter(g=>g!=null&&!isNaN(g)),r=i.length>0?i.reduce((g,v)=>g+v,0)/i.length:null,d=i.length>0?Math.max(...i):null,c=i.length>0?Math.min(...i):null;return{values:a,latest:o,signal:s,period:e,statistics:{average:r,maximum:d,minimum:c,validCount:i.length,totalCount:a.length},metadata:{calculatedAt:new Date().toISOString(),dataPoints:n.close.length,algorithm:"Standard MFI"}}}catch(a){return console.error("üìä MFI calculation failed:",a),{values:[],latest:null,signal:"ERROR",period:e,error:a.message,metadata:{calculatedAt:new Date().toISOString(),algorithm:"Standard MFI"}}}}function sl(n,e=20,a=14,o={}){const{mfiAvgMode:s="weighted"}=o;if(console.log(`üìä Calculating MFI Volume Profile with ${e} bins, MFI period=${a}, avgMode=${s}`),!n||!n.high||!n.low||!n.close||!n.volume)throw new Error("Invalid OHLCV data for MFI Volume Profile calculation");const i=Math.min(n.high.length,n.low.length,n.close.length,n.volume.length);if(i<a+10)throw new Error(`Insufficient data for MFI Volume Profile: need at least ${a+10} data points, got ${i}`);try{const r=tl(n,a),d=[];for(let k=0;k<i;k++)n.high[k]!=null&&n.low[k]!=null&&d.push(n.high[k],n.low[k]);if(d.length===0)throw new Error("No valid price data found");const c=Math.min(...d),g=Math.max(...d),v=g-c,f=v/e;console.log(`üìä Price range: ${c.toFixed(2)} - ${g.toFixed(2)}, bin size: ${f.toFixed(4)}`);const m=new Array(e).fill(0).map((k,q)=>({priceLevel:c+(q+.5)*f,minPrice:c+q*f,maxPrice:c+(q+1)*f,volume:0,positiveVolume:0,negativeVolume:0,neutralVolume:0,mfiAverage:0,mfiCount:0,candleCount:0,mfiWeightedSum:0,mfiWeightedVolume:0,mfiAverageLegacy:0,mfiCountLegacy:0}));for(let k=0;k<i;k++){if(n.high[k]==null||n.low[k]==null||n.close[k]==null||n.volume[k]==null||n.volume[k]<=0)continue;const q=n.high[k],oe=n.low[k],ce=n.volume[k],ee=r.values[k],de=Math.max(0,Math.floor((oe-c)/f)),ue=Math.min(e-1,Math.floor((q-c)/f)),he=q-oe,fe=ue-de+1;for(let re=de;re<=ue;re++){const z=m[re],pe=z.minPrice,ve=z.maxPrice,ye=Math.max(oe,pe),we=Math.min(q,ve),Se=Math.max(0,we-ye);let Q;he>0?Q=ce*(Se/he):Q=ce/fe,z.volume+=Q,z.candleCount++,ee!=null&&!isNaN(ee)?(ee>=60?z.positiveVolume+=Q:ee<=40?z.negativeVolume+=Q:z.neutralVolume+=Q,z.mfiAverageLegacy=(z.mfiAverageLegacy*z.mfiCountLegacy+ee)/(z.mfiCountLegacy+1),z.mfiCountLegacy++,z.mfiWeightedSum+=ee*Q,z.mfiWeightedVolume+=Q,z.mfiCount++):z.neutralVolume+=Q}}m.forEach(k=>{s==="legacy"?k.mfiAverage=k.mfiAverageLegacy:k.mfiWeightedVolume>0?k.mfiAverage=k.mfiWeightedSum/k.mfiWeightedVolume:k.mfiAverage=0,k.mfiAverage=Math.max(0,Math.min(100,k.mfiAverage))});const T=m.reduce((k,q)=>k+q.volume,0),S=Math.max(...m.map(k=>k.volume));let D=0,b=0;for(let k=0;k<m.length;k++)m[k].volume>b&&(b=m[k].volume,D=k);const P=m[D],I=T*.7;let L=P.volume,y=D,O=D;for(;L<I&&(y>0||O<e-1);){const k=O<e-1?m[O+1].volume:0,q=y>0?m[y-1].volume:0;if(k>=q&&O<e-1)O++,L+=m[O].volume;else if(y>0)y--,L+=m[y].volume;else break}const C={buyingPressureLevels:m.filter(k=>k.positiveVolume>k.negativeVolume&&k.volume>T/e).map(k=>({priceLevel:k.priceLevel,volume:k.volume,mfiAverage:k.mfiAverage,buyingRatio:k.positiveVolume/k.volume})).sort((k,q)=>q.volume-k.volume).slice(0,5),sellingPressureLevels:m.filter(k=>k.negativeVolume>k.positiveVolume&&k.volume>T/e).map(k=>({priceLevel:k.priceLevel,volume:k.volume,mfiAverage:k.mfiAverage,sellingRatio:k.negativeVolume/k.volume})).sort((k,q)=>q.volume-k.volume).slice(0,5),totalBuyingVolume:m.reduce((k,q)=>k+q.positiveVolume,0),totalSellingVolume:m.reduce((k,q)=>k+q.negativeVolume,0),totalNeutralVolume:m.reduce((k,q)=>k+q.neutralVolume,0)},M=C.totalBuyingVolume/T,p=C.totalSellingVolume/T;let B="NEUTRAL";M>.4?B="BULLISH":p>.4&&(B="BEARISH");const j={volumeProfile:m,mfi:r,pointOfControl:{priceLevel:P.priceLevel,volume:P.volume,percentage:P.volume/T*100},valueArea:{low:m[y].priceLevel,high:m[O].priceLevel,volume:L,percentage:L/T*100},mfiInsights:C,marketSentiment:B,statistics:{totalVolume:T,maxVolumeInBin:S,priceRange:{min:c,max:g,range:v},bins:e,buyingRatio:M,sellingRatio:p,neutralRatio:C.totalNeutralVolume/T},metadata:{calculatedAt:new Date().toISOString(),dataPoints:i,mfiPeriod:a,mfiAvgMode:s,algorithm:`MFI Volume Profile v2.0 (${s} averaging)`}};return console.log("üìä MFI Volume Profile calculation complete:",{bins:e,totalVolume:T.toLocaleString(),poc:P.priceLevel.toFixed(2),marketSentiment:B,buyingRatio:(M*100).toFixed(1)+"%"}),j}catch(r){throw console.error("üìä MFI Volume Profile calculation failed:",r),r}}function al(n,e){if(!n||!e)return{signal:"NEUTRAL",confidence:0,recommendations:[],supportLevels:[],resistanceLevels:[]};const{volumeProfile:a,pointOfControl:o,valueArea:s,mfiInsights:i,marketSentiment:r}=n,d=a.filter(S=>S.priceLevel<e&&S.volume>n.statistics.totalVolume/30).sort((S,D)=>D.volume-S.volume).slice(0,3).map(S=>({price:S.priceLevel,strength:S.volume/n.statistics.maxVolumeInBin,type:S.positiveVolume>S.negativeVolume?"BUYING_SUPPORT":"SELLING_SUPPORT"})),c=a.filter(S=>S.priceLevel>e&&S.volume>n.statistics.totalVolume/30).sort((S,D)=>D.volume-S.volume).slice(0,3).map(S=>({price:S.priceLevel,strength:S.volume/n.statistics.maxVolumeInBin,type:S.negativeVolume>S.positiveVolume?"SELLING_RESISTANCE":"BUYING_RESISTANCE"}));let g="NEUTRAL",v=0;const f=[],m=(e-o.priceLevel)/o.priceLevel,T=e>=s.low&&e<=s.high;return r==="BULLISH"?e<s.low?(g="BUY",v=.7,f.push("Price below value area with bullish sentiment - potential buying opportunity")):T&&(g="HOLD",v=.5,f.push("Price in value area with bullish sentiment - monitor for breakout")):r==="BEARISH"&&(e>s.high?(g="SELL",v=.7,f.push("Price above value area with bearish sentiment - potential selling opportunity")):T&&(g="HOLD",v=.5,f.push("Price in value area with bearish sentiment - monitor for breakdown"))),(i.totalBuyingVolume>i.totalSellingVolume*1.5||i.totalSellingVolume>i.totalBuyingVolume*1.5)&&(v=Math.min(v+.2,1)),{signal:g,confidence:v,recommendations:f,supportLevels:d,resistanceLevels:c,marketContext:{pocDistance:m,inValueArea:T,marketSentiment:r,volumeBalance:i.totalBuyingVolume/i.totalSellingVolume}}}const nl={name:"MFIVolumeProfilePanel",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},priority:{type:Number,default:4},bins:{type:Number,default:50},mfiPeriod:{type:Number,default:14},lookback:{type:Number,default:200}},data(){return{loading:!1,error:null,profileData:null,tradingSignals:null,currentPrice:null,selectedRange:"3mo",binHeight:12,tooltip:{visible:!1,data:null,style:{}}}},computed:{isDev(){return new URLSearchParams(window.location.search).has("debug")},displayBins(){return!this.profileData||!this.profileData.volumeProfile?[]:[...this.profileData.volumeProfile].sort((n,e)=>e.priceLevel-n.priceLevel)},totalChartHeight(){const n=this.displayBins.length;return Math.max(n*this.binHeight,300)}},mounted(){this.loadData()},watch:{symbol(){this.loadData()}},methods:{async loadData(){var n;if(!this.loading){this.loading=!0,this.error=null,this.profileData=null,this.tradingSignals=null;try{console.log(`üìä Loading MFI Volume Profile for ${this.symbol}...`);const e=await Jr.getOhlcv(this.symbol,"1d",this.selectedRange);if(!e)throw new Error(`No OHLCV data available for ${this.symbol}`);console.log(`üìä OHLCV data loaded: ${((n=e.timestamps)==null?void 0:n.length)||0} points`),this.profileData=sl(e,this.bins,this.mfiPeriod),this.currentPrice=this.getCurrentPrice(e),this.currentPrice&&(this.tradingSignals=al(this.profileData,this.currentPrice)),console.log(`üìä MFI Volume Profile loaded successfully for ${this.symbol}`)}catch(e){console.error(`üìä MFI Volume Profile error for ${this.symbol}:`,e),this.error=this.getErrorMessage(e)}finally{this.loading=!1}}},getCurrentPrice(n){for(let e=n.close.length-1;e>=0;e--)if(n.close[e]!=null&&!isNaN(n.close[e]))return n.close[e];return null},getErrorMessage(n){return n.message.includes("CORS")?"Data source blocked by browser security. Try disabling ad blockers or privacy extensions.":n.message.includes("404")||n.message.includes("not found")?`No OHLCV data available for ${this.symbol}. This symbol may not be supported yet.`:n.message.includes("Insufficient")?"Insufficient historical data for MFI Volume Profile calculation.":`Failed to load data: ${n.message}`},onRangeChange(){console.log(`üìä Range changed to ${this.selectedRange} for ${this.symbol}`),this.loadData()},getBarClass(n){const e=["volume-bar"];return n.positiveVolume>n.negativeVolume?e.push("bullish"):n.negativeVolume>n.positiveVolume?e.push("bearish"):e.push("neutral"),this.profileData&&n.priceLevel===this.profileData.pointOfControl.priceLevel&&e.push("poc"),e.join(" ")},getBarStyle(n){return{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center"}},getBarFillStyle(n){if(!this.profileData)return{width:"0%"};const e=this.profileData.statistics.maxVolumeInBin,a=e>0?n.volume/e*100:0;let o="#9E9E9E";return n.positiveVolume>n.negativeVolume?o="#4CAF50":n.negativeVolume>n.positiveVolume&&(o="#F44336"),{width:`${Math.max(a,1)}%`,height:"80%",backgroundColor:o,borderRadius:"2px",transition:"all 0.2s ease"}},formatVolume(n){return n>=1e9?(n/1e9).toFixed(1)+"B":n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toFixed(0)},showTooltip(n,e){this.tooltip={visible:!0,data:e,style:{position:"fixed",left:n.clientX+10+"px",top:n.clientY-10+"px",zIndex:1e3}}},hideTooltip(){this.tooltip.visible=!1}}},il={class:"mfi-volume-profile-panel"},ol={key:0,class:"loading-state"},rl={key:1,class:"error-state"},ll={class:"error-message"},cl={class:"error-actions"},dl={key:0,class:"dev-info"},ul={key:2,class:"panel-content"},hl={class:"metrics-header"},gl={class:"metric-card"},ml={class:"metric-detail"},fl={class:"metric-card"},pl={class:"metric-detail"},vl={class:"metric-card"},yl={class:"metric-value"},wl={class:"metric-detail"},Sl={class:"volume-profile-chart"},bl={class:"chart-header"},_l={class:"chart-controls"},kl={class:"price-scale"},Cl={class:"volume-bars"},Tl=["onMouseover"],Dl={key:0,class:"poc-marker"},Al={key:1,class:"va-marker va-high"},Il={key:2,class:"va-marker va-low"},xl={class:"volume-scale"},Ml={key:0,class:"trading-signals"},Nl={class:"signals-header"},Ll={class:"signals-content"},Pl={class:"confidence-bar"},$l={class:"confidence-label"},Rl={class:"confidence-progress"},El={key:0,class:"recommendations"},Fl={key:3,class:"no-data-state"},Ol={key:0,class:"dev-fallback"},Ul={class:"tooltip-content"};function Vl(n,e,a,o,s,i){var r;return u(),h("div",il,[s.loading?(u(),h("div",ol,[...e[5]||(e[5]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading MFI Volume Profile...",-1)])])):s.error?(u(),h("div",rl,[e[7]||(e[7]=t("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),t("p",ll,l(s.error),1),t("div",cl,[t("button",{onClick:e[0]||(e[0]=(...d)=>i.loadData&&i.loadData(...d)),class:"retry-btn"},"Retry"),i.isDev?(u(),h("div",dl,[...e[6]||(e[6]=[t("small",null,"DEV mode: Trying Yahoo Finance fallback",-1)])])):_("",!0)])])):s.profileData?(u(),h("div",ul,[t("div",hl,[t("div",gl,[e[8]||(e[8]=t("div",{class:"metric-label"},"MFI Signal",-1)),t("div",{class:w(["metric-value",`signal-${s.profileData.mfi.signal.toLowerCase()}`])},l(s.profileData.mfi.signal),3),t("div",ml,l(((r=s.profileData.mfi.latest)==null?void 0:r.toFixed(2))||"N/A"),1)]),t("div",fl,[e[9]||(e[9]=t("div",{class:"metric-label"},"Market Sentiment",-1)),t("div",{class:w(["metric-value",`sentiment-${s.profileData.marketSentiment.toLowerCase()}`])},l(s.profileData.marketSentiment),3),t("div",pl," Buy: "+l((s.profileData.statistics.buyingRatio*100).toFixed(1))+"% ",1)]),t("div",vl,[e[10]||(e[10]=t("div",{class:"metric-label"},"Point of Control",-1)),t("div",yl,"$"+l(s.profileData.pointOfControl.priceLevel.toFixed(2)),1),t("div",wl,l(s.profileData.pointOfControl.percentage.toFixed(1))+"% volume",1)])]),t("div",Sl,[t("div",bl,[t("h4",null,"Volume Profile ("+l(a.bins)+" bins, MFI "+l(a.mfiPeriod)+")",1),t("div",_l,[H(t("select",{"onUpdate:modelValue":e[1]||(e[1]=d=>s.selectedRange=d),onChange:e[2]||(e[2]=(...d)=>i.onRangeChange&&i.onRangeChange(...d)),class:"range-selector"},[...e[11]||(e[11]=[t("option",{value:"3mo"},"3 Months",-1),t("option",{value:"6mo"},"6 Months",-1),t("option",{value:"1y"},"1 Year",-1)])],544),[[ht,s.selectedRange]])])]),t("div",{class:"chart-container",style:G({height:i.totalChartHeight+"px"})},[t("div",kl,[(u(!0),h(E,null,F(i.displayBins,(d,c)=>(u(),h("div",{key:c,class:"price-label",style:G({height:s.binHeight+"px"})}," $"+l(d.priceLevel.toFixed(2)),5))),128))]),t("div",Cl,[(u(!0),h(E,null,F(i.displayBins,(d,c)=>(u(),h("div",{key:c,class:"volume-bar-row",style:G({height:s.binHeight+"px"})},[t("div",{class:w(["volume-bar",i.getBarClass(d)]),style:G(i.getBarStyle(d)),onMouseover:g=>i.showTooltip(g,d),onMouseleave:e[3]||(e[3]=(...g)=>i.hideTooltip&&i.hideTooltip(...g))},[t("div",{class:"bar-fill",style:G(i.getBarFillStyle(d))},null,4)],46,Tl),d.priceLevel===s.profileData.pointOfControl.priceLevel?(u(),h("div",Dl," POC ")):_("",!0),d.priceLevel===s.profileData.valueArea.high?(u(),h("div",Al," VAH ")):_("",!0),d.priceLevel===s.profileData.valueArea.low?(u(),h("div",Il," VAL ")):_("",!0)],4))),128))]),t("div",xl,[(u(!0),h(E,null,F(i.displayBins,(d,c)=>(u(),h("div",{key:c,class:"volume-label",style:G({height:s.binHeight+"px"})},l(i.formatVolume(d.volume)),5))),128))])],4)]),s.tradingSignals?(u(),h("div",Ml,[t("div",Nl,[e[12]||(e[12]=t("h4",null,"Trading Analysis",-1)),t("div",{class:w(["signal-badge",`signal-${s.tradingSignals.signal.toLowerCase()}`])},l(s.tradingSignals.signal),3)]),t("div",Ll,[t("div",Pl,[t("div",$l,"Confidence: "+l((s.tradingSignals.confidence*100).toFixed(0))+"%",1),t("div",Rl,[t("div",{class:"confidence-fill",style:G({width:s.tradingSignals.confidence*100+"%"})},null,4)])]),s.tradingSignals.recommendations.length>0?(u(),h("div",El,[(u(!0),h(E,null,F(s.tradingSignals.recommendations,(d,c)=>(u(),h("div",{class:"recommendation",key:c},l(d),1))),128))])):_("",!0)])])):_("",!0)])):(u(),h("div",Fl,[e[13]||(e[13]=t("div",{class:"no-data-icon"},"üìä",-1)),t("p",null,"No MFI Volume Profile data available for "+l(a.symbol),1),i.isDev?(u(),h("div",Ol,[t("button",{onClick:e[4]||(e[4]=(...d)=>i.loadData&&i.loadData(...d)),class:"retry-btn"},"Try Yahoo Finance (DEV)")])):_("",!0)])),s.tooltip.visible?(u(),h("div",{key:4,class:"tooltip",style:G(s.tooltip.style)},[t("div",Ul,[t("div",null,[e[14]||(e[14]=t("strong",null,"Price Range:",-1)),A(" $"+l(s.tooltip.data.minPrice.toFixed(2))+" - $"+l(s.tooltip.data.maxPrice.toFixed(2)),1)]),t("div",null,[e[15]||(e[15]=t("strong",null,"Volume:",-1)),A(" "+l(i.formatVolume(s.tooltip.data.volume)),1)]),t("div",null,[e[16]||(e[16]=t("strong",null,"Avg MFI:",-1)),A(" "+l(s.tooltip.data.mfiAverage.toFixed(1)),1)]),t("div",null,[e[17]||(e[17]=t("strong",null,"Buying:",-1)),A(" "+l(i.formatVolume(s.tooltip.data.positiveVolume)),1)]),t("div",null,[e[18]||(e[18]=t("strong",null,"Selling:",-1)),A(" "+l(i.formatVolume(s.tooltip.data.negativeVolume)),1)])])],4)):_("",!0)])}const Wl=R(nl,[["render",Vl],["__scopeId","data-v-e13928cb"]]),Bl={name:"TradingViewCompanyProfile",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},colorTheme:{type:String,default:"light"},isTransparent:{type:Boolean,default:!0},locale:{type:String,default:"en"}},data(){return{loaded:!1,error:!1,widgetId:`company-profile-${Date.now()}`}},computed:{fullSymbol(){return`${this.exchange}:${this.symbol}`}},mounted(){this.loadCompanyProfile()},watch:{symbol(){this.loadCompanyProfile()},exchange(){this.loadCompanyProfile()}},methods:{async loadCompanyProfile(){this.loaded=!1,this.error=!1;try{await this.$nextTick(),this.createCompanyProfile()}catch(n){console.error("Failed to load company profile:",n),this.error=!0}},createCompanyProfile(){const n=this.$refs.container;if(!n)return;n.innerHTML="";const e=document.createElement("div");e.className="tradingview-widget-container",e.style.height="100%",e.style.width="100%";const a=document.createElement("div");a.className="tradingview-widget-container__widget",e.appendChild(a),n.appendChild(e);const o={symbol:this.fullSymbol,colorTheme:this.colorTheme,isTransparent:this.isTransparent,locale:this.locale,width:"100%",height:"100%"};console.log(`üè¢ Creating Company Profile widget for ${this.fullSymbol}`,o);const s=document.createElement("script");s.type="text/javascript",s.src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-profile.js",s.async=!0,s.innerHTML=JSON.stringify(o),s.onload=()=>{this.loaded=!0,console.log("TradingView Company Profile loaded successfully")},s.onerror=()=>{this.error=!0,console.error("TradingView Company Profile failed to load")},a.appendChild(s),setTimeout(()=>{!this.loaded&&!this.error&&(this.loaded=!0)},8e3)},async retry(){await this.loadCompanyProfile()}}},ql={class:"company-profile-container"},Hl=["id"],zl={key:0,class:"profile-loading"},jl={key:1,class:"profile-error"};function Gl(n,e,a,o,s,i){return u(),h("div",ql,[t("div",{class:"company-profile-widget",id:s.widgetId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",zl,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading company profile...",-1)])])):_("",!0),s.error?(u(),h("div",jl,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load company profile",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0)],8,Hl)])}const Ql=R(Bl,[["render",Gl],["__scopeId","data-v-0b7608e8"]]),Yl={name:"TradingViewFundamentalData",props:{symbol:{type:String,required:!0},exchange:{type:String,default:"NASDAQ"},colorTheme:{type:String,default:"dark"},displayMode:{type:String,default:"regular"},isTransparent:{type:Boolean,default:!0},locale:{type:String,default:"zh_TW"}},data(){return{loaded:!1,error:!1,widgetId:`fundamental-data-${Date.now()}`}},computed:{fullSymbol(){return`${this.exchange}:${this.symbol}`}},mounted(){this.loadFundamentalData()},watch:{symbol(){this.loadFundamentalData()},exchange(){this.loadFundamentalData()}},methods:{async loadFundamentalData(){this.loaded=!1,this.error=!1;try{await this.$nextTick(),this.createFundamentalData()}catch(n){console.error("Failed to load fundamental data:",n),this.error=!0}},createFundamentalData(){const n=this.$refs.container;if(!n)return;n.innerHTML="";const e=document.createElement("div");e.className="tradingview-widget-container",e.style.height="100%",e.style.width="100%";const a=document.createElement("div");a.className="tradingview-widget-container__widget",e.appendChild(a),n.appendChild(e);const o={symbol:this.fullSymbol,colorTheme:"light",displayMode:"regular",isTransparent:!0,locale:"zh_TW",width:"100%",height:"100%"},s=document.createElement("script");s.type="text/javascript",s.src="https://s3.tradingview.com/external-embedding/embed-widget-financials.js",s.async=!0,s.innerHTML=JSON.stringify(o),s.onload=()=>{this.loaded=!0,console.log("TradingView Fundamental Data loaded successfully")},s.onerror=()=>{this.error=!0,console.error("TradingView Fundamental Data failed to load")},a.appendChild(s),setTimeout(()=>{!this.loaded&&!this.error&&(this.loaded=!0)},8e3)},async retry(){await this.loadFundamentalData()}}},Xl={class:"fundamental-data-container"},Kl=["id"],Jl={key:0,class:"fundamental-loading"},Zl={key:1,class:"fundamental-error"};function ec(n,e,a,o,s,i){return u(),h("div",Xl,[t("div",{class:"fundamental-data-widget",id:s.widgetId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",Jl,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading fundamental data...",-1)])])):_("",!0),s.error?(u(),h("div",Zl,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load fundamental data",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0)],8,Kl)])}const tc=R(Yl,[["render",ec],["__scopeId","data-v-5cbca18c"]]),sc={name:"StockNews",props:{symbol:{type:String,required:!0},newsCount:{type:Number,default:9}},data(){return{loading:!0,error:null,news:[]}},mounted(){this.loadNews()},watch:{symbol(){this.loadNews()}},methods:{async loadNews(){this.loading=!0,this.error=null,this.news=[];try{console.log(`Loading news for ${this.symbol}...`);const n=await this.fetchYahooNews(this.symbol);n&&n.length>0?(this.news=n.slice(0,this.newsCount),console.log(`Loaded ${this.news.length} news articles for ${this.symbol}`)):this.news=[]}catch(n){console.error(`Failed to load news for ${this.symbol}:`,n),this.error=n.message}finally{this.loading=!1}},async fetchYahooNews(n){const e=["https://api.allorigins.win/raw?url=","https://corsproxy.io/?"];for(const a of e)try{const o=`https://query1.finance.yahoo.com/v1/finance/search?q=${n}&lang=en-US&region=US&quotesCount=1&newsCount=${this.newsCount}&enableFuzzyQuery=false&quotesQueryId=tss_match_phrase_query&multiQuoteQueryId=multi_quote_single_token_query&newsQueryId=news_cie_vespa&enableCb=true&enableNavLinks=true&enableEnhancedTrivialQuery=true`,s=`${a}${encodeURIComponent(o)}`;console.log(`Fetching news from: ${s}`);const i=await fetch(s);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const r=await i.json();if(r&&r.news&&r.news.length>0)return r.news}catch(o){console.warn("Proxy failed for news:",o.message);continue}throw new Error("All news proxies failed")},formatDate(n){if(!n)return"Unknown date";const e=new Date(n*1e3),a=new Date,o=a-e,s=Math.floor(o/(1e3*60*60)),i=Math.floor(s/24);return s<1?`${Math.floor(o/6e4)}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:e.getFullYear()!==a.getFullYear()?"numeric":void 0})},truncateText(n,e){return n?n.length<=e?n:n.substring(0,e).trim()+"...":""},openArticle(n){n&&window.open(n,"_blank","noopener,noreferrer")},handleImageError(n){n.target.style.display="none"}}},ac={class:"stock-news"},nc={key:0,class:"loading-state"},ic={key:1,class:"error-state"},oc={key:2,class:"no-news-state"},rc={key:3,class:"news-grid"},lc=["onClick"],cc={class:"news-header"},dc={class:"news-title"},uc={class:"news-date"},hc={class:"news-content"},gc={class:"news-text"},mc={class:"news-summary"},fc={class:"news-meta"},pc={class:"news-publisher"},vc={key:0,class:"news-type"},yc={key:0,class:"news-thumbnail"},wc=["src","alt"];function Sc(n,e,a,o,s,i){return u(),h("div",ac,[s.loading?(u(),h("div",nc,[e[1]||(e[1]=t("div",{class:"loading-spinner"},null,-1)),t("span",null,"Loading latest news for "+l(a.symbol)+"...",1)])):s.error?(u(),h("div",ic,[e[2]||(e[2]=t("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),t("span",null,l(s.error),1)])):s.news.length===0?(u(),h("div",oc,[e[3]||(e[3]=t("span",{class:"info-icon"},"‚ÑπÔ∏è",-1)),t("span",null,"No recent news available for "+l(a.symbol),1)])):(u(),h("div",rc,[(u(!0),h(E,null,F(s.news,(r,d)=>{var c;return u(),h("article",{key:d,class:"news-item",onClick:g=>i.openArticle(r.link)},[t("div",cc,[t("h4",dc,l(r.title),1),t("span",uc,l(i.formatDate(r.providerPublishTime)),1)]),t("div",hc,[t("div",gc,[t("p",mc,l(i.truncateText(r.summary,150)),1),t("div",fc,[t("span",pc,l(r.publisher),1),r.type?(u(),h("span",vc,l(r.type),1)):_("",!0)])]),r.thumbnail?(u(),h("div",yc,[t("img",{src:(c=r.thumbnail.resolutions[0])==null?void 0:c.url,alt:r.title,onError:e[0]||(e[0]=(...g)=>i.handleImageError&&i.handleImageError(...g))},null,40,wc)])):_("",!0)]),e[4]||(e[4]=t("div",{class:"news-footer"},[t("span",{class:"read-more"},"Read more ‚Üí")],-1))],8,lc)}),128))]))])}const bc=R(sc,[["render",Sc],["__scopeId","data-v-6db7a932"]]),_c={name:"StockDetailSkeleton"},kc={class:"stock-detail-skeleton"},Cc={class:"skeleton-widget-container"},Tc={class:"skeleton-technical-indicators"},Dc={class:"skeleton-widget-container"},Ac={class:"skeleton-performance-grid"},Ic={class:"skeleton-content-layout"},xc={class:"skeleton-news-row"},Mc={class:"skeleton-news-content"},Nc={class:"skeleton-fundamental-row"},Lc={class:"skeleton-fundamental-content"},Pc={class:"skeleton-fundamental-grid"},$c={class:"skeleton-profile-row"},Rc={class:"skeleton-profile-content"},Ec={class:"skeleton-profile-info"};function Fc(n,e,a,o,s,i){return u(),h("div",kc,[e[10]||(e[10]=se('<div class="skeleton-breadcrumb" data-v-a9db020d><div class="skeleton-breadcrumb-link" data-v-a9db020d></div><div class="skeleton-breadcrumb-separator" data-v-a9db020d>‚Ä∫</div><div class="skeleton-breadcrumb-current" data-v-a9db020d></div></div><div class="skeleton-stock-header" data-v-a9db020d><div class="skeleton-header-info" data-v-a9db020d><div class="skeleton-symbol-info" data-v-a9db020d><div class="skeleton-symbol" data-v-a9db020d></div><div class="skeleton-tags" data-v-a9db020d><div class="skeleton-tag" data-v-a9db020d></div><div class="skeleton-tag" data-v-a9db020d></div></div></div><div class="skeleton-header-actions" data-v-a9db020d><div class="skeleton-back-button" data-v-a9db020d></div></div></div><div class="skeleton-widgets-container" data-v-a9db020d><div class="skeleton-widget-overview" data-v-a9db020d><div class="skeleton-widget-header" data-v-a9db020d><div class="skeleton-title" data-v-a9db020d></div></div><div class="skeleton-overview-content" data-v-a9db020d></div></div><div class="skeleton-widget-technical" data-v-a9db020d><div class="skeleton-widget-header" data-v-a9db020d><div class="skeleton-title" data-v-a9db020d></div></div><div class="skeleton-technical-content" data-v-a9db020d></div></div></div></div><div class="skeleton-insight-widgets" data-v-a9db020d><div class="skeleton-insight-widget" data-v-a9db020d><div class="skeleton-widget-header" data-v-a9db020d><div class="skeleton-title" data-v-a9db020d></div></div><div class="skeleton-insight-content" data-v-a9db020d></div></div><div class="skeleton-insight-widget" data-v-a9db020d><div class="skeleton-widget-header" data-v-a9db020d><div class="skeleton-title" data-v-a9db020d></div></div><div class="skeleton-insight-content" data-v-a9db020d></div></div></div>',3)),t("div",Cc,[e[1]||(e[1]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Tc,[(u(),h(E,null,F(6,r=>t("div",{class:"skeleton-indicator-item",key:r},[...e[0]||(e[0]=[t("div",{class:"skeleton-indicator-name"},null,-1),t("div",{class:"skeleton-indicator-value"},null,-1),t("div",{class:"skeleton-indicator-signal"},null,-1)])])),64))])]),t("div",Dc,[e[3]||(e[3]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Ac,[(u(),h(E,null,F(4,r=>t("div",{class:"skeleton-performance-item",key:r},[...e[2]||(e[2]=[t("div",{class:"skeleton-performance-label"},null,-1),t("div",{class:"skeleton-performance-value"},null,-1)])])),64))])]),t("div",Ic,[t("div",xc,[e[5]||(e[5]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Mc,[(u(),h(E,null,F(5,r=>t("div",{class:"skeleton-news-item",key:r},[...e[4]||(e[4]=[t("div",{class:"skeleton-news-title"},null,-1),t("div",{class:"skeleton-news-summary"},null,-1),t("div",{class:"skeleton-news-time"},null,-1)])])),64))])]),t("div",Nc,[e[7]||(e[7]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Lc,[t("div",Pc,[(u(),h(E,null,F(8,r=>t("div",{class:"skeleton-fundamental-item",key:r},[...e[6]||(e[6]=[t("div",{class:"skeleton-fundamental-label"},null,-1),t("div",{class:"skeleton-fundamental-value"},null,-1)])])),64))])])]),t("div",$c,[e[9]||(e[9]=t("div",{class:"skeleton-widget-header"},[t("div",{class:"skeleton-title"})],-1)),t("div",Rc,[t("div",Ec,[(u(),h(E,null,F(6,r=>t("div",{class:"skeleton-profile-item",key:r},[...e[8]||(e[8]=[t("div",{class:"skeleton-profile-label"},null,-1),t("div",{class:"skeleton-profile-value"},null,-1)])])),64))])])])])])}const Oc=R(_c,[["render",Fc],["__scopeId","data-v-a9db020d"]]),Z=x().refine(n=>{try{const e=new Date(n);return!isNaN(e.getTime())&&n.includes("T")}catch{return!1}},{message:"Invalid datetime format"}),ys=De(["fresh","stale","very_stale"]),Uc=De(["open","closed","pre","post"]).nullable(),Vc=De(["latest","close","last_known"]),Wc=De(["llm","fallback"]),Bc=De(["good","stale","degraded","disabled_scrape"]),qc=Ls([lt(.5),lt(.75),lt(.9)]),Hc=De(["operational","degraded","maintenance","outage"]),zc=De(["success","failed","running","pending"]),jc=W({avg_cost_usd:N().positive().finite(),shares:N().positive().finite().optional()}),Gc=W({scraping_enabled:J(),degradation_enabled:J(),ga_enabled:J(),clarity_enabled:J()}),Qc=W({timestamp:Z,success:J(),error:x().optional(),changes_applied:N().nonnegative(),dry_run:J()}),Yc=W({last_import_result:Qc.optional()}),ws=vt(()=>od),Ss=vt(()=>ed),bs=vt(()=>dd),Xc=W({last_daily_snapshot:ws.optional(),last_quotes_snapshot:Ss.optional(),last_metadata:bs.optional()}),Kc=W({schema_version:x(),watchlist:K(x().max(10).regex(/^[A-Z0-9.-]+$/)),holdings:Me(x(),jc),settings:Gc,cache:Xc,diagnostics:Yc}),Jc=W({symbol:x().max(10).regex(/^[A-Z0-9.-]+$/),price_usd:N().nullable(),price_type:Vc,market_state:Uc,is_delayed:J(),stale_level:ys,error:x().nullable(),change_percent:N().optional(),volume:N().nonnegative().optional()}),Zc=W({total_symbols:N().nonnegative(),successful_updates:N().nonnegative(),failed_updates:N().nonnegative(),average_delay_minutes:N().nonnegative().optional(),next_update:Z.optional()}),ed=W({as_of:Z,provider:x(),market_session:x().optional(),items:K(Jc),metadata:Zc.optional()}),td=W({title:x().min(1),url:x().url(),published_at:Z,source:x().min(1),summary:x().optional()}),sd=W({symbol:x().max(10).regex(/^[A-Z0-9.-]+$/),short_brief_zh:x(),brief_truncated:J(),brief_source:Wc,news_top10:K(td),news_insufficient:J(),gaps:K(x())}),ad=W({id:x().min(1),value:N().nullable(),as_of:Z,source_name:x().min(1),quality_flag:Bc}),nd=W({items:K(ad).length(10,"Must have exactly 10 markets indicators")}),id=W({total_processing_time_ms:N().nonnegative(),news_sources_attempted:N().nonnegative(),news_sources_successful:N().nonnegative(),total_articles_collected:N().nonnegative(),articles_after_deduplication:N().nonnegative(),llm_brief_generation_success_rate:N().min(0).max(1),macro_indicators_updated:N().nonnegative(),macro_indicators_failed:N().nonnegative()}),od=W({as_of_date_taipei:x().regex(/^\d{4}-\d{2}-\d{2}$/),generated_at_utc:Z,universe:K(x()).length(10,"Universe must have exactly 10 symbols"),per_symbol:K(sd).length(10,"Must have data for exactly 10 symbols"),macro:nd,generation_metadata:id.optional()}),rd=W({symbol:x().max(10).regex(/^[A-Z0-9.-]+$/),sector:x().nullable(),industry:x().nullable(),confidence:qc,sources:K(x()).min(1),last_verified_at:Z,market_cap_category:x().optional(),exchange:x().optional()}),ld=W({high_confidence_0_90:N().nonnegative(),medium_confidence_0_75:N().nonnegative(),low_confidence_0_50:N().nonnegative()}),cd=W({last_refresh_duration_ms:N().nonnegative(),symbols_updated:N().nonnegative(),symbols_failed:N().nonnegative(),confidence_improvements:N().nonnegative(),new_sources_added:N().nonnegative()}),dd=W({ttl_days:N().positive(),as_of:Z,next_refresh:Z.optional(),items:K(rd).length(10,"Must have metadata for exactly 10 symbols"),industry_grouping:Me(x(),K(x())).optional(),confidence_distribution:ld.optional(),data_sources:Me(x(),N().nonnegative()).optional(),refresh_metadata:cd.optional()}),ud=W({last_run:Z,next_run:Z,status:zc,duration_ms:N().nonnegative(),symbols_updated:N().nonnegative().optional(),symbols_processed:N().nonnegative().optional(),errors:K(x()),provider:x().optional()}),hd=W({age_minutes:N().nonnegative().optional(),age_hours:N().nonnegative().optional(),age_days:N().nonnegative().optional(),staleness:ys}),gd=W({used_minutes:N().nonnegative(),total_minutes:N().nonnegative(),reset_date:x()}),md=W({data_files_mb:N().nonnegative(),total_repo_mb:N().nonnegative()}),fd=W({calls_today:N().nonnegative(),daily_limit:N().nonnegative(),reset_time:Z}),pd=W({github_actions_quota:gd.optional(),storage_usage:md.optional(),api_limits:Me(x(),fd).optional()}),vd=W({enabled:J(),active_fallbacks:K(x()),cache_hits_last_hour:N().nonnegative()}),yd=W({description:x(),last_updated:Z,system_status:Hc,jobs:Me(x(),ud),data_freshness:Me(x(),hd),system_health:pd,degradation_status:vd}),wd=W({max_length:N().positive(),allowed_chars:x(),case_sensitive:J()});W({description:x(),version:x(),last_updated:x(),symbols:K(x().max(10).regex(/^[A-Z0-9.-]+$/)).length(10,"Universe must have exactly 10 symbols"),validation:wd});const Sd=W({id:x().min(1),name:x().min(1),description:x().min(1),scrape_only:J(),data_source:x().min(1),update_frequency:x().min(1),unit:x().min(1)}),bd=W({default_enabled:J(),timeout_seconds:N().positive(),retry_attempts:N().nonnegative(),user_agent:x().min(1)});W({description:x(),version:x(),last_updated:x(),indicators:K(Sd).length(10,"Must have exactly 10 markets indicators"),scraping_settings:bd});function Ze(n,e){try{return{success:!0,data:n.parse(e)}}catch(a){return a instanceof Ps?{success:!1,error:{message:"Validation failed",details:a.errors}}:{success:!1,error:{message:"Unknown validation error",details:{error:String(a)}}}}}function nt(n){return Ze(Kc,n)}function _d(n){return Ze(Ss,n)}function kd(n){return Ze(ws,n)}function Cd(n){return Ze(bs,n)}function Td(n){return Ze(yd,n)}function Dd(n){const e=["schema_version","watchlist","holdings","settings","cache","diagnostics"];if(typeof n!="object"||n===null)return{success:!1,error:{message:"Import data must be a valid JSON object",code:"INVALID_FORMAT"}};const o=Object.keys(n).filter(s=>!e.includes(s));return o.length>0?{success:!1,error:{message:`Unknown keys found: ${o.join(", ")}`,code:"UNKNOWN_KEYS",details:{unknownKeys:o}}}:nt(n)}const U=class U{static loadState(){try{const e=localStorage.getItem(U.STORAGE_KEY);if(!e)return{...U.DEFAULT_STATE};const a=JSON.parse(e),o=U.migrateState(a),s=nt(o);return s.success&&s.data?s.data:(console.warn("Invalid state in localStorage, using defaults:",s.error),{...U.DEFAULT_STATE})}catch(e){return console.error("Failed to load state from localStorage:",e),{...U.DEFAULT_STATE}}}static saveState(e){const a=nt(e);if(!a.success)return a;try{return localStorage.setItem(U.STORAGE_KEY,JSON.stringify(e)),{success:!0,data:e}}catch(o){return{success:!1,error:{message:"Failed to save state to localStorage",details:{error:String(o)}}}}}static clearState(){localStorage.removeItem(U.STORAGE_KEY)}static exportState(){const e=U.loadState();return JSON.stringify(e,null,2)}static importState(e,a=!1){try{const o=JSON.parse(e),s=Dd(o);if(!s.success)return s;const i=U.migrateState(s.data),r=nt(i);if(!r.success)return r;if(!a){const d=U.saveState(r.data);if(!d.success)return d}return{success:!0,data:r.data}}catch(o){return{success:!1,error:{message:"Invalid JSON format",details:{error:String(o)}}}}}static updateWatchlist(e){const o={...U.loadState(),watchlist:e};return U.saveState(o)}static addToWatchlist(e){const a=U.loadState();if(a.watchlist.includes(e.toUpperCase()))return{success:!1,error:{message:"Symbol already in watchlist",code:"DUPLICATE_SYMBOL"}};const o=[...a.watchlist,e.toUpperCase()];return U.updateWatchlist(o)}static removeFromWatchlist(e){const o=U.loadState().watchlist.filter(s=>s!==e.toUpperCase());return U.updateWatchlist(o)}static updateHolding(e,a,o){const s=U.loadState(),i={...s,holdings:{...s.holdings,[e.toUpperCase()]:{avg_cost_usd:a,...o!==void 0&&{shares:o}}}};return U.saveState(i)}static removeHolding(e){const a=U.loadState(),o={...a.holdings};delete o[e.toUpperCase()];const s={...a,holdings:o};return U.saveState(s)}static updateSettings(e){const a=U.loadState(),o={...a,settings:{...a.settings,...e}};return U.saveState(o)}static updateCache(e){const a=U.loadState(),o={...a,cache:{...a.cache,...e}};return U.saveState(o)}static recordImportResult(e){const a=U.loadState(),o={...a,diagnostics:{...a.diagnostics,last_import_result:e}};return U.saveState(o)}static migrateState(e){var o,s,i,r;return e.schema_version||(e.schema_version="1.0.0"),{schema_version:U.CURRENT_SCHEMA_VERSION,watchlist:e.watchlist||[],holdings:e.holdings||{},settings:{scraping_enabled:((o=e.settings)==null?void 0:o.scraping_enabled)??!1,degradation_enabled:((s=e.settings)==null?void 0:s.degradation_enabled)??!0,ga_enabled:((i=e.settings)==null?void 0:i.ga_enabled)??!1,clarity_enabled:((r=e.settings)==null?void 0:r.clarity_enabled)??!1},cache:e.cache||{},diagnostics:e.diagnostics||{}}}static getCurrentSchemaVersion(){return U.CURRENT_SCHEMA_VERSION}static isStorageAvailable(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}};Ae(U,"STORAGE_KEY","investment-dashboard-state"),Ae(U,"CURRENT_SCHEMA_VERSION","1.0.0"),Ae(U,"DEFAULT_STATE",{schema_version:U.CURRENT_SCHEMA_VERSION,watchlist:[],holdings:{},settings:{scraping_enabled:!1,degradation_enabled:!0,ga_enabled:!1,clarity_enabled:!1},cache:{},diagnostics:{}});let ae=U;class Ad{constructor(e="",a=!0){Ae(this,"baseUrl");Ae(this,"cacheBustingEnabled");this.baseUrl=e,this.cacheBustingEnabled=a}async fetchSystemStatus(){var e;try{const a=await fetch(`${this.baseUrl}/data/status.json`);if(!a.ok)throw new Error(`HTTP ${a.status}`);const o=await a.json(),s=Td(o);if(!s.success)throw new Error(`Invalid status.json: ${(e=s.error)==null?void 0:e.message}`);return{data:s.data,source:"network",stale_level:"fresh",as_of:s.data.last_updated}}catch(a){return console.warn("Failed to fetch system status:",a),ae.loadState().cache.last_daily_snapshot?{data:null,source:"fallback",stale_level:"very_stale",error:String(a)}:{data:null,source:"fallback",stale_level:"very_stale",error:String(a)}}}async fetchQuotesSnapshot(){var e,a;try{const o=await this.fetchSystemStatus();let s="";this.cacheBustingEnabled&&((e=o.data)!=null&&e.last_updated)&&(s=`?t=${new Date(o.data.last_updated).getTime()}`);const i=await fetch(`${this.baseUrl}/data/quotes/latest.json${s}`);if(!i.ok)throw new Error(`HTTP ${i.status}`);const r=await i.json(),d=_d(r);if(!d.success)throw new Error(`Invalid quotes snapshot: ${(a=d.error)==null?void 0:a.message}`);const c=ae.loadState();return ae.updateCache({last_quotes_snapshot:d.data}),{data:d.data,source:"network",stale_level:this.calculateStaleness(d.data.as_of),as_of:d.data.as_of}}catch(o){console.warn("Failed to fetch quotes snapshot:",o);const s=ae.loadState();return s.cache.last_quotes_snapshot?{data:s.cache.last_quotes_snapshot,source:"cache",stale_level:this.calculateStaleness(s.cache.last_quotes_snapshot.as_of),as_of:s.cache.last_quotes_snapshot.as_of,error:String(o)}:{data:null,source:"fallback",stale_level:"very_stale",error:String(o)}}}async fetchDailySnapshot(e){var a,o;try{const s=e||this.getTaipeiDateString(),i=await this.fetchSystemStatus();let r="";this.cacheBustingEnabled&&((a=i.data)!=null&&a.last_updated)&&(r=`?t=${new Date(i.data.last_updated).getTime()}`);const d=await fetch(`${this.baseUrl}/data/daily/${s}.json${r}`);if(!d.ok)throw new Error(`HTTP ${d.status}`);const c=await d.json(),g=kd(c);if(!g.success)throw new Error(`Invalid daily snapshot: ${(o=g.error)==null?void 0:o.message}`);return ae.updateCache({last_daily_snapshot:g.data}),{data:g.data,source:"network",stale_level:this.calculateStaleness(g.data.generated_at_utc),as_of:g.data.generated_at_utc}}catch(s){console.warn("Failed to fetch daily snapshot:",s);const i=ae.loadState();return i.cache.last_daily_snapshot?{data:i.cache.last_daily_snapshot,source:"cache",stale_level:this.calculateStaleness(i.cache.last_daily_snapshot.generated_at_utc),as_of:i.cache.last_daily_snapshot.generated_at_utc,error:String(s)}:{data:null,source:"fallback",stale_level:"very_stale",error:String(s)}}}async fetchMetadataSnapshot(){var e,a;try{const o=await this.fetchSystemStatus();let s="";this.cacheBustingEnabled&&((e=o.data)!=null&&e.last_updated)&&(s=`?t=${new Date(o.data.last_updated).getTime()}`);const i=await fetch(`${this.baseUrl}/data/symbols_metadata.json${s}`);if(!i.ok)throw new Error(`HTTP ${i.status}`);const r=await i.json(),d=Cd(r);if(!d.success)throw new Error(`Invalid metadata snapshot: ${(a=d.error)==null?void 0:a.message}`);return ae.updateCache({last_metadata:d.data}),{data:d.data,source:"network",stale_level:this.calculateStaleness(d.data.as_of),as_of:d.data.as_of}}catch(o){console.warn("Failed to fetch metadata snapshot:",o);const s=ae.loadState();return s.cache.last_metadata?{data:s.cache.last_metadata,source:"cache",stale_level:this.calculateStaleness(s.cache.last_metadata.as_of),as_of:s.cache.last_metadata.as_of,error:String(o)}:{data:null,source:"fallback",stale_level:"very_stale",error:String(o)}}}calculateStaleness(e){try{const a=new Date(e),s=(new Date().getTime()-a.getTime())/(1e3*60);return s<=60?"fresh":s<=24*60?"stale":"very_stale"}catch{return"very_stale"}}getTaipeiDateString(){const e=new Date;return new Date(e.getTime()+8*60*60*1e3).toISOString().split("T")[0]}}const Id=()=>{if(typeof window<"u"){const n=window.location.hostname,e=window.location.pathname;if(n==="romarin-hsieh.github.io"&&e.startsWith("/investment-dashboard"))return"/investment-dashboard"}return""},xd=new Ad(Id());class Md{constructor(){this.cache=new Map,this.cacheExpiry=24*60*60*1e3,this.batchSize=5,this.requestDelay=1e3}async getSymbolMetadata(e){try{if(this.cache.has(e)){const o=this.cache.get(e);if(Date.now()-o.timestamp<this.cacheExpiry)return console.log(`Using cached metadata for ${e}`),o.data}console.log(`Fetching fresh metadata for ${e} from Yahoo Finance API...`);const a=await ie.getStockInfo(e);if(a&&!a.error&&a.sector!=="Unknown"){const o={symbol:e,sector:a.sector||"Unknown",industry:a.industry||"Unknown Industry",exchange:a.exchange||this.getDefaultExchange(e),marketCap:a.marketCap,marketCapFormatted:a.marketCapFormatted,marketCapCategory:a.marketCapCategory||"unknown",currency:a.currency||"USD",country:a.country||"Unknown",website:a.website,employees:a.employees,businessSummary:a.businessSummary,confidence:a.confidence||.95,source:"Yahoo Finance API (Live)",lastUpdated:a.lastUpdated||new Date().toISOString(),isLive:!0};return this.cache.set(e,{data:o,timestamp:Date.now()}),console.log(`Successfully fetched metadata for ${e}:`,{sector:o.sector,industry:o.industry,confidence:o.confidence}),o}else return console.warn(`Yahoo Finance API failed for ${e}, using static fallback data`),this.getStaticFallbackMetadata(e)}catch(a){return console.error(`Error fetching metadata for ${e}:`,a),this.getStaticFallbackMetadata(e)}}getStaticFallbackMetadata(e){const o={ASTS:{sector:"Communication Services",industry:"Satellite Communications",confidence:.75},RIVN:{sector:"Consumer Cyclical",industry:"Electric Vehicles",confidence:.9},PL:{sector:"Technology",industry:"Satellite Imaging & Analytics",confidence:.9},ONDS:{sector:"Technology",industry:"Industrial IoT Solutions",confidence:.75},RDW:{sector:"Industrials",industry:"Space Infrastructure",confidence:.75},AVAV:{sector:"Industrials",industry:"Aerospace & Defense",confidence:.75},MDB:{sector:"Technology",industry:"Database Software",confidence:.9},ORCL:{sector:"Technology",industry:"Enterprise Software",confidence:.9},TSM:{sector:"Technology",industry:"Semiconductors",confidence:.9},RKLB:{sector:"Industrials",industry:"Aerospace & Defense",confidence:.9},CRM:{sector:"Technology",industry:"Enterprise Software",confidence:.9},NVDA:{sector:"Technology",industry:"Semiconductors",confidence:.9},AVGO:{sector:"Technology",industry:"Semiconductors",confidence:.9},AMZN:{sector:"Consumer Cyclical",industry:"Internet Retail",confidence:.9},GOOG:{sector:"Communication Services",industry:"Internet Content & Information",confidence:.9},META:{sector:"Communication Services",industry:"Internet Content & Information",confidence:.9},NFLX:{sector:"Communication Services",industry:"Entertainment",confidence:.9},LEU:{sector:"Energy",industry:"Uranium",confidence:.75},SMR:{sector:"Energy",industry:"Nuclear Energy",confidence:.75},CRWV:{sector:"Technology",industry:"Software - Application",confidence:.75},IONQ:{sector:"Technology",industry:"Quantum Computing",confidence:.75},PLTR:{sector:"Technology",industry:"Software - Infrastructure",confidence:.9},HIMS:{sector:"Healthcare",industry:"Health Information Services",confidence:.75},TSLA:{sector:"Consumer Cyclical",industry:"Auto Manufacturers",confidence:.9}}[e]||{sector:"Unknown",industry:"Unknown Industry",confidence:0},s={symbol:e,sector:o.sector,industry:o.industry,exchange:this.getDefaultExchange(e),marketCap:null,marketCapFormatted:"N/A",marketCapCategory:"unknown",currency:"USD",country:"Unknown",website:null,employees:null,businessSummary:null,confidence:o.confidence,source:"Static Fallback Data",lastUpdated:new Date().toISOString(),isLive:!1};return this.cache.set(e,{data:s,timestamp:Date.now()}),console.log(`Using static fallback for ${e}:`,{sector:s.sector,industry:s.industry,confidence:s.confidence}),s}async getBatchMetadata(e){const a=new Map,o=this.createBatches(e,this.batchSize);console.log(`Fetching metadata for ${e.length} symbols in ${o.length} batches...`);for(let s=0;s<o.length;s++){const i=o[s];console.log(`Processing batch ${s+1}/${o.length} (${i.length} symbols)`);const r=i.map(c=>this.getSymbolMetadata(c).catch(g=>(console.error(`Failed to fetch metadata for ${c}:`,g),this.getDefaultMetadata(c)))),d=await Promise.all(r);i.forEach((c,g)=>{a.set(c,d[g])}),s<o.length-1&&(console.log(`Waiting ${this.requestDelay}ms before next batch...`),await this.delay(this.requestDelay))}return console.log(`Completed fetching metadata for ${a.size} symbols`),a}getDefaultMetadata(e){return{symbol:e,sector:"Unknown",industry:"Unknown Industry",exchange:this.getDefaultExchange(e),marketCap:null,marketCapFormatted:"N/A",marketCapCategory:"unknown",currency:"USD",country:"Unknown",website:null,employees:null,businessSummary:null,confidence:0,source:"Default (API Failed)",lastUpdated:new Date().toISOString(),isLive:!1}}getDefaultExchange(e){const a=["AAPL","MSFT","GOOGL","GOOG","AMZN","TSLA","NVDA","META","NFLX","RKLB","ASTS","RIVN","MDB","ONDS","PL","AVAV","CRM","AVGO","LEU","SMR","CRWV","IONQ","PLTR","HIMS"],o=["TSM","ORCL","RDW"];return a.includes(e)?"NASDAQ":o.includes(e)?"NYSE":"NASDAQ"}getIndustryDisplay(e){return!e||e.confidence<.7?"Unknown Industry":e.industry||e.sector||"Unknown Industry"}getIndustryCategory(e){const a=this.getIndustryDisplay(e);return{"Software - Application":"tech-software","Software - Infrastructure":"tech-software","Database Software":"tech-software","Enterprise Software":"tech-software","Internet Content & Information":"tech-internet",Semiconductors:"tech-hardware","Quantum Computing":"tech-quantum","Aerospace & Defense":"industrial-aerospace","Space Infrastructure":"industrial-space","Industrial IoT Solutions":"tech-iot","Satellite Communications":"communications","Satellite Imaging & Analytics":"tech-satellite","Auto Manufacturers":"automotive","Electric Vehicles":"automotive","Internet Retail":"retail",Entertainment:"entertainment",Uranium:"energy-nuclear","Nuclear Energy":"energy-nuclear","Health Information Services":"healthcare","Unknown Industry":"unknown"}[a]||"other"}generateSectorGrouping(e){const a={};for(const[o,s]of e){const i=s.sector||"Unknown";a[i]||(a[i]=[]),a[i].push(o)}return a}generateConfidenceDistribution(e){const a={high_confidence_0_90:0,medium_confidence_0_75:0,low_confidence_0_50:0,unknown_confidence:0};for(const[o,s]of e){const i=s.confidence||0;i>=.9?a.high_confidence_0_90++:i>=.75?a.medium_confidence_0_75++:i>=.5?a.low_confidence_0_50++:a.unknown_confidence++}return a}createBatches(e,a){const o=[];for(let s=0;s<e.length;s+=a)o.push(e.slice(s,s+a));return o}delay(e){return new Promise(a=>setTimeout(a,e))}clearCache(){this.cache.clear(),console.log("Dynamic metadata cache cleared")}getCacheStats(){const e={totalCached:this.cache.size,cacheEntries:{}};for(const[a,o]of this.cache.entries())e.cacheEntries[a]={age:Date.now()-o.timestamp,expired:Date.now()-o.timestamp>this.cacheExpiry,sector:o.data.sector,industry:o.data.industry,confidence:o.data.confidence};return e}async warmupCache(e){console.log(`Warming up metadata cache for ${e.length} symbols...`);const a=Date.now(),o=await this.getBatchMetadata(e),s=Date.now()-a;return console.log(`Cache warmup completed in ${s}ms for ${o.size} symbols`),{duration:s,symbolsProcessed:o.size,successRate:(o.size/e.length*100).toFixed(1)+"%"}}}const be=new Md;class Nd{constructor(){this.cache=new Map,this.cacheExpiry=24*60*60*1e3,this.lastFetch=null,this.metadata=null,this.useDynamicAPI=!0}setUseDynamicAPI(e){this.useDynamicAPI=e,console.log(`Metadata service mode: ${e?"Dynamic API":"Static File"}`)}async getSymbolMetadata(e){return this.useDynamicAPI?await be.getSymbolMetadata(e):await this.getStaticSymbolMetadata(e)}async getStaticSymbolMetadata(e){if(this.cache.has(e)){const o=this.cache.get(e);if(Date.now()-o.timestamp<this.cacheExpiry)return o.data}if(await this.refreshMetadata(),this.metadata&&this.metadata.items){const o=this.metadata.items.find(s=>s.symbol===e);if(o)return console.log(`‚úÖ Found static metadata for ${e}:`,o),this.cache.set(e,{data:o,timestamp:Date.now()}),o}console.warn(`‚ùå No metadata found for ${e}, using default`);const a={symbol:e,sector:"Unknown",industry:"Unknown Industry",exchange:this.getDefaultExchange(e),confidence:0,source:"Static File (Default)",isLive:!1};return this.cache.set(e,{data:a,timestamp:Date.now()}),a}async getBatchMetadata(e){if(this.useDynamicAPI)return await be.getBatchMetadata(e);{console.log(`üîÑ getBatchMetadata (static mode) for ${e.length} symbols:`,e);const a=new Map;await this.refreshMetadata();for(const o of e){const s=await this.getStaticSymbolMetadata(o);a.set(o,s),["CRM","IONQ"].includes(o)&&console.log(`üéØ getBatchMetadata result for ${o}:`,s)}return console.log(`‚úÖ getBatchMetadata completed, ${a.size} results`),a}}getMetadataUrl(){return ot.symbolsMetadata()}async refreshMetadata(){var e;try{console.log("üîÑ Refreshing metadata from dataFetcher...");let a;try{a=await xd.fetchMetadataSnapshot()}catch(o){console.warn("‚ùå dataFetcher failed, trying direct fetch:",o);const s=this.getMetadataUrl();console.log("üîç MetadataService fetching from:",s);const i=await fetch(s);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);a={data:await i.json()}}if(a.data){if(this.metadata=a.data,this.lastFetch=Date.now(),console.log(`‚úÖ Metadata refreshed successfully, ${((e=this.metadata.items)==null?void 0:e.length)||0} items loaded`),this.metadata.items){const o=this.metadata.items.find(s=>s.symbol==="CRM");o?console.log("‚úÖ CRM found in refreshed metadata:",o):(console.warn("‚ùå CRM not found in refreshed metadata"),console.log("Available symbols:",this.metadata.items.map(s=>s.symbol).slice(0,10)))}}else console.warn("‚ùå No data returned from fetchMetadataSnapshot")}catch(a){console.warn("‚ùå Failed to refresh metadata:",a)}}getDefaultExchange(e){const a=["AAPL","MSFT","GOOGL","GOOG","AMZN","TSLA","NVDA","META","NFLX","RKLB","ASTS","RIVN","MDB","ONDS","PL","AVAV","CRM","AVGO","LEU","SMR","CRWV","IONQ","PLTR","HIMS"],o=["TSM","ORCL","RDW"];return a.includes(e)?"NASDAQ":o.includes(e)?"NYSE":"NASDAQ"}getIndustryDisplay(e){return this.useDynamicAPI?be.getIndustryDisplay(e):!e||e.confidence<.7?"Unknown Industry":e.industry||e.sector||"Unknown Industry"}getIndustryCategory(e){if(this.useDynamicAPI)return be.getIndustryCategory(e);const a=this.getIndustryDisplay(e);return{"Industrial IoT Solutions":"tech-iot","Satellite Imaging & Analytics":"tech-satellite","Database Software":"tech-software","Enterprise Software":"tech-software",Semiconductors:"tech-hardware","Aerospace & Defense":"industrial-aerospace","Space Infrastructure":"industrial-space","Satellite Communications":"communications","Electric Vehicles":"automotive","Unknown Industry":"unknown"}[a]||"other"}async warmupCache(e){if(this.useDynamicAPI)return await be.warmupCache(e);{console.log(`Warming up static metadata cache for ${e.length} symbols...`);const a=Date.now();await this.refreshMetadata();for(const s of e)await this.getStaticSymbolMetadata(s);const o=Date.now()-a;return console.log(`Static cache warmup completed in ${o}ms`),{duration:o,symbolsProcessed:e.length,mode:"static"}}}clearCache(){this.cache.clear(),this.metadata=null,this.lastFetch=null,this.useDynamicAPI&&be.clearCache()}getCacheStats(){return this.useDynamicAPI?{mode:"dynamic",...be.getCacheStats()}:{mode:"static",totalCached:this.cache.size,lastFetch:this.lastFetch,metadataLoaded:!!this.metadata}}getCurrentMode(){return this.useDynamicAPI?"dynamic":"static"}}const ke=new Nd;class Ld{constructor(){this.cache=null,this.loading=!1}async loadMetadata(){var e;if(this.cache)return this.cache;if(this.loading){for(;this.loading;)await new Promise(a=>setTimeout(a,100));return this.cache}this.loading=!0;try{const a=ot.symbolsMetadata();console.log("üîç DirectMetadataLoader fetching from:",a);const o=await fetch(a);if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const s=await o.json();return this.cache=s,console.log("‚úÖ DirectMetadataLoader loaded successfully:",(e=s.items)==null?void 0:e.length,"items"),this.cache}catch(a){return console.error("‚ùå DirectMetadataLoader failed:",a),null}finally{this.loading=!1}}async getSymbolMetadata(e){const a=await this.loadMetadata();if(!a||!a.items)return{symbol:e,sector:"Unknown",industry:"Unknown Industry",exchange:"NASDAQ",confidence:0,source:"DirectLoader (Failed)"};const o=a.items.find(s=>s.symbol===e);return o?{...o,source:"DirectLoader (Success)"}:{symbol:e,sector:"Unknown",industry:"Unknown Industry",exchange:"NASDAQ",confidence:0,source:"DirectLoader (Not Found)"}}async getBatchMetadata(e){const a=new Map;for(const o of e){const s=await this.getSymbolMetadata(o);a.set(o,s)}return a}}const Pd=new Ld,$d={name:"StockDetail",components:{FastTradingViewWidget:ms,LazyTradingViewWidget:wt,MarketRegimeWidget:Vr,TradingStrategyWidget:Xr,MFIVolumeProfilePanel:Wl,TradingViewCompanyProfile:Ql,TradingViewFundamentalData:tc,TechnicalIndicators:fs,PerformanceMonitor:ps,StockNews:bc,StockDetailSkeleton:Oc},data(){return{loading:!0,error:null,metadata:null}},computed:{symbol(){return this.$route.params.symbol||"RKLB"},exchange(){if(this.metadata&&this.metadata.exchange)return{NYQ:"NYSE",NMS:"NASDAQ",NCM:"NASDAQ",NGM:"NASDAQ",ASE:"AMEX",NYSE:"NYSE",NASDAQ:"NASDAQ"}[this.metadata.exchange]||this.metadata.exchange;const n=this.symbol;return["ORCL","TSM","RDW","CRM","PL","LEU","SMR","IONQ","HIMS"].includes(n)?"NYSE":(["ASTS","RIVN","ONDS","AVAV","MDB","RKLB","NVDA","AVGO","AMZN","GOOG","META","NFLX","CRWV","PLTR","TSLA"].includes(n),"NASDAQ")},dailyInsightConfig(){return{lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[[`${this.exchange}:${this.symbol}|6M`]],dateRanges:["6m|1D"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"5",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1}},weeklyInsightConfig(){return{lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"rgb(106, 109, 120)",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:"light",isTransparent:!0,locale:"en",chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[[`${this.exchange}:${this.symbol}|6M`]],dateRanges:["6m|1W"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"4",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1}}},watch:{symbol(){this.scrollToTop(),this.loadMetadata()},$route(){this.scrollToTop()}},mounted(){this.scrollToTop(),ke.setUseDynamicAPI(!0),this.loadMetadata(),this.initializePage()},methods:{async initializePage(){try{this.loading=!1}catch(n){this.error=String(n),this.loading=!1}},async refresh(){this.loading=!0,this.error=null,await this.initializePage()},async loadMetadata(){try{this.metadata=await Pd.getSymbolMetadata(this.symbol),console.log(`üìä StockDetail loaded metadata for ${this.symbol}:`,this.metadata)}catch(n){console.warn(`Failed to load metadata for ${this.symbol}:`,n),this.metadata=null}},getSector(){return!this.metadata||this.metadata.confidence<.7?"Unknown":this.metadata.sector||"Unknown"},getIndustry(){return!this.metadata||this.metadata.confidence<.7?"Unknown Industry":this.metadata.industry||this.metadata.sector||"Unknown Industry"},getIndustryCategory(){const n=this.getIndustry();return{"Software - Application":"tech-software","Computer Hardware":"tech-hardware","Communication Equipment":"tech-satellite","Database Software":"tech-software","Enterprise Software":"tech-software",Semiconductors:"tech-hardware","Aerospace & Defense":"industrial-aerospace","Space Infrastructure":"industrial-space","Satellite Communications":"communications","Auto Manufacturers":"automotive","Unknown Industry":"unknown"}[n]||"other"},goBack(){console.log("Navigating back to stock overview"),this.$router.push({name:"stock-overview"}).catch(n=>{console.error("Navigation error:",n)})},scrollToTop(){this.$nextTick(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),setTimeout(()=>{window.scrollTo(0,0)},100)})}}},Rd={class:"stock-detail"},Ed={class:"breadcrumb"},Fd={class:"breadcrumb-current"},Od={key:0,class:"loading-with-skeleton"},Ud={key:1,class:"error"},Vd={class:"text-danger"},Wd={key:2},Bd={class:"stock-header"},qd={class:"stock-info-header"},Hd={class:"symbol-info"},zd={class:"symbol"},jd={class:"symbol-tags"},Gd={class:"exchange-tag"},Qd={class:"header-actions"},Yd={class:"widgets-container"},Xd={class:"widget-overview"},Kd={class:"widget-technical"},Jd={class:"symbol-insight-block"},Zd={class:"insight-full-widget market-regime"},eu={class:"insight-full-widget trading-strategy"},tu={class:"insight-full-widget mfi-volume-profile"},su={class:"insight-widgets-container"},au={class:"insight-widget daily-insight"},nu={class:"insight-widget weekly-insight"},iu={class:"widget-container"},ou={class:"content-layout"},ru={class:"widget-container"},lu={class:"widget-container"},cu={class:"widget-container"};function du(n,e,a,o,s,i){const r=V("router-link"),d=V("StockDetailSkeleton"),c=V("FastTradingViewWidget"),g=V("MarketRegimeWidget"),v=V("TradingStrategyWidget"),f=V("MFIVolumeProfilePanel"),m=V("LazyTradingViewWidget"),T=V("TechnicalIndicators"),S=V("PerformanceMonitor"),D=V("StockNews"),b=V("TradingViewFundamentalData"),P=V("TradingViewCompanyProfile");return u(),h("div",Rd,[t("nav",Ed,[$(r,{to:"/stock-overview",class:"breadcrumb-link"},{default:xe(()=>[...e[2]||(e[2]=[A("Stock Overview",-1)])]),_:1}),e[3]||(e[3]=t("span",{class:"breadcrumb-separator"},"‚Ä∫",-1)),t("span",Fd,l(i.symbol)+" Analysis",1)]),s.loading?(u(),h("div",Od,[$(d)])):s.error?(u(),h("div",Ud,[t("p",Vd,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...I)=>i.refresh&&i.refresh(...I)),class:"btn btn-secondary"},"Retry")])):(u(),h("div",Wd,[t("div",Bd,[t("div",qd,[t("div",Hd,[t("h3",zd,l(i.symbol),1),t("div",jd,[t("span",Gd,l(i.exchange),1),t("span",{class:w(["industry-tag",`industry-${i.getIndustryCategory()}`])},l(i.getIndustry()),3)])]),t("div",Qd,[t("button",{onClick:e[1]||(e[1]=(...I)=>i.goBack&&i.goBack(...I)),class:"detail-btn"},[...e[4]||(e[4]=[t("span",{class:"btn-icon"},"‚Üê",-1),A(" Back to Stock Overview ",-1)])])])]),t("div",Yd,[t("div",Xd,[e[5]||(e[5]=t("div",{class:"widget-header"},[t("h4",null,"Symbol Overview")],-1)),$(c,{"widget-type":"overview",symbol:i.symbol,exchange:i.exchange},null,8,["symbol","exchange"])]),t("div",Kd,[e[6]||(e[6]=t("div",{class:"widget-header"},[t("h4",null,"Technical Analysis")],-1)),$(c,{"widget-type":"technical",symbol:i.symbol,exchange:i.exchange,class:"technical-overview-style"},null,8,["symbol","exchange"])])])]),t("div",Jd,[e[12]||(e[12]=t("div",{class:"insight-header"},[t("h3",null,"Symbol Insight")],-1)),t("div",Zd,[e[7]||(e[7]=t("div",{class:"widget-header"},[t("h4",null,"Market Regime")],-1)),$(g,{symbol:i.symbol,exchange:i.exchange,priority:2},null,8,["symbol","exchange"])]),t("div",eu,[e[8]||(e[8]=t("div",{class:"widget-header"},[t("h4",null,"Trading Strategy")],-1)),$(v,{symbol:i.symbol,exchange:i.exchange,priority:3},null,8,["symbol","exchange"])]),t("div",tu,[e[9]||(e[9]=t("div",{class:"widget-header"},[t("h4",null,"MFI Volume Profile")],-1)),$(f,{symbol:i.symbol,exchange:i.exchange,priority:4},null,8,["symbol","exchange"])]),t("div",su,[t("div",au,[e[10]||(e[10]=t("div",{class:"widget-header"},[t("h4",null,"Daily Insight (MA5)")],-1)),$(m,{"widget-type":"Daily Insight",config:i.dailyInsightConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",height:"550px",priority:5},null,8,["config"])]),t("div",nu,[e[11]||(e[11]=t("div",{class:"widget-header"},[t("h4",null,"Weekly Insight (MA4)")],-1)),$(m,{"widget-type":"Weekly Insight",config:i.weeklyInsightConfig,"script-url":"https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",height:"550px",priority:6},null,8,["config"])])])]),t("div",iu,[e[13]||(e[13]=t("div",{class:"widget-header"},[t("h3",null,"Technical Indicators")],-1)),$(T,{symbol:i.symbol,exchange:i.exchange},null,8,["symbol","exchange"])]),$(S),t("div",ou,[t("div",ru,[e[14]||(e[14]=t("div",{class:"widget-header"},[t("h3",null,"Latest News")],-1)),$(D,{symbol:i.symbol},null,8,["symbol"])]),t("div",lu,[e[15]||(e[15]=t("div",{class:"widget-header"},[t("h3",null,"Fundamental Data")],-1)),$(b,{symbol:i.symbol,exchange:i.exchange},null,8,["symbol","exchange"])]),t("div",cu,[e[16]||(e[16]=t("div",{class:"widget-header"},[t("h3",null,"Company Profile")],-1)),$(P,{symbol:i.symbol,exchange:i.exchange,"color-theme":"light","is-transparent":!0},null,8,["symbol","exchange"])])])]))])}const uu=R($d,[["render",du],["__scopeId","data-v-2226ee90"]]),hu={name:"TradingViewTopStories",props:{displayMode:{type:String,default:"regular"},feedMode:{type:String,default:"market"},colorTheme:{type:String,default:"light"},isTransparent:{type:Boolean,default:!0},locale:{type:String,default:"en"},market:{type:String,default:"stock"},height:{type:String,default:"600px"}},data(){return{loaded:!1,error:!1,widgetId:`top-stories-${Date.now()}`}},mounted(){this.loadTopStories()},methods:{async loadTopStories(){this.loaded=!1,this.error=!1;try{await this.$nextTick(),this.createTopStories()}catch(n){console.error("Failed to load top stories:",n),this.error=!0}},createTopStories(){const n=this.$refs.container;if(!n)return;n.innerHTML="";const e=document.createElement("div");e.className="tradingview-widget-container",e.style.height="100%",e.style.width="100%";const a=document.createElement("div");a.className="tradingview-widget-container__widget",e.appendChild(a),n.appendChild(e);const o={displayMode:this.displayMode,feedMode:this.feedMode,colorTheme:this.colorTheme,isTransparent:this.isTransparent,locale:this.locale,market:this.market,width:"100%",height:"100%"},s=document.createElement("script");s.type="text/javascript",s.src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js",s.async=!0,s.innerHTML=JSON.stringify(o),s.onload=()=>{this.loaded=!0,console.log("TradingView Top Stories loaded successfully")},s.onerror=()=>{this.error=!0,console.error("TradingView Top Stories failed to load")},a.appendChild(s),setTimeout(()=>{!this.loaded&&!this.error&&(this.loaded=!0)},8e3)},async retry(){await this.loadTopStories()}}},gu={class:"top-stories-container"},mu=["id"],fu={key:0,class:"stories-loading"},pu={key:1,class:"stories-error"};function vu(n,e,a,o,s,i){return u(),h("div",gu,[e[3]||(e[3]=t("div",{class:"widget-header"},[t("h3",null,"Top Stories")],-1)),t("div",{class:"top-stories-widget",id:s.widgetId,ref:"container"},[!s.loaded&&!s.error?(u(),h("div",fu,[...e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading market news...",-1)])])):_("",!0),s.error?(u(),h("div",pu,[e[2]||(e[2]=t("span",null,"‚ö†Ô∏è Failed to load market news",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retry&&i.retry(...r)),class:"retry-btn"},"Retry")])):_("",!0)],8,mu)])}const yu=R(hu,[["render",vu],["__scopeId","data-v-7abef6c6"]]),wu={name:"TopStoriesSkeleton"},Su={class:"top-stories-skeleton"},bu={class:"skeleton-widget-container"},_u={class:"skeleton-stories-area"},ku={class:"skeleton-story-tags"},Cu={class:"skeleton-config-info"},Tu={class:"skeleton-config-list"};function Du(n,e,a,o,s,i){return u(),h("div",Su,[e[5]||(e[5]=t("div",{class:"skeleton-page-header"},[t("div",{class:"skeleton-page-title"}),t("div",{class:"skeleton-page-description"})],-1)),t("div",bu,[t("div",_u,[(u(),h(E,null,F(10,r=>t("div",{class:"skeleton-story-item",key:r},[e[0]||(e[0]=t("div",{class:"skeleton-story-time"},null,-1)),e[1]||(e[1]=t("div",{class:"skeleton-story-title"},null,-1)),e[2]||(e[2]=t("div",{class:"skeleton-story-content"},null,-1)),t("div",ku,[(u(),h(E,null,F(3,d=>t("div",{class:"skeleton-story-tag",key:d})),64))])])),64))])]),t("div",Cu,[e[4]||(e[4]=t("div",{class:"skeleton-config-title"},null,-1)),t("div",Tu,[(u(),h(E,null,F(5,r=>t("div",{class:"skeleton-config-item",key:r},[...e[3]||(e[3]=[t("div",{class:"skeleton-config-label"},null,-1),t("div",{class:"skeleton-config-value"},null,-1)])])),64))])])])}const Au=R(wu,[["render",Du],["__scopeId","data-v-4a248288"]]),Iu={name:"TopStoriesTest",components:{TradingViewTopStories:yu,TopStoriesSkeleton:Au},data(){return{loading:!0,error:null}},mounted(){this.initializePage()},methods:{async initializePage(){try{await new Promise(n=>setTimeout(n,800)),this.loading=!1}catch(n){this.error=String(n),this.loading=!1}},async refresh(){this.loading=!0,this.error=null,await this.initializePage()}}},xu={class:"top-stories-test"},Mu={key:0,class:"loading-with-skeleton"},Nu={key:1,class:"error"},Lu={class:"text-danger"},Pu={key:2};function $u(n,e,a,o,s,i){const r=V("TopStoriesSkeleton"),d=V("TradingViewTopStories");return u(),h("div",xu,[e[2]||(e[2]=t("h2",null,"Top Stories Widget Test",-1)),e[3]||(e[3]=t("p",{class:"text-muted mb-3"},"Testing TradingView Top Stories component",-1)),s.loading?(u(),h("div",Mu,[$(r)])):s.error?(u(),h("div",Nu,[t("p",Lu,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...c)=>i.refresh&&i.refresh(...c)),class:"btn btn-secondary"},"Retry")])):(u(),h("div",Pu,[$(d,{"display-mode":"regular","feed-mode":"market","color-theme":"light","is-transparent":!0,locale:"en",market:"stock",height:"650px"}),e[1]||(e[1]=se('<div class="config-info" data-v-e9d9d092><h3 data-v-e9d9d092>Widget Configuration</h3><ul data-v-e9d9d092><li data-v-e9d9d092><strong data-v-e9d9d092>Display Mode:</strong> regular</li><li data-v-e9d9d092><strong data-v-e9d9d092>Feed Mode:</strong> market</li><li data-v-e9d9d092><strong data-v-e9d9d092>Color Theme:</strong> light</li><li data-v-e9d9d092><strong data-v-e9d9d092>Market:</strong> stock</li><li data-v-e9d9d092><strong data-v-e9d9d092>Height:</strong> 650px</li></ul></div>',1))]))])}const Ru=R(Iu,[["render",$u],["__scopeId","data-v-e9d9d092"]]),Eu={name:"StockMarketInsight",props:{colorTheme:{type:String,default:"light"},isTransparent:{type:Boolean,default:!0},locale:{type:String,default:"en"},height:{type:String,default:"1300px"}},data(){return{dailyLoaded:!1,dailyError:!1,weeklyLoaded:!1,weeklyError:!1,dailyWidgetId:`daily-market-${Date.now()}`,weeklyWidgetId:`weekly-market-${Date.now()}`}},mounted(){this.loadWidgets()},methods:{async loadWidgets(){await this.$nextTick(),this.createDailyWidget(),this.createWeeklyWidget()},createDailyWidget(){const n=this.$refs.dailyContainer;if(!n)return;n.innerHTML="";const e=document.createElement("div");e.className="tradingview-widget-container",e.style.height="100%",e.style.width="100%";const a=document.createElement("div");a.className="tradingview-widget-container__widget",e.appendChild(a),n.appendChild(e);const o={lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"#707070",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:this.colorTheme,isTransparent:this.isTransparent,locale:this.locale,chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[["IG:NASDAQ|6M"],["THINKMARKETS:US30|6M"]],dateRanges:["6m|1D"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"5",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1},s=document.createElement("script");s.type="text/javascript",s.src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",s.async=!0,s.innerHTML=JSON.stringify(o),s.onload=()=>{this.dailyLoaded=!0,console.log("Daily Market Widget loaded successfully")},s.onerror=()=>{this.dailyError=!0,console.error("Daily Market Widget failed to load")},a.appendChild(s),setTimeout(()=>{!this.dailyLoaded&&!this.dailyError&&(this.dailyLoaded=!0)},8e3)},createWeeklyWidget(){const n=this.$refs.weeklyContainer;if(!n)return;n.innerHTML="";const e=document.createElement("div");e.className="tradingview-widget-container",e.style.height="100%",e.style.width="100%";const a=document.createElement("div");a.className="tradingview-widget-container__widget",e.appendChild(a),n.appendChild(e);const o={lineWidth:2,lineType:0,chartType:"candlesticks",showVolume:!0,fontColor:"#707070",gridLineColor:"rgba(46, 46, 46, 0.06)",volumeUpColor:"rgba(34, 171, 148, 0.5)",volumeDownColor:"rgba(247, 82, 95, 0.5)",backgroundColor:"#ffffff",widgetFontColor:"#0F0F0F",upColor:"#22ab94",downColor:"#f7525f",borderUpColor:"#22ab94",borderDownColor:"#f7525f",wickUpColor:"#22ab94",wickDownColor:"#f7525f",colorTheme:this.colorTheme,isTransparent:this.isTransparent,locale:this.locale,chartOnly:!1,scalePosition:"right",scaleMode:"Normal",fontFamily:"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",valuesTracking:"1",changeMode:"price-and-percent",symbols:[["IG:NASDAQ|6M"],["THINKMARKETS:US30|6M"]],dateRanges:["6m|1W"],fontSize:"10",headerFontSize:"medium",autosize:!0,width:"100%",height:"100%",noTimeScale:!1,hideDateRanges:!1,showMA:!0,maLength:"5",maLineColor:"#2962FF",maLineWidth:1,hideMarketStatus:!1,hideSymbolLogo:!1},s=document.createElement("script");s.type="text/javascript",s.src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js",s.async=!0,s.innerHTML=JSON.stringify(o),s.onload=()=>{this.weeklyLoaded=!0,console.log("Weekly Market Widget loaded successfully")},s.onerror=()=>{this.weeklyError=!0,console.error("Weekly Market Widget failed to load")},a.appendChild(s),setTimeout(()=>{!this.weeklyLoaded&&!this.weeklyError&&(this.weeklyLoaded=!0)},8e3)},async retryDaily(){this.dailyLoaded=!1,this.dailyError=!1,await this.$nextTick(),this.createDailyWidget()},async retryWeekly(){this.weeklyLoaded=!1,this.weeklyError=!1,await this.$nextTick(),this.createWeeklyWidget()}}},Fu={class:"stock-market-insight-container"},Ou={class:"insight-grid"},Uu={class:"insight-section"},Vu=["id"],Wu={key:0,class:"widget-loading"},Bu={key:1,class:"widget-error"},qu={class:"insight-section"},Hu=["id"],zu={key:0,class:"widget-loading"},ju={key:1,class:"widget-error"};function Gu(n,e,a,o,s,i){return u(),h("div",Fu,[e[8]||(e[8]=t("div",{class:"widget-header"},[t("h3",null,"Stock Market Insight")],-1)),t("div",Ou,[t("div",Uu,[e[4]||(e[4]=t("div",{class:"section-header"},[t("h4",null,"Stock Market Daily")],-1)),t("div",{class:"daily-widget",id:s.dailyWidgetId,ref:"dailyContainer"},[!s.dailyLoaded&&!s.dailyError?(u(),h("div",Wu,[...e[2]||(e[2]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading daily market data...",-1)])])):_("",!0),s.dailyError?(u(),h("div",Bu,[e[3]||(e[3]=t("span",null,"‚ö†Ô∏è Failed to load daily data",-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>i.retryDaily&&i.retryDaily(...r)),class:"retry-btn"},"Retry")])):_("",!0)],8,Vu)]),t("div",qu,[e[7]||(e[7]=t("div",{class:"section-header"},[t("h4",null,"Stock Market Weekly")],-1)),t("div",{class:"weekly-widget",id:s.weeklyWidgetId,ref:"weeklyContainer"},[!s.weeklyLoaded&&!s.weeklyError?(u(),h("div",zu,[...e[5]||(e[5]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Loading weekly market data...",-1)])])):_("",!0),s.weeklyError?(u(),h("div",ju,[e[6]||(e[6]=t("span",null,"‚ö†Ô∏è Failed to load weekly data",-1)),t("button",{onClick:e[1]||(e[1]=(...r)=>i.retryWeekly&&i.retryWeekly(...r)),class:"retry-btn"},"Retry")])):_("",!0)],8,Hu)])])])}const Qu=R(Eu,[["render",Gu],["__scopeId","data-v-e5c812bc"]]),Yu={name:"StockMarketInsightSkeleton"},Xu={class:"stock-market-insight-skeleton"},Ku={class:"skeleton-config-info"},Ju={class:"skeleton-config-grid"},Zu={class:"skeleton-config-section"},eh={class:"skeleton-config-list"},th={class:"skeleton-config-section"},sh={class:"skeleton-config-list"};function ah(n,e,a,o,s,i){return u(),h("div",Xu,[e[5]||(e[5]=se('<div class="skeleton-page-header" data-v-bcaf64ab><div class="skeleton-page-title" data-v-bcaf64ab></div><div class="skeleton-page-description" data-v-bcaf64ab></div></div><div class="skeleton-widget-container large" data-v-bcaf64ab><div class="skeleton-insight-grid" data-v-bcaf64ab><div class="skeleton-insight-section" data-v-bcaf64ab><div class="skeleton-section-header" data-v-bcaf64ab><div class="skeleton-section-title" data-v-bcaf64ab></div></div><div class="skeleton-chart-area" data-v-bcaf64ab><div class="skeleton-chart" data-v-bcaf64ab></div></div></div><div class="skeleton-insight-section" data-v-bcaf64ab><div class="skeleton-section-header" data-v-bcaf64ab><div class="skeleton-section-title" data-v-bcaf64ab></div></div><div class="skeleton-chart-area" data-v-bcaf64ab><div class="skeleton-chart" data-v-bcaf64ab></div></div></div></div></div>',2)),t("div",Ku,[e[4]||(e[4]=t("div",{class:"skeleton-config-title"},null,-1)),t("div",Ju,[t("div",Zu,[e[1]||(e[1]=t("div",{class:"skeleton-config-section-title"},null,-1)),t("div",eh,[(u(),h(E,null,F(5,r=>t("div",{class:"skeleton-config-item",key:r},[...e[0]||(e[0]=[t("div",{class:"skeleton-config-label"},null,-1),t("div",{class:"skeleton-config-value"},null,-1)])])),64))])]),t("div",th,[e[3]||(e[3]=t("div",{class:"skeleton-config-section-title"},null,-1)),t("div",sh,[(u(),h(E,null,F(5,r=>t("div",{class:"skeleton-config-item",key:r},[...e[2]||(e[2]=[t("div",{class:"skeleton-config-label"},null,-1),t("div",{class:"skeleton-config-value"},null,-1)])])),64))])])])])])}const nh=R(Yu,[["render",ah],["__scopeId","data-v-bcaf64ab"]]),ih={name:"StockMarketInsightTest",components:{StockMarketInsight:Qu,StockMarketInsightSkeleton:nh},data(){return{loading:!0,error:null}},mounted(){this.initializePage()},methods:{async initializePage(){try{await new Promise(n=>setTimeout(n,1e3)),this.loading=!1}catch(n){this.error=String(n),this.loading=!1}},async refresh(){this.loading=!0,this.error=null,await this.initializePage()}}},oh={class:"stock-market-insight-test"},rh={key:0,class:"loading-with-skeleton"},lh={key:1,class:"error"},ch={class:"text-danger"},dh={key:2};function uh(n,e,a,o,s,i){const r=V("StockMarketInsightSkeleton"),d=V("StockMarketInsight");return u(),h("div",oh,[e[2]||(e[2]=t("h2",null,"Stock Market Insight Test",-1)),e[3]||(e[3]=t("p",{class:"text-muted mb-3"},"Testing Stock Market Insight component with Daily and Weekly views",-1)),s.loading?(u(),h("div",rh,[$(r)])):s.error?(u(),h("div",lh,[t("p",ch,l(s.error),1),t("button",{onClick:e[0]||(e[0]=(...c)=>i.refresh&&i.refresh(...c)),class:"btn btn-secondary"},"Retry")])):(u(),h("div",dh,[$(d,{"color-theme":"light","is-transparent":!0,locale:"en",height:"1300px"}),e[1]||(e[1]=se('<div class="config-info" data-v-d131536f><h3 data-v-d131536f>Widget Configuration</h3><div class="config-grid" data-v-d131536f><div class="config-section" data-v-d131536f><h4 data-v-d131536f>Daily Configuration</h4><ul data-v-d131536f><li data-v-d131536f><strong data-v-d131536f>Symbols:</strong> NASDAQ, US30</li><li data-v-d131536f><strong data-v-d131536f>Date Range:</strong> 6 months, 1 Day intervals</li><li data-v-d131536f><strong data-v-d131536f>Chart Type:</strong> Candlesticks</li><li data-v-d131536f><strong data-v-d131536f>Moving Average:</strong> 5-period</li><li data-v-d131536f><strong data-v-d131536f>Volume:</strong> Enabled</li></ul></div><div class="config-section" data-v-d131536f><h4 data-v-d131536f>Weekly Configuration</h4><ul data-v-d131536f><li data-v-d131536f><strong data-v-d131536f>Symbols:</strong> NASDAQ, US30</li><li data-v-d131536f><strong data-v-d131536f>Date Range:</strong> 6 months, 1 Week intervals</li><li data-v-d131536f><strong data-v-d131536f>Chart Type:</strong> Candlesticks</li><li data-v-d131536f><strong data-v-d131536f>Moving Average:</strong> 5-period</li><li data-v-d131536f><strong data-v-d131536f>Volume:</strong> Enabled</li></ul></div></div></div>',1))]))])}const hh=R(ih,[["render",uh],["__scopeId","data-v-d131536f"]]),gh={name:"YahooFinanceTest",data(){return{testSymbol:"AAPL",loading:!1,error:null,testData:null,cacheStatus:null,presetSymbols:["AAPL","TSLA","MSFT","GOOGL","ONDS","RDW"]}},methods:{async loadTestData(){if(this.testSymbol){this.loading=!0,this.error=null,this.testData=null;try{console.log(`Testing Yahoo Finance API for ${this.testSymbol}...`),this.testData=await ie.getTechnicalIndicators(this.testSymbol),this.testData.error&&(this.error=this.testData.error)}catch(n){this.error=n.message,console.error("Test failed:",n)}finally{this.loading=!1}}},getSignalClass(n){if(!n)return"neutral";const e=["BUY","OVERSOLD","STRONG_TREND"],a=["SELL","OVERBOUGHT"];return e.includes(n)?"bullish":a.includes(n)?"bearish":"neutral"},formatDate(n){return n?new Date(n).toLocaleString("zh-TW"):"N/A"},async loadCacheStatus(){this.cacheStatus=ie.getCacheStats()},clearCache(){ie.clearCache(),ie.clearDailyCache(),this.cacheStatus=null,alert("ÊâÄÊúâÁ∑©Â≠òÂ∑≤Ê∏ÖÈô§ (API Á∑©Â≠ò + ÊØèÊó•Á∑©Â≠ò)")}},mounted(){this.loadTestData()}},mh={class:"yahoo-finance-test"},fh={class:"test-controls"},ph={class:"symbol-input"},vh=["disabled"],yh={class:"preset-symbols"},wh=["onClick","disabled"],Sh={key:0,class:"loading-section"},bh={key:1,class:"error-section"},_h={key:2,class:"results-section"},kh={class:"indicators-grid"},Ch={class:"indicator-section"},Th={class:"ma-grid"},Dh={class:"indicator-card compact"},Ah={class:"indicator-details"},Ih={class:"indicator-card compact"},xh={class:"indicator-details"},Mh={class:"indicator-card compact"},Nh={class:"indicator-details"},Lh={class:"indicator-card compact"},Ph={class:"indicator-details"},$h={class:"additional-info"},Rh={class:"indicator-section"},Eh={class:"ichimoku-grid"},Fh={class:"indicator-card compact"},Oh={class:"indicator-details"},Uh={class:"additional-info"},Vh={class:"indicator-card compact"},Wh={class:"indicator-details"},Bh={class:"additional-info"},qh={class:"indicator-card compact"},Hh={class:"indicator-details"},zh={class:"additional-info"},jh={class:"indicator-section"},Gh={class:"vwma-grid"},Qh={class:"indicator-card"},Yh={class:"indicator-details"},Xh={class:"additional-info"},Kh={class:"indicator-section"},Jh={class:"technical-grid"},Zh={class:"indicator-card"},eg={class:"indicator-details"},tg={key:0,class:"rsi-bar"},sg={class:"indicator-card"},ag={class:"indicator-details"},ng={class:"additional-info"},ig={class:"indicator-card"},og={class:"indicator-details"},rg={class:"additional-info"},lg={class:"metadata"},cg={key:0},dg={key:1},ug={key:2,class:"error-text"},hg={class:"cache-section"},gg={key:0,class:"cache-info"};function mg(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D,b,P,I,L,y,O,C,M,p,B,j,k,q,oe,ce,ee,de,ue,he,fe,re,z,pe,ve,ye,we,Se,Q,Ne,Le,Pe,$e,Re,Ee,Fe,Oe,Ue,Ve,We,Be,qe,He,ze,je,Ge,Qe,Ye,Xe,Ke;return u(),h("div",mh,[e[32]||(e[32]=t("div",{class:"test-header"},[t("h2",null,"Yahoo Finance API Ê∏¨Ë©¶"),t("p",null,"Ê∏¨Ë©¶ Yahoo Finance API ÁöÑÊäÄË°ìÊåáÊ®ôÊï∏ÊìöÁç≤ÂèñÂäüËÉΩ")],-1)),t("div",fh,[t("div",ph,[e[5]||(e[5]=t("label",{for:"symbol"},"ËÇ°Á•®‰ª£Ëôü:",-1)),H(t("input",{id:"symbol","onUpdate:modelValue":e[0]||(e[0]=te=>s.testSymbol=te),type:"text",placeholder:"‰æãÂ¶Ç: AAPL, TSLA, ONDS",onKeyup:e[1]||(e[1]=Je(te=>s.testSymbol&&i.loadTestData(),["enter"]))},null,544),[[me,s.testSymbol]]),t("button",{onClick:e[2]||(e[2]=te=>i.loadTestData()),disabled:!s.testSymbol||s.loading,class:"test-btn"},l(s.loading?"ËºâÂÖ•‰∏≠...":"Ê∏¨Ë©¶"),9,vh)]),t("div",yh,[e[6]||(e[6]=t("span",null,"Âø´ÈÄüÊ∏¨Ë©¶:",-1)),(u(!0),h(E,null,F(s.presetSymbols,te=>(u(),h("button",{key:te,onClick:rt=>{s.testSymbol=te,i.loadTestData()},disabled:s.loading,class:"preset-btn"},l(te),9,wh))),128))])]),s.loading?(u(),h("div",Sh,[e[7]||(e[7]=t("div",{class:"loading-spinner"},null,-1)),t("p",null,"Ê≠£Âú®Âæû Yahoo Finance Áç≤Âèñ "+l(s.testSymbol)+" ÁöÑÊäÄË°ìÊåáÊ®ôÊï∏Êìö...",1)])):_("",!0),s.error?(u(),h("div",bh,[e[8]||(e[8]=t("h3",null,"‚ùå ÈåØË™§",-1)),t("p",null,l(s.error),1)])):_("",!0),s.testData&&!s.loading?(u(),h("div",_h,[t("h3",null,"‚úÖ "+l(s.testSymbol)+" ÊäÄË°ìÊåáÊ®ôÁµêÊûú",1),t("div",kh,[t("div",Ch,[e[13]||(e[13]=t("h3",null,"ÁßªÂãïÂπ≥ÂùáÁ∑ö (Moving Averages)",-1)),t("div",Th,[t("div",Dh,[e[9]||(e[9]=t("h4",null,"MA5 / SMA5",-1)),t("div",Ah,[t("div",{class:w(["main-value",i.getSignalClass((r=s.testData.ma5)==null?void 0:r.signal)])},l(((d=s.testData.ma5)==null?void 0:d.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((c=s.testData.ma5)==null?void 0:c.signal)])},l(((g=s.testData.ma5)==null?void 0:g.signal)||"N/A"),3)])]),t("div",Ih,[e[10]||(e[10]=t("h4",null,"MA10 / SMA10",-1)),t("div",xh,[t("div",{class:w(["main-value",i.getSignalClass((v=s.testData.ma10)==null?void 0:v.signal)])},l(((f=s.testData.ma10)==null?void 0:f.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((m=s.testData.ma10)==null?void 0:m.signal)])},l(((T=s.testData.ma10)==null?void 0:T.signal)||"N/A"),3)])]),t("div",Mh,[e[11]||(e[11]=t("h4",null,"MA30 / SMA30",-1)),t("div",Nh,[t("div",{class:w(["main-value",i.getSignalClass((S=s.testData.ma30)==null?void 0:S.signal)])},l(((D=s.testData.ma30)==null?void 0:D.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((b=s.testData.ma30)==null?void 0:b.signal)])},l(((P=s.testData.ma30)==null?void 0:P.signal)||"N/A"),3)])]),t("div",Lh,[e[12]||(e[12]=t("h4",null,"SMA50",-1)),t("div",Ph,[t("div",{class:w(["main-value",i.getSignalClass((I=s.testData.sma50)==null?void 0:I.signal)])},l(((L=s.testData.sma50)==null?void 0:L.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((y=s.testData.sma50)==null?void 0:y.signal)])},l(((O=s.testData.sma50)==null?void 0:O.signal)||"N/A"),3),t("div",$h,[t("small",null,"Áï∂ÂâçÂÉπÊ†º: $"+l(((C=s.testData.sma50)==null?void 0:C.currentPrice)||"N/A"),1)])])])])]),t("div",Rh,[e[17]||(e[17]=t("h3",null,"‰∏ÄÁõÆÂùáË°°Ë°® (Ichimoku Cloud)",-1)),t("div",Eh,[t("div",Fh,[e[14]||(e[14]=t("h4",null,"ËΩâÊèõÁ∑ö (9)",-1)),t("div",Oh,[t("div",{class:w(["main-value",i.getSignalClass((M=s.testData.ichimokuConversionLine)==null?void 0:M.signal)])},l(((p=s.testData.ichimokuConversionLine)==null?void 0:p.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((B=s.testData.ichimokuConversionLine)==null?void 0:B.signal)])},l(((j=s.testData.ichimokuConversionLine)==null?void 0:j.signal)||"N/A"),3),t("div",Uh,[t("small",null,"ÊúÄÈ´ò: "+l(((k=s.testData.ichimokuConversionLine)==null?void 0:k.highestHigh)||"N/A"),1),t("small",null,"ÊúÄ‰Ωé: "+l(((q=s.testData.ichimokuConversionLine)==null?void 0:q.lowestLow)||"N/A"),1)])])]),t("div",Vh,[e[15]||(e[15]=t("h4",null,"Âü∫Ê∫ñÁ∑ö (26)",-1)),t("div",Wh,[t("div",{class:w(["main-value",i.getSignalClass((oe=s.testData.ichimokuBaseLine)==null?void 0:oe.signal)])},l(((ce=s.testData.ichimokuBaseLine)==null?void 0:ce.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((ee=s.testData.ichimokuBaseLine)==null?void 0:ee.signal)])},l(((de=s.testData.ichimokuBaseLine)==null?void 0:de.signal)||"N/A"),3),t("div",Bh,[t("small",null,"ÊúÄÈ´ò: "+l(((ue=s.testData.ichimokuBaseLine)==null?void 0:ue.highestHigh)||"N/A"),1),t("small",null,"ÊúÄ‰Ωé: "+l(((he=s.testData.ichimokuBaseLine)==null?void 0:he.lowestLow)||"N/A"),1)])])]),t("div",qh,[e[16]||(e[16]=t("h4",null,"ÈÅ≤Ë°åÁ∑ö (26)",-1)),t("div",Hh,[t("div",{class:w(["main-value",i.getSignalClass((fe=s.testData.ichimokuLaggingSpan)==null?void 0:fe.signal)])},l(((re=s.testData.ichimokuLaggingSpan)==null?void 0:re.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((z=s.testData.ichimokuLaggingSpan)==null?void 0:z.signal)])},l(((pe=s.testData.ichimokuLaggingSpan)==null?void 0:pe.signal)||"N/A"),3),t("div",zh,[t("small",null,"ÂèÉËÄÉÂÉπ: "+l(((ve=s.testData.ichimokuLaggingSpan)==null?void 0:ve.laggingReference)||"N/A"),1)])])])])]),t("div",jh,[e[19]||(e[19]=t("h3",null,"Êàê‰∫§ÈáèÂä†Ê¨äÁßªÂãïÂπ≥ÂùáÁ∑ö (VWMA)",-1)),t("div",Gh,[t("div",Qh,[e[18]||(e[18]=t("h4",null,"VWMA (20)",-1)),t("div",Yh,[t("div",{class:w(["main-value",i.getSignalClass((ye=s.testData.vwma20)==null?void 0:ye.signal)])},l(((we=s.testData.vwma20)==null?void 0:we.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((Se=s.testData.vwma20)==null?void 0:Se.signal)])},l(((Q=s.testData.vwma20)==null?void 0:Q.signal)||"N/A"),3),t("div",Xh,[t("small",null,"Áï∂ÂâçÂÉπÊ†º: $"+l(((Ne=s.testData.vwma20)==null?void 0:Ne.currentPrice)||"N/A"),1),t("small",null,"Á∏ΩÊàê‰∫§Èáè: "+l(((Le=s.testData.vwma20)==null?void 0:Le.totalVolume)||"N/A"),1)])])])])]),t("div",Kh,[e[23]||(e[23]=t("h3",null,"ÊäÄË°ìÊåáÊ®ô (Technical Indicators)",-1)),t("div",Jh,[t("div",Zh,[e[20]||(e[20]=t("h4",null,"Relative Strength Index (14)",-1)),t("div",eg,[t("div",{class:w(["main-value",i.getSignalClass((Pe=s.testData.rsi14)==null?void 0:Pe.signal)])},l((($e=s.testData.rsi14)==null?void 0:$e.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((Re=s.testData.rsi14)==null?void 0:Re.signal)])},l(((Ee=s.testData.rsi14)==null?void 0:Ee.signal)||"N/A"),3),(Fe=s.testData.rsi14)!=null&&Fe.value?(u(),h("div",tg,[t("div",{class:"rsi-fill",style:G({width:s.testData.rsi14.value+"%"})},null,4)])):_("",!0)])]),t("div",sg,[e[21]||(e[21]=t("h4",null,"Average Directional Index (14)",-1)),t("div",ag,[t("div",{class:w(["main-value",i.getSignalClass((Oe=s.testData.adx14)==null?void 0:Oe.signal)])},l(((Ue=s.testData.adx14)==null?void 0:Ue.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((Ve=s.testData.adx14)==null?void 0:Ve.signal)])},l(((We=s.testData.adx14)==null?void 0:We.signal)||"N/A"),3),t("div",ng,[t("small",null,"+DI: "+l(((Be=s.testData.adx14)==null?void 0:Be.plusDI)||"N/A"),1),t("small",null,"-DI: "+l(((qe=s.testData.adx14)==null?void 0:qe.minusDI)||"N/A"),1)])])]),t("div",ig,[e[22]||(e[22]=t("h4",null,"MACD Level (12, 26)",-1)),t("div",og,[t("div",{class:w(["main-value",i.getSignalClass((He=s.testData.macd)==null?void 0:He.signal)])},l(((ze=s.testData.macd)==null?void 0:ze.value)||"N/A"),3),t("div",{class:w(["signal-badge",i.getSignalClass((je=s.testData.macd)==null?void 0:je.signal)])},l(((Ge=s.testData.macd)==null?void 0:Ge.signal)||"N/A"),3),t("div",rg,[t("small",null,"‰ø°ËôüÁ∑ö: "+l(((Qe=s.testData.macd)==null?void 0:Qe.signalLine)||"N/A"),1),t("small",null,"Êü±ÁãÄÂúñ: "+l(((Ye=s.testData.macd)==null?void 0:Ye.histogram)||"N/A"),1),t("small",null,"EMA12: "+l(((Xe=s.testData.macd)==null?void 0:Xe.ema12)||"N/A"),1),t("small",null,"EMA26: "+l(((Ke=s.testData.macd)==null?void 0:Ke.ema26)||"N/A"),1)])])])])])]),t("div",lg,[t("p",null,[e[24]||(e[24]=t("strong",null,"ÊúÄÂæåÊõ¥Êñ∞:",-1)),A(" "+l(i.formatDate(s.testData.lastUpdated)),1)]),t("p",null,[e[25]||(e[25]=t("strong",null,"Êï∏Êìö‰æÜÊ∫ê:",-1)),A(" "+l(s.testData.source||"Yahoo Finance"),1)]),s.testData.proxy?(u(),h("p",cg,[e[26]||(e[26]=t("strong",null,"‰ª£ÁêÜÊúçÂãô:",-1)),A(" "+l(s.testData.proxy),1)])):_("",!0),s.testData.dataPoints?(u(),h("p",dg,[e[27]||(e[27]=t("strong",null,"Êï∏ÊìöÈªûÊï∏Èáè:",-1)),A(" "+l(s.testData.dataPoints),1)])):_("",!0),s.testData.error?(u(),h("p",ug,[e[28]||(e[28]=t("strong",null,"Ê≥®ÊÑè:",-1)),A(" "+l(s.testData.error),1)])):_("",!0)])])):_("",!0),t("div",hg,[e[31]||(e[31]=t("h3",null,"Á∑©Â≠òÁãÄÊÖã",-1)),t("button",{onClick:e[3]||(e[3]=te=>i.loadCacheStatus()),class:"cache-btn"},"Ê™¢Êü•Á∑©Â≠ò"),t("button",{onClick:e[4]||(e[4]=te=>i.clearCache()),class:"cache-btn"},"Ê∏ÖÈô§ÊâÄÊúâÁ∑©Â≠ò"),s.cacheStatus?(u(),h("div",gg,[e[29]||(e[29]=t("h4",null,"API Ë´ãÊ±ÇÁ∑©Â≠ò (5ÂàÜÈêò)",-1)),t("pre",null,l(JSON.stringify(s.cacheStatus.apiCache,null,2)),1),e[30]||(e[30]=t("h4",null,"ÊØèÊó•ÊäÄË°ìÊåáÊ®ôÁ∑©Â≠ò (24Â∞èÊôÇ)",-1)),t("pre",null,l(JSON.stringify(s.cacheStatus.dailyCache,null,2)),1)])):_("",!0)])])}const fg=R(gh,[["render",mg],["__scopeId","data-v-09d65e6d"]]),pg={name:"TechnicalIndicatorsValidation",data(){return{testSymbol:"AAPL",loading:!1,ourData:null,tradingViewWidget:null}},methods:{async loadData(){if(this.testSymbol){this.loading=!0,this.ourData=null;try{ie.setMockMode(!1),this.ourData=await ie.getTechnicalIndicators(this.testSymbol),this.loadTradingViewWidget()}catch(n){console.error("Failed to load data:",n)}finally{this.loading=!1}}},loadTradingViewWidget(){if(this.tradingViewWidget){const n=document.getElementById(`tradingview-widget-${this.testSymbol}`);n&&(n.innerHTML="")}setTimeout(()=>{const n=document.createElement("script");n.type="text/javascript",n.src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js",n.async=!0,n.innerHTML=JSON.stringify({interval:"1D",width:"100%",height:"400",isTransparent:!1,symbol:`NASDAQ:${this.testSymbol}`,showIntervalTabs:!0,locale:"en",colorTheme:"light"});const e=document.getElementById(`tradingview-widget-${this.testSymbol}`);e&&e.appendChild(n)},100)},getSignalClass(n){if(!n)return"neutral";const e=["BUY","OVERSOLD"],a=["SELL","OVERBOUGHT"];return e.includes(n)?"bullish":a.includes(n)?"bearish":"neutral"}},mounted(){this.loadData()}},vg={class:"validation-page"},yg={class:"validation-controls"},wg={class:"symbol-input"},Sg=["disabled"],bg={key:0,class:"loading-section"},_g={key:1,class:"comparison-section"},kg={class:"comparison-grid"},Cg={class:"our-results"},Tg={class:"indicator-list"},Dg={class:"indicator-item"},Ag={class:"indicator-item"},Ig={class:"indicator-item"},xg={class:"debug-info"},Mg={class:"tradingview-results"},Ng={class:"tradingview-widget-container"},Lg=["id"],Pg={class:"detailed-comparison"},$g={class:"comparison-table"};function Rg(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D,b,P,I,L,y,O,C,M,p;return u(),h("div",vg,[e[26]||(e[26]=t("div",{class:"validation-header"},[t("h2",null,"ÊäÄË°ìÊåáÊ®ôÈ©óË≠â"),t("p",null,"Â∞çÊØîÊàëÂÄëÁöÑË®àÁÆóÁµêÊûúËàá TradingView ÁöÑÊï∏Êìö")],-1)),t("div",yg,[t("div",wg,[e[3]||(e[3]=t("label",null,"ËÇ°Á•®‰ª£Ëôü:",-1)),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=B=>s.testSymbol=B),type:"text",placeholder:"‰æãÂ¶Ç: AAPL",onKeyup:e[1]||(e[1]=Je(B=>i.loadData(),["enter"]))},null,544),[[me,s.testSymbol]]),t("button",{onClick:e[2]||(e[2]=B=>i.loadData()),disabled:s.loading},l(s.loading?"ËºâÂÖ•‰∏≠...":"ËºâÂÖ•Êï∏Êìö"),9,Sg)])]),s.loading?(u(),h("div",bg,[...e[4]||(e[4]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Ê≠£Âú®ËºâÂÖ•Êï∏Êìö...",-1)])])):_("",!0),s.ourData&&!s.loading?(u(),h("div",_g,[t("h3",null,l(s.testSymbol)+" ÊäÄË°ìÊåáÊ®ôÂ∞çÊØî",1),t("div",kg,[t("div",Cg,[e[13]||(e[13]=t("h4",null,"ÊàëÂÄëÁöÑË®àÁÆóÁµêÊûú",-1)),t("div",Tg,[t("div",Dg,[e[5]||(e[5]=t("strong",null,"SMA(50):",-1)),A(" "+l(((r=s.ourData.sma50)==null?void 0:r.value)||"N/A")+" ",1),t("span",{class:w(["signal",i.getSignalClass((d=s.ourData.sma50)==null?void 0:d.signal)])},l((c=s.ourData.sma50)==null?void 0:c.signal),3)]),t("div",Ag,[e[6]||(e[6]=t("strong",null,"RSI(14):",-1)),A(" "+l(((g=s.ourData.rsi14)==null?void 0:g.value)||"N/A")+" ",1),t("span",{class:w(["signal",i.getSignalClass((v=s.ourData.rsi14)==null?void 0:v.signal)])},l((f=s.ourData.rsi14)==null?void 0:f.signal),3)]),t("div",Ig,[e[7]||(e[7]=t("strong",null,"MACD:",-1)),A(" "+l(((m=s.ourData.macd)==null?void 0:m.value)||"N/A")+" ",1),t("span",{class:w(["signal",i.getSignalClass((T=s.ourData.macd)==null?void 0:T.signal)])},l((S=s.ourData.macd)==null?void 0:S.signal),3)])]),t("div",xg,[e[12]||(e[12]=t("h5",null,"Ë™øË©¶‰ø°ÊÅØ",-1)),t("p",null,[e[8]||(e[8]=t("strong",null,"Êï∏ÊìöÈªû:",-1)),A(" "+l(s.ourData.dataPoints),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"ÂÉπÊ†ºÁØÑÂúç:",-1)),A(" $"+l((D=s.ourData.priceRange)==null?void 0:D.min)+" - $"+l((b=s.ourData.priceRange)==null?void 0:b.max),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"ÊúÄÊñ∞ÂÉπÊ†º:",-1)),A(" $"+l((P=s.ourData.priceRange)==null?void 0:P.latest),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Áï∂ÂâçÂÉπÊ†º:",-1)),A(" $"+l((I=s.ourData.sma50)==null?void 0:I.currentPrice),1)])])]),t("div",Mg,[e[14]||(e[14]=t("h4",null,"TradingView ÊäÄË°ìÂàÜÊûê",-1)),t("div",Ng,[t("div",{class:"tradingview-widget",id:`tradingview-widget-${s.testSymbol}`},null,8,Lg)])])]),t("div",Pg,[e[25]||(e[25]=t("h4",null,"Ë©≥Á¥∞Êï∏ÊìöÂ∞çÊØî",-1)),t("div",$g,[t("table",null,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",null,"ÊåáÊ®ô"),t("th",null,"ÊàëÂÄëÁöÑÁµêÊûú"),t("th",null,"TradingView"),t("th",null,"Â∑ÆÁï∞"),t("th",null,"ÁãÄÊÖã")])],-1)),t("tbody",null,[t("tr",null,[e[15]||(e[15]=t("td",null,"SMA(50)",-1)),t("td",null,"$"+l(((L=s.ourData.sma50)==null?void 0:L.value)||"N/A"),1),e[16]||(e[16]=t("td",null,"Ë´ãÊü•ÁúãÂè≥ÂÅ¥ Widget",-1)),e[17]||(e[17]=t("td",null,"-",-1)),t("td",null,l((y=s.ourData.sma50)==null?void 0:y.signal),1)]),t("tr",null,[e[18]||(e[18]=t("td",null,"RSI(14)",-1)),t("td",null,l(((O=s.ourData.rsi14)==null?void 0:O.value)||"N/A"),1),e[19]||(e[19]=t("td",null,"Ë´ãÊü•ÁúãÂè≥ÂÅ¥ Widget",-1)),e[20]||(e[20]=t("td",null,"-",-1)),t("td",null,l((C=s.ourData.rsi14)==null?void 0:C.signal),1)]),t("tr",null,[e[21]||(e[21]=t("td",null,"MACD",-1)),t("td",null,l(((M=s.ourData.macd)==null?void 0:M.value)||"N/A"),1),e[22]||(e[22]=t("td",null,"Ë´ãÊü•ÁúãÂè≥ÂÅ¥ Widget",-1)),e[23]||(e[23]=t("td",null,"-",-1)),t("td",null,l((p=s.ourData.macd)==null?void 0:p.signal),1)])])])])])])):_("",!0)])}const Eg=R(pg,[["render",Rg],["__scopeId","data-v-933bb253"]]),Fg={name:"MetadataServiceTest",data(){return{useDynamicAPI:!0,loading:!1,loadingMessage:"",error:null,successMessage:null,testSymbol:"AAPL",testResults:[],comparisonResults:[],cacheStats:null,testSymbols:["AAPL","MSFT","GOOGL","TSLA","NVDA","META","AMZN","NFLX","ASTS","RIVN"]}},async mounted(){await this.updateCacheStats()},methods:{async switchMode(){try{ke.setUseDynamicAPI(this.useDynamicAPI),await this.updateCacheStats(),this.successMessage=`Â∑≤ÂàáÊèõÂà∞${this.useDynamicAPI?"ÂãïÊÖã API":"ÈùúÊÖãÊñá‰ª∂"}Ê®°Âºè`,setTimeout(()=>{this.successMessage=null},3e3)}catch(n){this.error=`ÂàáÊèõÊ®°ÂºèÂ§±Êïó: ${n.message}`,setTimeout(()=>{this.error=null},5e3)}},async testSingleSymbol(){if(!this.testSymbol.trim()){this.error="Ë´ãËº∏ÂÖ•ËÇ°Á•®‰ª£Á¢º",setTimeout(()=>{this.error=null},3e3);return}this.loading=!0,this.loadingMessage=`Ê≠£Âú®Áç≤Âèñ ${this.testSymbol} ÁöÑÂÖÉÊï∏Êìö...`,this.error=null;try{const n=Date.now(),e=await ke.getSymbolMetadata(this.testSymbol.toUpperCase()),a=Date.now()-n,o={...e,duration:a,timestamp:new Date().toISOString()};this.testResults=[o,...this.testResults.filter(s=>s.symbol!==o.symbol)],this.successMessage=`ÊàêÂäüÁç≤Âèñ ${o.symbol} ÁöÑÂÖÉÊï∏Êìö (${a}ms)`,setTimeout(()=>{this.successMessage=null},3e3),await this.updateCacheStats()}catch(n){this.error=`Áç≤ÂèñÂÖÉÊï∏ÊìöÂ§±Êïó: ${n.message}`,setTimeout(()=>{this.error=null},5e3)}finally{this.loading=!1,this.loadingMessage=""}},async testBatchSymbols(){this.loading=!0,this.loadingMessage=`Ê≠£Âú®ÊâπÈáèÁç≤Âèñ ${this.testSymbols.length} ÂÄãËÇ°Á•®ÁöÑÂÖÉÊï∏Êìö...`,this.error=null;try{const n=Date.now(),e=await ke.getBatchMetadata(this.testSymbols),a=Date.now()-n,o=[];for(const[s,i]of e)o.push({...i,duration:a/e.size,timestamp:new Date().toISOString()});this.testResults=o,this.successMessage=`ÊàêÂäüÊâπÈáèÁç≤Âèñ ${o.length} ÂÄãËÇ°Á•®ÁöÑÂÖÉÊï∏Êìö (${a}ms)`,setTimeout(()=>{this.successMessage=null},3e3),await this.updateCacheStats()}catch(n){this.error=`ÊâπÈáèÁç≤ÂèñÂ§±Êïó: ${n.message}`,setTimeout(()=>{this.error=null},5e3)}finally{this.loading=!1,this.loadingMessage=""}},async clearCache(){this.loading=!0,this.loadingMessage="Ê≠£Âú®Ê∏ÖÈô§Á∑©Â≠ò...";try{ke.clearCache(),await this.updateCacheStats(),this.successMessage="Á∑©Â≠òÂ∑≤Ê∏ÖÈô§",setTimeout(()=>{this.successMessage=null},3e3)}catch(n){this.error=`Ê∏ÖÈô§Á∑©Â≠òÂ§±Êïó: ${n.message}`,setTimeout(()=>{this.error=null},5e3)}finally{this.loading=!1,this.loadingMessage=""}},async warmupCache(){this.loading=!0,this.loadingMessage="Ê≠£Âú®È†êÁÜ±Á∑©Â≠ò...";try{const n=await ke.warmupCache(this.testSymbols);await this.updateCacheStats(),this.successMessage=`Á∑©Â≠òÈ†êÁÜ±ÂÆåÊàê: ${n.symbolsProcessed} ÂÄãËÇ°Á•®, ${n.duration}ms`,setTimeout(()=>{this.successMessage=null},3e3)}catch(n){this.error=`È†êÁÜ±Á∑©Â≠òÂ§±Êïó: ${n.message}`,setTimeout(()=>{this.error=null},5e3)}finally{this.loading=!1,this.loadingMessage=""}},async updateCacheStats(){try{this.cacheStats=ke.getCacheStats()}catch(n){console.warn("Failed to get cache stats:",n)}},getResultCardClass(n){return n.confidence>=.9?"high-confidence":n.confidence>=.7?"medium-confidence":n.confidence>=.5?"low-confidence":"no-confidence"},getConfidenceBadgeClass(n){return n>=.9?"high":n>=.7?"medium":n>=.5?"low":"none"},formatTimestamp(n){return n?new Date(n).toLocaleString("zh-TW"):"N/A"}}},Og={class:"metadata-test-container"},Ug={class:"control-panel"},Vg={class:"mode-selector"},Wg={class:"test-controls"},Bg=["disabled"],qg=["disabled"],Hg=["disabled"],zg=["disabled"],jg={class:"symbol-input"},Gg={key:0,class:"status-panel"},Qg={key:0,class:"loading"},Yg={key:1,class:"error"},Xg={key:2,class:"success"},Kg={key:1,class:"cache-stats"},Jg={class:"stats-grid"},Zg={class:"stat-item"},em={class:"stat-item"},tm={key:0,class:"stat-item"},sm={key:2,class:"results-section"},am={class:"results-grid"},nm={class:"result-header"},im={class:"result-content"},om={class:"metadata-row"},rm={class:"metadata-row"},lm={class:"metadata-row"},cm={key:0,class:"metadata-row"},dm={key:1,class:"metadata-row"},um={class:"result-footer"},hm={class:"source-info"},gm={class:"timestamp"},mm={key:3,class:"comparison-section"},fm={class:"comparison-table"};function pm(n,e,a,o,s,i){return u(),h("div",Og,[e[25]||(e[25]=t("div",{class:"header"},[t("h1",null,"ÂÖÉÊï∏ÊìöÊúçÂãôÊ∏¨Ë©¶"),t("p",null,"Ê∏¨Ë©¶ÂãïÊÖã Yahoo Finance API vs ÈùúÊÖãÊñá‰ª∂ÁöÑ sector/industry Êï∏Êìö")],-1)),t("div",Ug,[t("div",Vg,[t("label",null,[H(t("input",{type:"radio",value:!0,"onUpdate:modelValue":e[0]||(e[0]=r=>s.useDynamicAPI=r),onChange:e[1]||(e[1]=(...r)=>i.switchMode&&i.switchMode(...r))},null,544),[[ds,s.useDynamicAPI]]),e[10]||(e[10]=A(" ÂãïÊÖã API (Yahoo Finance) ",-1))]),t("label",null,[H(t("input",{type:"radio",value:!1,"onUpdate:modelValue":e[2]||(e[2]=r=>s.useDynamicAPI=r),onChange:e[3]||(e[3]=(...r)=>i.switchMode&&i.switchMode(...r))},null,544),[[ds,s.useDynamicAPI]]),e[11]||(e[11]=A(" ÈùúÊÖãÊñá‰ª∂ (symbols_metadata.json) ",-1))])]),t("div",Wg,[t("button",{onClick:e[4]||(e[4]=(...r)=>i.testSingleSymbol&&i.testSingleSymbol(...r)),disabled:s.loading}," Ê∏¨Ë©¶ÂñÆÂÄãËÇ°Á•® ",8,Bg),t("button",{onClick:e[5]||(e[5]=(...r)=>i.testBatchSymbols&&i.testBatchSymbols(...r)),disabled:s.loading}," ÊâπÈáèÊ∏¨Ë©¶ ",8,qg),t("button",{onClick:e[6]||(e[6]=(...r)=>i.clearCache&&i.clearCache(...r)),disabled:s.loading}," Ê∏ÖÈô§Á∑©Â≠ò ",8,Hg),t("button",{onClick:e[7]||(e[7]=(...r)=>i.warmupCache&&i.warmupCache(...r)),disabled:s.loading}," È†êÁÜ±Á∑©Â≠ò ",8,zg)]),t("div",jg,[H(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>s.testSymbol=r),placeholder:"Ëº∏ÂÖ•ËÇ°Á•®‰ª£Á¢º (‰æãÂ¶Ç: AAPL)",onKeyup:e[9]||(e[9]=Je((...r)=>i.testSingleSymbol&&i.testSingleSymbol(...r),["enter"]))},null,544),[[me,s.testSymbol]])])]),s.loading||s.error||s.successMessage?(u(),h("div",Gg,[s.loading?(u(),h("div",Qg,[e[12]||(e[12]=t("span",{class:"spinner"},null,-1)),A(" "+l(s.loadingMessage),1)])):_("",!0),s.error?(u(),h("div",Yg," ‚ùå "+l(s.error),1)):_("",!0),s.successMessage?(u(),h("div",Xg," ‚úÖ "+l(s.successMessage),1)):_("",!0)])):_("",!0),s.cacheStats?(u(),h("div",Kg,[e[16]||(e[16]=t("h3",null,"Á∑©Â≠òÁµ±Ë®à",-1)),t("div",Jg,[t("div",Zg,[e[13]||(e[13]=t("label",null,"Ê®°Âºè:",-1)),t("span",null,l(s.cacheStats.mode==="dynamic"?"ÂãïÊÖã API":"ÈùúÊÖãÊñá‰ª∂"),1)]),t("div",em,[e[14]||(e[14]=t("label",null,"Á∑©Â≠òÊ¢ùÁõÆ:",-1)),t("span",null,l(s.cacheStats.totalCached||0),1)]),s.cacheStats.mode==="static"?(u(),h("div",tm,[e[15]||(e[15]=t("label",null,"ÂÖÉÊï∏ÊìöÂ∑≤ËºâÂÖ•:",-1)),t("span",null,l(s.cacheStats.metadataLoaded?"ÊòØ":"Âê¶"),1)])):_("",!0)])])):_("",!0),s.testResults.length>0?(u(),h("div",sm,[e[22]||(e[22]=t("h3",null,"Ê∏¨Ë©¶ÁµêÊûú",-1)),t("div",am,[(u(!0),h(E,null,F(s.testResults,r=>(u(),h("div",{key:r.symbol,class:w(["result-card",i.getResultCardClass(r)])},[t("div",nm,[t("h4",null,l(r.symbol),1),t("span",{class:w(["confidence-badge",i.getConfidenceBadgeClass(r.confidence)])},l((r.confidence*100).toFixed(0))+"% ",3)]),t("div",im,[t("div",om,[e[17]||(e[17]=t("label",null,"Sector:",-1)),t("span",null,l(r.sector),1)]),t("div",rm,[e[18]||(e[18]=t("label",null,"Industry:",-1)),t("span",null,l(r.industry),1)]),t("div",lm,[e[19]||(e[19]=t("label",null,"Exchange:",-1)),t("span",null,l(r.exchange),1)]),r.marketCapFormatted?(u(),h("div",cm,[e[20]||(e[20]=t("label",null,"Market Cap:",-1)),t("span",null,l(r.marketCapFormatted),1)])):_("",!0),r.country?(u(),h("div",dm,[e[21]||(e[21]=t("label",null,"Country:",-1)),t("span",null,l(r.country),1)])):_("",!0)]),t("div",um,[t("div",hm,[t("small",null,l(r.source),1)]),t("div",gm,[t("small",null,l(i.formatTimestamp(r.lastUpdated)),1)])])],2))),128))])])):_("",!0),s.comparisonResults.length>0?(u(),h("div",mm,[e[24]||(e[24]=t("h3",null,"ÂãïÊÖã vs ÈùúÊÖãÊØîËºÉ",-1)),t("div",fm,[t("table",null,[e[23]||(e[23]=t("thead",null,[t("tr",null,[t("th",null,"Symbol"),t("th",null,"ÂãïÊÖã API - Sector"),t("th",null,"ÈùúÊÖãÊñá‰ª∂ - Sector"),t("th",null,"ÂãïÊÖã API - Industry"),t("th",null,"ÈùúÊÖãÊñá‰ª∂ - Industry"),t("th",null,"ÂåπÈÖçÂ∫¶")])],-1)),t("tbody",null,[(u(!0),h(E,null,F(s.comparisonResults,r=>(u(),h("tr",{key:r.symbol},[t("td",null,l(r.symbol),1),t("td",null,l(r.dynamic.sector),1),t("td",null,l(r.static.sector),1),t("td",null,l(r.dynamic.industry),1),t("td",null,l(r.static.industry),1),t("td",null,[t("span",{class:w(["match-indicator",r.matchClass])},l(r.matchScore)+"% ",3)])]))),128))])])])])):_("",!0)])}const vm=R(Fg,[["render",pm],["__scopeId","data-v-6d662d12"]]),ym={name:"ProxyDiagnosticTest",data(){var n;return{testSymbol:"AAPL",testing:!1,currentTest:"",diagnosticComplete:!1,proxyResults:[],directApiResults:{chart:null,quoteSummary:null},networkInfo:{userAgent:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,connection:((n=navigator.connection)==null?void 0:n.effectiveType)||"unknown",online:navigator.onLine},corsProxies:[{name:"CORS.SH",url:"https://cors.sh/",description:"Â∞àÊ•≠ÁöÑ CORS ‰ª£ÁêÜÊúçÂãôÔºåÁõ∏Â∞çÁ©©ÂÆö",type:"direct"},{name:"Proxy CORS (isomorphic-git)",url:"https://proxy-cors.isomorphic-git.org/",description:"Áî± isomorphic-git ÂúòÈöäÁ∂≠Ë≠∑",type:"direct"},{name:"ThingProxy",url:"https://thingproxy.freeboard.io/fetch/",description:"Áî± Freeboard.io Êèê‰æõÁöÑ‰ª£ÁêÜÊúçÂãô",type:"direct"},{name:"CORS Proxy (HTMLDriven)",url:"https://cors-proxy.htmldriven.com/?url=",description:"Á∞°ÂñÆÊòìÁî®ÁöÑ‰ª£ÁêÜÊúçÂãô",type:"query"},{name:"AllOrigins",url:"https://api.allorigins.win/raw?url=",description:"ÂÖçË≤ª CORS ‰ª£ÁêÜÊúçÂãô (ÂèØËÉΩÊúâ CORS ÈôêÂà∂)",type:"query"},{name:"CorsProxy.io",url:"https://corsproxy.io/?",description:"ÈñãÊ∫ê CORS ‰ª£ÁêÜ (ÂèØËÉΩÈúÄË¶ÅË™çË≠â)",type:"query"},{name:"CORS Anywhere",url:"https://cors-anywhere.herokuapp.com/",description:"Heroku Ë®óÁÆ°ÁöÑ CORS ‰ª£ÁêÜ (Â∑≤ÈôêÂà∂Ë®™Âïè)",type:"direct"}]}},computed:{workingProxies(){return this.proxyResults.filter(n=>n.status==="SUCCESS")},failedProxies(){return this.proxyResults.filter(n=>n.status==="FAILED")},fastestProxy(){const n=this.workingProxies;return n.length===0?null:n.reduce((e,a)=>a.responseTime<e.responseTime?a:e)}},methods:{async runFullDiagnostic(){this.testing=!0,this.diagnosticComplete=!1,this.proxyResults=[],this.directApiResults={chart:null,quoteSummary:null};try{await this.testAllProxies(),await this.testDirectAPI(),this.diagnosticComplete=!0}catch(n){console.error("Ë®∫Êñ∑ÈÅéÁ®ãÂá∫ÈåØ:",n)}finally{this.testing=!1,this.currentTest=""}},async testAllProxies(){for(let n=0;n<this.corsProxies.length;n++){const e=this.corsProxies[n];this.currentTest=`${e.name} ‰ª£ÁêÜÊúçÂãô`;const a=await this.testSingleProxy(e,n);this.proxyResults.push(a),n<this.corsProxies.length-1&&await this.delay(1e3)}},async testSingleProxy(n,e){var s,i;const a=Date.now(),o={index:e,name:n.name,url:n.url,type:n.type,status:"TESTING",responseTime:0,httpStatus:null,error:null,errorType:null,data:null,dataPoints:0,priceRange:null};try{const r=`https://query1.finance.yahoo.com/v8/finance/chart/${this.testSymbol}?interval=1d&range=1mo`;let d;n.type==="query"?d=`${n.url}${encodeURIComponent(r)}`:d=`${n.url}${r}`,console.log(`Testing ${n.name}:`,d.substring(0,120)+"...");const c=await fetch(d,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(o.responseTime=Date.now()-a,o.httpStatus=c.status,!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const g=await c.json();if(!g.chart||!g.chart.result||g.chart.result.length===0)throw new Error("Invalid data structure - no chart results");const f=(i=(s=g.chart.result[0].indicators)==null?void 0:s.quote)==null?void 0:i[0];if(!f||!f.close)throw new Error("Invalid data structure - no price data");const m=f.close.filter(T=>T!==null);o.status="SUCCESS",o.data=g,o.dataPoints=m.length,o.priceRange={min:Math.min(...m).toFixed(2),max:Math.max(...m).toFixed(2)},console.log(`‚úÖ ${n.name} ÊàêÂäü:`,{responseTime:o.responseTime,dataPoints:o.dataPoints,priceRange:o.priceRange})}catch(r){o.status="FAILED",o.responseTime=Date.now()-a,o.error=r.message,r.message.includes("CORS")||r.message.includes("cors")?o.errorType="CORS_ERROR":r.message.includes("401")?o.errorType="UNAUTHORIZED":r.message.includes("403")?o.errorType="FORBIDDEN":r.message.includes("404")?o.errorType="NOT_FOUND":r.message.includes("429")?o.errorType="RATE_LIMITED":r.message.includes("Failed to fetch")||r.message.includes("fetch")?o.errorType="NETWORK_ERROR":r.message.includes("Invalid data structure")?o.errorType="DATA_FORMAT_ERROR":r.message.includes("timeout")?o.errorType="TIMEOUT_ERROR":o.errorType="UNKNOWN_ERROR",console.log(`‚ùå ${n.name} Â§±Êïó:`,{errorType:o.errorType,error:o.error,responseTime:o.responseTime})}return o},async testDirectAPI(){var n,e,a,o,s,i,r,d,c,g,v;this.currentTest="Yahoo Finance API Áõ¥Êé•Ë®™Âïè";try{const f=`https://query1.finance.yahoo.com/v8/finance/chart/${this.testSymbol}?interval=1d&range=1mo`,m=await fetch(f);if(m.ok){const S=((d=(r=(i=(s=(o=(a=(e=(n=(await m.json()).chart)==null?void 0:n.result)==null?void 0:e[0])==null?void 0:a.indicators)==null?void 0:o.quote)==null?void 0:s[0])==null?void 0:i.close)==null?void 0:r.filter(D=>D!==null))==null?void 0:d.length)||0;this.directApiResults.chart={status:"SUCCESS",dataPoints:S}}else throw new Error(`HTTP ${m.status}`)}catch(f){this.directApiResults.chart={status:"FAILED",error:f.message}}try{const f=`https://query1.finance.yahoo.com/v10/finance/quoteSummary/${this.testSymbol}?modules=summaryProfile`,m=await fetch(f);if(m.ok){const S=(v=(g=(c=(await m.json()).quoteSummary)==null?void 0:c.result)==null?void 0:g[0])==null?void 0:v.summaryProfile;this.directApiResults.quoteSummary={status:"SUCCESS",sector:S==null?void 0:S.sector,industry:S==null?void 0:S.industry}}else throw new Error(`HTTP ${m.status}`)}catch(f){this.directApiResults.quoteSummary={status:"FAILED",error:f.message}}},getStatusClass(n){switch(n){case"SUCCESS":return"success";case"FAILED":return"failed";case"TESTING":return"testing";default:return"unknown"}},delay(n){return new Promise(e=>setTimeout(e,n))}}},wm={class:"proxy-diagnostic"},Sm={class:"test-controls"},bm={class:"symbol-input"},_m=["disabled"],km={key:0,class:"loading"},Cm={class:"proxy-results"},Tm={class:"proxy-grid"},Dm={class:"proxy-header"},Am={class:"proxy-details"},Im={key:0,class:"error-details"},xm={key:1,class:"success-details"},Mm={class:"direct-api-test"},Nm={class:"api-test-grid"},Lm={class:"api-test-card"},Pm={key:0},$m={key:1},Rm={class:"api-test-card"},Em={key:0},Fm={key:1},Om={key:2},Um={class:"network-info"},Vm={class:"network-details"},Wm={key:1,class:"recommendations"},Bm={class:"recommendation-content"},qm={key:0,class:"success-recommendation"},Hm={key:1,class:"warning-recommendation"},zm={class:"solution-suggestions"},jm={key:0,class:"critical-suggestions"},Gm={key:1,class:"optimization-suggestions"};function Qm(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D;return u(),h("div",wm,[e[35]||(e[35]=t("div",{class:"test-header"},[t("h2",null,"üîç Yahoo Finance API Proxy Ë®∫Êñ∑Â∑•ÂÖ∑"),t("p",null,"Ê∏¨Ë©¶ÂêÑÂÄã CORS ‰ª£ÁêÜÊúçÂãôÁöÑÂèØÁî®ÊÄßÂíå Yahoo Finance API ÁöÑÁãÄÊÖã")],-1)),t("div",Sm,[t("div",bm,[e[2]||(e[2]=t("label",null,"Ê∏¨Ë©¶ËÇ°Á•®:",-1)),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=b=>s.testSymbol=b),placeholder:"AAPL"},null,512),[[me,s.testSymbol]]),t("button",{onClick:e[1]||(e[1]=(...b)=>i.runFullDiagnostic&&i.runFullDiagnostic(...b)),disabled:s.testing},l(s.testing?"Ê∏¨Ë©¶‰∏≠...":"ÈñãÂßãÂÆåÊï¥Ë®∫Êñ∑"),9,_m)])]),s.testing?(u(),h("div",km,[e[3]||(e[3]=t("div",{class:"spinner"},null,-1)),t("p",null,"Ê≠£Âú®Ê∏¨Ë©¶ "+l(s.currentTest)+"...",1)])):_("",!0),t("div",Cm,[e[11]||(e[11]=t("h3",null,"üì° CORS Proxy ÊúçÂãôÁãÄÊÖã",-1)),t("div",Tm,[(u(!0),h(E,null,F(s.proxyResults,(b,P)=>{var I,L;return u(),h("div",{key:P,class:w(["proxy-card",i.getStatusClass(b.status)])},[t("div",Dm,[t("h4",null,"Proxy "+l(P+1)+": "+l(b.name),1),t("span",{class:w(["status-badge",i.getStatusClass(b.status)])},l(b.status),3)]),t("div",Am,[t("p",null,[e[4]||(e[4]=t("strong",null,"URL:",-1)),A(" "+l(b.url),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"ÈüøÊáâÊôÇÈñì:",-1)),A(" "+l(b.responseTime)+"ms",1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"HTTP ÁãÄÊÖã:",-1)),A(" "+l(b.httpStatus),1)]),b.error?(u(),h("div",Im,[t("p",null,[e[7]||(e[7]=t("strong",null,"ÈåØË™§È°ûÂûã:",-1)),A(" "+l(b.errorType),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"ÈåØË™§Ë®äÊÅØ:",-1)),A(" "+l(b.error),1)])])):_("",!0),b.data?(u(),h("div",xm,[t("p",null,[e[9]||(e[9]=t("strong",null,"Êï∏ÊìöÈªû:",-1)),A(" "+l(b.dataPoints),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"ÂÉπÊ†ºÁØÑÂúç:",-1)),A(" $"+l((I=b.priceRange)==null?void 0:I.min)+" - $"+l((L=b.priceRange)==null?void 0:L.max),1)])])):_("",!0)])],2)}),128))])]),t("div",Mm,[e[21]||(e[21]=t("h3",null,"üéØ Yahoo Finance API Áõ¥Êé•Ê∏¨Ë©¶",-1)),t("div",Nm,[t("div",Lm,[e[15]||(e[15]=t("h4",null,"Chart API (ÊäÄË°ìÊåáÊ®ôÊï∏Êìö)",-1)),t("div",{class:w(["test-result",i.getStatusClass((r=s.directApiResults.chart)==null?void 0:r.status)])},[t("p",null,[e[12]||(e[12]=t("strong",null,"ÁãÄÊÖã:",-1)),A(" "+l(((d=s.directApiResults.chart)==null?void 0:d.status)||"Êú™Ê∏¨Ë©¶"),1)]),(c=s.directApiResults.chart)!=null&&c.error?(u(),h("p",Pm,[e[13]||(e[13]=t("strong",null,"ÈåØË™§:",-1)),A(" "+l(s.directApiResults.chart.error),1)])):_("",!0),(g=s.directApiResults.chart)!=null&&g.dataPoints?(u(),h("p",$m,[e[14]||(e[14]=t("strong",null,"Êï∏ÊìöÈªû:",-1)),A(" "+l(s.directApiResults.chart.dataPoints),1)])):_("",!0)],2)]),t("div",Rm,[e[20]||(e[20]=t("h4",null,"Quote Summary API (ËÇ°Á•®Ë≥áË®ä)",-1)),t("div",{class:w(["test-result",i.getStatusClass((v=s.directApiResults.quoteSummary)==null?void 0:v.status)])},[t("p",null,[e[16]||(e[16]=t("strong",null,"ÁãÄÊÖã:",-1)),A(" "+l(((f=s.directApiResults.quoteSummary)==null?void 0:f.status)||"Êú™Ê∏¨Ë©¶"),1)]),(m=s.directApiResults.quoteSummary)!=null&&m.error?(u(),h("p",Em,[e[17]||(e[17]=t("strong",null,"ÈåØË™§:",-1)),A(" "+l(s.directApiResults.quoteSummary.error),1)])):_("",!0),(T=s.directApiResults.quoteSummary)!=null&&T.sector?(u(),h("p",Fm,[e[18]||(e[18]=t("strong",null,"Sector:",-1)),A(" "+l(s.directApiResults.quoteSummary.sector),1)])):_("",!0),(S=s.directApiResults.quoteSummary)!=null&&S.industry?(u(),h("p",Om,[e[19]||(e[19]=t("strong",null,"Industry:",-1)),A(" "+l(s.directApiResults.quoteSummary.industry),1)])):_("",!0)],2)])])]),t("div",Um,[e[27]||(e[27]=t("h3",null,"üåê Á∂≤Ë∑ØÁí∞Â¢ÉË≥áË®ä",-1)),t("div",Vm,[t("p",null,[e[22]||(e[22]=t("strong",null,"Áî®Êà∂‰ª£ÁêÜ:",-1)),A(" "+l(s.networkInfo.userAgent),1)]),t("p",null,[e[23]||(e[23]=t("strong",null,"Ë™ûË®Ä:",-1)),A(" "+l(s.networkInfo.language),1)]),t("p",null,[e[24]||(e[24]=t("strong",null,"ÊôÇÂçÄ:",-1)),A(" "+l(s.networkInfo.timezone),1)]),t("p",null,[e[25]||(e[25]=t("strong",null,"ÈÄ£Á∑öÈ°ûÂûã:",-1)),A(" "+l(s.networkInfo.connection),1)]),t("p",null,[e[26]||(e[26]=t("strong",null,"ÊòØÂê¶Âú®Á∑ö:",-1)),A(" "+l(s.networkInfo.online?"ÊòØ":"Âê¶"),1)])])]),s.diagnosticComplete?(u(),h("div",Wm,[e[34]||(e[34]=t("h3",null,"üí° Ë®∫Êñ∑ÁµêÊûúÂíåÂª∫Ë≠∞",-1)),t("div",Bm,[i.workingProxies.length>0?(u(),h("div",qm,[t("h4",null,"‚úÖ ÂèØÁî®ÁöÑ‰ª£ÁêÜÊúçÂãô ("+l(i.workingProxies.length)+"/"+l(s.proxyResults.length)+")",1),t("ul",null,[(u(!0),h(E,null,F(i.workingProxies,b=>(u(),h("li",{key:b.index},l(b.name)+" - ÈüøÊáâÊôÇÈñì: "+l(b.responseTime)+"ms ",1))),128))])])):_("",!0),i.failedProxies.length>0?(u(),h("div",Hm,[t("h4",null,"‚ùå Â§±ÊïóÁöÑ‰ª£ÁêÜÊúçÂãô ("+l(i.failedProxies.length)+"/"+l(s.proxyResults.length)+")",1),t("ul",null,[(u(!0),h(E,null,F(i.failedProxies,b=>(u(),h("li",{key:b.index},l(b.name)+" - "+l(b.errorType)+": "+l(b.error),1))),128))])])):_("",!0),t("div",zm,[e[33]||(e[33]=t("h4",null,"üîß Âª∫Ë≠∞Ëß£Ê±∫ÊñπÊ°à",-1)),i.workingProxies.length===0?(u(),h("div",jm,[...e[28]||(e[28]=[se("<p data-v-f967bfd3><strong data-v-f967bfd3>ÊâÄÊúâ‰ª£ÁêÜÈÉΩÂ§±Êïó‰∫ÜÔºåÂèØËÉΩÁöÑÂéüÂõ†ÂíåËß£Ê±∫ÊñπÊ°à:</strong></p><ul data-v-f967bfd3><li data-v-f967bfd3><strong data-v-f967bfd3>CORS ÊîøÁ≠ñ:</strong> ÁÄèË¶ΩÂô®ÈòªÊ≠¢Ë∑®ÂüüË´ãÊ±ÇÔºåËÄÉÊÖÆ‰ΩøÁî®ÊúçÂãôÁ´Ø‰ª£ÁêÜ</li><li data-v-f967bfd3><strong data-v-f967bfd3>‰ª£ÁêÜÊúçÂãôÈôêÂà∂:</strong> ÂÖçË≤ª‰ª£ÁêÜÊúçÂãôÂèØËÉΩÊúâ‰ΩøÁî®ÈôêÂà∂ÊàñÈúÄË¶ÅË™çË≠â</li><li data-v-f967bfd3><strong data-v-f967bfd3>Yahoo Finance API ËÆäÊõ¥:</strong> API Á´ØÈªûÊàñÊ†ºÂºèÂèØËÉΩÂ∑≤ËÆäÊõ¥</li><li data-v-f967bfd3><strong data-v-f967bfd3>Á∂≤Ë∑ØÈò≤ÁÅ´ÁâÜ:</strong> ÂÖ¨Âè∏ÊàñÂ≠∏Ê†°Á∂≤Ë∑ØÂèØËÉΩÈòªÊ≠¢Êüê‰∫õË´ãÊ±Ç</li></ul>",2)])])):(u(),h("div",Gm,[e[32]||(e[32]=t("p",null,[t("strong",null,"ÂÑ™ÂåñÂª∫Ë≠∞:")],-1)),t("ul",null,[t("li",null,"ÂÑ™ÂÖà‰ΩøÁî®ÈüøÊáâÊôÇÈñìÊúÄÂø´ÁöÑ‰ª£ÁêÜ: "+l((D=i.fastestProxy)==null?void 0:D.name),1),e[29]||(e[29]=t("li",null,"ÂØ¶ÊñΩ‰ª£ÁêÜËº™ÊèõÊ©üÂà∂‰ª•ÂàÜÊï£Ë≤†Ëºâ",-1)),e[30]||(e[30]=t("li",null,"Â¢ûÂä†ÈåØË™§ÈáçË©¶ÈÇèËºØ",-1)),e[31]||(e[31]=t("li",null,"ËÄÉÊÖÆÁ∑©Â≠òÊ©üÂà∂Ê∏õÂ∞ë API Ë™øÁî®",-1))])]))])])])):_("",!0)])}const Ym=R(ym,[["render",Qm],["__scopeId","data-v-f967bfd3"]]),Xm={name:"TechnicalIndicatorsManager",data(){return{loading:!1,testing:!1,showPreferences:!1,dataSourceStatus:null,testResults:[],preferences:{preferPrecomputed:!0,fallbackToRealtime:!0,maxAgeHours:24}}},async mounted(){await this.refreshStatus()},methods:{async refreshStatus(){this.loading=!0;try{this.dataSourceStatus=await Te.getDataSourceStatus()}catch(n){console.error("Failed to refresh status:",n),alert("Âà∑Êñ∞ÁãÄÊÖãÂ§±Êïó: "+n.message)}finally{this.loading=!1}},async clearAllCaches(){if(confirm("Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÁ∑©Â≠òÂóéÔºüÈÄôÂ∞áÂ∞éËá¥‰∏ãÊ¨°ËºâÂÖ•ÊôÇÈñìËºÉÈï∑„ÄÇ"))try{alert("ÊâÄÊúâÁ∑©Â≠òÂ∑≤Ê∏ÖÈô§"),await this.refreshStatus()}catch(n){alert("Ê∏ÖÈô§Á∑©Â≠òÂ§±Êïó: "+n.message)}},async testPrecomputed(){this.testing=!0,this.testResults=[];const n=["AAPL","TSLA","MSFT"];try{for(const e of n){const a=Date.now();try{const o=await Te.getTechnicalIndicators(e),s=Date.now()-a;this.testResults.push({symbol:e,success:!0,data:o,source:o.source,loadTime:`${s}ms`})}catch(o){this.testResults.push({symbol:e,success:!1,error:o.message,loadTime:`${Date.now()-a}ms`})}}}finally{this.testing=!1}},updatePreferences(){const n=this.preferences.maxAgeHours*60*60*1e3;Te.setPreferences({preferPrecomputed:this.preferences.preferPrecomputed,fallbackToRealtime:this.preferences.fallbackToRealtime,maxPrecomputedAge:n}),console.log("Preferences updated:",this.preferences)},formatDate(n){return n?new Date(n).toLocaleString("zh-TW"):"N/A"},formatBytes(n){if(n===0)return"0 B";const e=1024,a=["B","KB","MB"],o=Math.floor(Math.log(n)/Math.log(e));return parseFloat((n/Math.pow(e,o)).toFixed(2))+" "+a[o]}}},Km={class:"indicators-manager"},Jm={class:"status-section"},Zm={class:"status-grid"},ef={class:"status-header"},tf={key:0,class:"status-details"},sf={class:"status-card available"},af={class:"status-details"},nf={class:"status-card available"},of={class:"status-details"},rf={class:"control-section"},lf={class:"control-grid"},cf=["disabled"],df=["disabled"],uf={key:0,class:"preferences-section"},hf={class:"preferences-form"},gf={class:"form-group"},mf={class:"form-group"},ff={class:"form-group"},pf={key:1,class:"test-results-section"},vf={class:"test-results"},yf={class:"result-header"},wf={class:"symbol"},Sf={class:"source"},bf={class:"load-time"},_f={key:0,class:"error-message"},kf={key:1,class:"indicators-preview"},Cf={key:2,class:"symbols-section"},Tf={class:"symbols-grid"};function Df(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D,b,P,I,L,y,O,C,M;return u(),h("div",Km,[e[31]||(e[31]=t("div",{class:"manager-header"},[t("h2",null,"ÊäÄË°ìÊåáÊ®ôÁÆ°ÁêÜ‰∏≠ÂøÉ"),t("p",null,"Áõ£ÊéßÂíåÁÆ°ÁêÜÈ†êË®àÁÆóÊäÄË°ìÊåáÊ®ôÁ≥ªÁµ±")],-1)),t("div",Jm,[e[23]||(e[23]=t("h3",null,"Êï∏ÊìöÊ∫êÁãÄÊÖã",-1)),t("div",Zm,[t("div",{class:w(["status-card",{available:(d=(r=s.dataSourceStatus)==null?void 0:r.precomputed)==null?void 0:d.available}])},[t("div",ef,[e[10]||(e[10]=t("h4",null,"È†êË®àÁÆóÊï∏Êìö",-1)),t("span",{class:w(["status-badge",(g=(c=s.dataSourceStatus)==null?void 0:c.precomputed)!=null&&g.available?"success":"error"])},l((f=(v=s.dataSourceStatus)==null?void 0:v.precomputed)!=null&&f.available?"ÂèØÁî®":"‰∏çÂèØÁî®"),3)]),(T=(m=s.dataSourceStatus)==null?void 0:m.precomputed)!=null&&T.available?(u(),h("div",tf,[t("p",null,[e[11]||(e[11]=t("strong",null,"ËÇ°Á•®Êï∏Èáè:",-1)),A(" "+l(s.dataSourceStatus.precomputed.symbols.length),1)]),t("p",null,[e[12]||(e[12]=t("strong",null,"ÊàêÂäü:",-1)),A(" "+l(s.dataSourceStatus.precomputed.successful),1)]),t("p",null,[e[13]||(e[13]=t("strong",null,"Â§±Êïó:",-1)),A(" "+l(s.dataSourceStatus.precomputed.failed),1)]),t("p",null,[e[14]||(e[14]=t("strong",null,"ÊúÄÂæåÊõ¥Êñ∞:",-1)),A(" "+l(i.formatDate(s.dataSourceStatus.precomputed.lastUpdate)),1)])])):_("",!0)],2),t("div",sf,[e[18]||(e[18]=t("div",{class:"status-header"},[t("h4",null,"ÊØèÊó•Á∑©Â≠ò"),t("span",{class:"status-badge success"},"ÂèØÁî®")],-1)),t("div",af,[t("p",null,[e[15]||(e[15]=t("strong",null,"ÂÖßÂ≠òÁ∑©Â≠ò:",-1)),A(" "+l(((D=(S=s.dataSourceStatus)==null?void 0:S.cache)==null?void 0:D.memoryCache)||0)+" È†ÖÁõÆ",1)]),t("p",null,[e[16]||(e[16]=t("strong",null,"Êú¨Âú∞Â≠òÂÑ≤:",-1)),A(" "+l(((P=(b=s.dataSourceStatus)==null?void 0:b.cache)==null?void 0:P.localStorageCache)||0)+" È†ÖÁõÆ",1)]),t("p",null,[e[17]||(e[17]=t("strong",null,"Á∏ΩÂ§ßÂ∞è:",-1)),A(" "+l(i.formatBytes(((L=(I=s.dataSourceStatus)==null?void 0:I.cache)==null?void 0:L.totalSize)||0)),1)])])]),t("div",nf,[e[22]||(e[22]=t("div",{class:"status-header"},[t("h4",null,"ÂØ¶ÊôÇË®àÁÆó"),t("span",{class:"status-badge success"},"ÂèØÁî®")],-1)),t("div",of,[t("p",null,[e[19]||(e[19]=t("strong",null,"‰ª£ÁêÜÊúçÂãô:",-1)),A(" "+l(((O=(y=s.dataSourceStatus)==null?void 0:y.realtime)==null?void 0:O.proxies)||0)+" ÂÄã",1)]),e[20]||(e[20]=t("p",null,[t("strong",null,"ÁãÄÊÖã:"),A(" ÂÇôÁî®ÊñπÊ°à")],-1)),e[21]||(e[21]=t("p",null,[t("strong",null,"È†êÊúüÂª∂ÈÅ≤:"),A(" 2-20Áßí")],-1))])])])]),t("div",rf,[e[24]||(e[24]=t("h3",null,"ÊéßÂà∂Èù¢Êùø",-1)),t("div",lf,[t("button",{onClick:e[0]||(e[0]=p=>i.refreshStatus()),class:"control-btn primary",disabled:s.loading},l(s.loading?"ËºâÂÖ•‰∏≠...":"Âà∑Êñ∞ÁãÄÊÖã"),9,cf),t("button",{onClick:e[1]||(e[1]=p=>i.clearAllCaches()),class:"control-btn warning"}," Ê∏ÖÈô§ÊâÄÊúâÁ∑©Â≠ò "),t("button",{onClick:e[2]||(e[2]=p=>i.testPrecomputed()),class:"control-btn info",disabled:s.testing},l(s.testing?"Ê∏¨Ë©¶‰∏≠...":"Ê∏¨Ë©¶È†êË®àÁÆó"),9,df),t("button",{onClick:e[3]||(e[3]=p=>s.showPreferences=!s.showPreferences),class:"control-btn secondary"},l(s.showPreferences?"Èö±ËóèË®≠ÂÆö":"È°ØÁ§∫Ë®≠ÂÆö"),1)])]),s.showPreferences?(u(),h("div",uf,[e[28]||(e[28]=t("h3",null,"Á≥ªÁµ±ÂÅèÂ•ΩË®≠ÂÆö",-1)),t("div",hf,[t("div",gf,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=p=>s.preferences.preferPrecomputed=p),onChange:e[5]||(e[5]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.preferPrecomputed]]),e[25]||(e[25]=A(" ÂÑ™ÂÖà‰ΩøÁî®È†êË®àÁÆóÊï∏Êìö ",-1))])]),t("div",mf,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=p=>s.preferences.fallbackToRealtime=p),onChange:e[7]||(e[7]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.fallbackToRealtime]]),e[26]||(e[26]=A(" ÂÖÅË®±ÂõûÈÄÄÂà∞ÂØ¶ÊôÇË®àÁÆó ",-1))])]),t("div",ff,[e[27]||(e[27]=t("label",null,"È†êË®àÁÆóÊï∏ÊìöÊúÄÂ§ßÂπ¥ÈΩ° (Â∞èÊôÇ):",-1)),H(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=p=>s.preferences.maxAgeHours=p),onChange:e[9]||(e[9]=(...p)=>i.updatePreferences&&i.updatePreferences(...p)),min:"1",max:"72"},null,544),[[me,s.preferences.maxAgeHours,void 0,{number:!0}]])])])])):_("",!0),s.testResults.length>0?(u(),h("div",pf,[e[29]||(e[29]=t("h3",null,"Ê∏¨Ë©¶ÁµêÊûú",-1)),t("div",vf,[(u(!0),h(E,null,F(s.testResults,(p,B)=>{var j,k,q;return u(),h("div",{key:B,class:w(["test-result-item",{success:p.success,error:!p.success}])},[t("div",yf,[t("span",wf,l(p.symbol),1),t("span",Sf,l(p.source),1),t("span",bf,l(p.loadTime),1)]),p.error?(u(),h("div",_f,l(p.error),1)):(u(),h("div",kf,[t("span",null,"MA5: "+l(((j=p.data.ma5)==null?void 0:j.value)||"N/A"),1),t("span",null,"ADX: "+l(((k=p.data.adx14)==null?void 0:k.value)||"N/A"),1),t("span",null,"MACD: "+l(((q=p.data.macd)==null?void 0:q.signal)||"N/A"),1)]))],2)}),128))])])):_("",!0),(M=(C=s.dataSourceStatus)==null?void 0:C.precomputed)!=null&&M.available?(u(),h("div",Cf,[e[30]||(e[30]=t("h3",null,"È†êË®àÁÆóËÇ°Á•®ÂàóË°®",-1)),t("div",Tf,[(u(!0),h(E,null,F(s.dataSourceStatus.precomputed.symbols,p=>(u(),h("span",{key:p,class:"symbol-tag"},l(p),1))),128))])])):_("",!0)])}const Af=R(Xm,[["render",Df],["__scopeId","data-v-f7963fc0"]]),If={name:"AutoUpdateMonitor",data(){return{loading:!1,status:{},cacheStats:{},logs:[],config:{technicalIndicators:{enabled:!0,intervalHours:1,marketHoursOnly:!0},metadata:{enabled:!0,intervalHours:24}},configChanged:!1,startTime:null,technicalIndicatorsLastUpdate:null,technicalIndicatorsAge:0,technicalIndicatorsSuccessRate:0,metadataLastUpdate:null,metadataAge:0,metadataSymbolCount:0,warmupInfo:{isWarming:!1,progress:0,lastWarmupTime:null,trackedSymbols:[]}}},computed:{schedulerStatus(){return this.status.isRunning?"ÈÅãË°å‰∏≠":"Â∑≤ÂÅúÊ≠¢"},schedulerStatusClass(){return this.status.isRunning?"status-success":"status-error"},schedulerButtonText(){return this.status.isRunning?"ÂÅúÊ≠¢Ë™øÂ∫¶Âô®":"ÂïüÂãïË™øÂ∫¶Âô®"},schedulerButtonClass(){return this.status.isRunning?"btn btn-danger":"btn btn-success"},technicalIndicatorsStatus(){return this.technicalIndicatorsAge<1?"ÊúÄÊñ∞":this.technicalIndicatorsAge<12?"ËºÉÊñ∞":this.technicalIndicatorsAge<24?"ÈÅéÊôÇ":"ËàäÊï∏Êìö"},technicalIndicatorsStatusClass(){return this.technicalIndicatorsAge<1?"status-success":this.technicalIndicatorsAge<12?"status-warning":"status-error"},metadataStatus(){return this.metadataAge<24?"ÊúÄÊñ∞":this.metadataAge<72?"ËºÉÊñ∞":"ÈÅéÊôÇ"},metadataStatusClass(){return this.metadataAge<24?"status-success":this.metadataAge<72?"status-warning":"status-error"},cacheStatus(){const n=this.cacheStats.totalSize||0;return n>100?"ÈúÄË¶ÅÊ∏ÖÁêÜ":n>50?"Ê≠£Â∏∏":"ËâØÂ•Ω"},warmupStatus(){return this.warmupInfo.isWarming?"È†êÁÜ±‰∏≠":this.warmupInfo.progress===100?"Â∑≤ÂÆåÊàê":this.warmupInfo.lastWarmupTime?"ÂæÖÊ©ü‰∏≠":"Êú™È†êÁÜ±"},warmupStatusClass(){return this.warmupInfo.isWarming?"status-warning":this.warmupInfo.progress===100?"status-success":this.warmupInfo.lastWarmupTime?"status-info":"status-error"}},async mounted(){await this.initializeMonitor(),this.startPeriodicRefresh()},beforeUnmount(){this.refreshInterval&&clearInterval(this.refreshInterval)},methods:{async initializeMonitor(){this.loading=!0;try{await this.refreshStatus(),await this.loadTechnicalIndicatorsStatus(),await this.loadMetadataStatus(),await this.loadWarmupStatus(),this.startTime=new Date,this.addLog("Áõ£ÊéßÈù¢ÊùøÂ∑≤ÂàùÂßãÂåñ","INFO")}catch(n){this.addLog(`ÂàùÂßãÂåñÂ§±Êïó: ${n.message}`,"ERROR")}finally{this.loading=!1}},async refreshStatus(){try{this.status=ne.getStatus(),this.cacheStats=X.getStats()}catch(n){this.addLog(`Âà∑Êñ∞ÁãÄÊÖãÂ§±Êïó: ${n.message}`,"ERROR")}},async loadTechnicalIndicatorsStatus(){try{const n=window.location.hostname==="romarin-hsieh.github.io"?"/investment-dashboard/":"/",e=await fetch(`${n}data/technical-indicators/latest_index.json`);if(e.ok){const a=await e.json();this.technicalIndicatorsLastUpdate=new Date(a.generatedAt),this.technicalIndicatorsAge=(Date.now()-this.technicalIndicatorsLastUpdate)/(1e3*60*60),this.technicalIndicatorsSuccessRate=Math.round(a.successfulSymbols/a.totalSymbols*100)}}catch(n){this.addLog(`ËºâÂÖ•ÊäÄË°ìÊåáÊ®ôÁãÄÊÖãÂ§±Êïó: ${n.message}`,"ERROR")}},async loadMetadataStatus(){try{this.metadataLastUpdate=new Date,this.metadataAge=0,this.metadataSymbolCount=24}catch(n){this.addLog(`ËºâÂÖ•ÂÖÉÊï∏ÊìöÁãÄÊÖãÂ§±Êïó: ${n.message}`,"ERROR")}},async loadWarmupStatus(){try{this.warmupInfo=mt.getWarmupStatus()}catch(n){this.addLog(`ËºâÂÖ•È†êÁÜ±ÁãÄÊÖãÂ§±Êïó: ${n.message}`,"ERROR")}},async triggerWarmup(){this.loading=!0;try{this.addLog("ÊâãÂãïËß∏ÁôºÁ∑©Â≠òÈ†êÁÜ±","INFO"),await mt.triggerManualWarmup(),this.addLog("Á∑©Â≠òÈ†êÁÜ±ÂÆåÊàê","SUCCESS"),await this.loadWarmupStatus()}catch(n){this.addLog(`Á∑©Â≠òÈ†êÁÜ±Â§±Êïó: ${n.message}`,"ERROR")}finally{this.loading=!1}},async toggleScheduler(){this.loading=!0;try{this.status.isRunning?(ne.stop(),this.addLog("Ë™øÂ∫¶Âô®Â∑≤ÂÅúÊ≠¢","INFO")):(ne.start(),this.addLog("Ë™øÂ∫¶Âô®Â∑≤ÂïüÂãï","INFO")),await this.refreshStatus()}catch(n){this.addLog(`ÂàáÊèõË™øÂ∫¶Âô®Â§±Êïó: ${n.message}`,"ERROR")}finally{this.loading=!1}},async triggerUpdate(n){this.loading=!0;try{this.addLog(`ÊâãÂãïËß∏ÁôºÊõ¥Êñ∞: ${n}`,"INFO"),await ne.triggerManualUpdate(n),this.addLog(`ÊâãÂãïÊõ¥Êñ∞ÂÆåÊàê: ${n}`,"SUCCESS"),await this.refreshStatus(),n==="technicalIndicators"?await this.loadTechnicalIndicatorsStatus():n==="metadata"&&await this.loadMetadataStatus()}catch(e){this.addLog(`ÊâãÂãïÊõ¥Êñ∞Â§±Êïó: ${e.message}`,"ERROR")}finally{this.loading=!1}},startPeriodicRefresh(){this.refreshInterval=setInterval(async()=>{await this.refreshStatus(),await this.loadTechnicalIndicatorsStatus(),await this.loadMetadataStatus(),await this.loadWarmupStatus()},3e4)},addLog(n,e="INFO"){const a={timestamp:new Date,level:e,message:n};this.logs.unshift(a),this.logs.length>100&&(this.logs=this.logs.slice(0,100))},clearLogs(){this.logs=[],this.addLog("Êó•Ë™åÂ∑≤Ê∏ÖÈô§","INFO")},onConfigChange(){this.configChanged=!0},async saveConfig(){try{localStorage.setItem("autoUpdateConfig",JSON.stringify(this.config)),this.configChanged=!1,this.addLog("ÈÖçÁΩÆÂ∑≤‰øùÂ≠ò","SUCCESS")}catch(n){this.addLog(`‰øùÂ≠òÈÖçÁΩÆÂ§±Êïó: ${n.message}`,"ERROR")}},formatTime(n){return n?new Date(n).toLocaleString("zh-TW"):"N/A"},formatDataAge(n){return n<1?"< 1 Â∞èÊôÇ":n<24?`${Math.round(n)} Â∞èÊôÇ`:`${Math.round(n/24)} Â§©`},getDataAgeClass(n){return n<1?"text-success":n<12?"text-warning":"text-danger"},getLogLevelClass(n){return{"log-info":n==="INFO","log-success":n==="SUCCESS","log-warning":n==="WARN","log-error":n==="ERROR"}}}},xf={class:"auto-update-monitor"},Mf={class:"monitor-header"},Nf={class:"header-actions"},Lf=["disabled"],Pf={key:0},$f={key:1},Rf=["disabled"],Ef={class:"monitor-grid"},Ff={class:"status-card"},Of={class:"card-header"},Uf={class:"card-content"},Vf={class:"status-item"},Wf={class:"status-item"},Bf={class:"value"},qf={class:"status-item"},Hf={class:"value"},zf={class:"status-card"},jf={class:"card-header"},Gf={class:"card-content"},Qf={class:"status-item"},Yf={class:"value"},Xf={class:"status-item"},Kf={class:"status-item"},Jf={class:"value"},Zf={class:"status-item"},ep={class:"value"},tp={class:"card-actions"},sp=["disabled"],ap={class:"status-card"},np={class:"card-header"},ip={class:"card-content"},op={class:"status-item"},rp={class:"value"},lp={class:"status-item"},cp={class:"status-item"},dp={class:"value"},up={class:"status-item"},hp={class:"value"},gp={class:"card-actions"},mp=["disabled"],fp={class:"status-card"},pp={class:"card-header"},vp={class:"card-content"},yp={class:"status-item"},wp={class:"status-item"},Sp={class:"value"},bp={class:"status-item"},_p={class:"value"},kp={class:"status-item"},Cp={class:"value"},Tp={class:"card-actions"},Dp=["disabled"],Ap={class:"status-card"},Ip={class:"card-header"},xp={class:"status-indicator status-info"},Mp={class:"card-content"},Np={class:"status-item"},Lp={class:"value"},Pp={class:"status-item"},$p={class:"value"},Rp={class:"status-item"},Ep={class:"value"},Fp={class:"status-item"},Op={class:"value"},Up={class:"card-actions"},Vp=["disabled"],Wp={class:"update-logs"},Bp={class:"logs-header"},qp={class:"logs-content"},Hp={key:0,class:"no-logs"},zp={key:1,class:"log-entries"},jp={class:"log-time"},Gp={class:"log-level"},Qp={class:"log-message"},Yp={class:"config-panel"},Xp={class:"config-header"},Kp=["disabled"],Jp={class:"config-content"},Zp={class:"config-section"},ev={class:"config-item"},tv={class:"config-item"},sv={class:"config-item"},av={class:"config-section"},nv={class:"config-item"},iv={class:"config-item"};function ov(n,e,a,o,s,i){var r,d,c,g,v;return u(),h("div",xf,[t("div",Mf,[e[19]||(e[19]=t("h2",null,"Ëá™ÂãïÊõ¥Êñ∞Áõ£ÊéßÈù¢Êùø",-1)),t("div",Nf,[t("button",{onClick:e[0]||(e[0]=(...f)=>i.refreshStatus&&i.refreshStatus(...f)),class:"btn btn-secondary",disabled:s.loading},[s.loading?(u(),h("span",Pf,"üîÑ")):(u(),h("span",$f,"üîÑ")),e[18]||(e[18]=A(" Âà∑Êñ∞ÁãÄÊÖã ",-1))],8,Lf),t("button",{onClick:e[1]||(e[1]=(...f)=>i.toggleScheduler&&i.toggleScheduler(...f)),class:w(i.schedulerButtonClass),disabled:s.loading},l(i.schedulerButtonText),11,Rf)])]),t("div",Ef,[t("div",Ff,[t("div",Of,[e[20]||(e[20]=t("h3",null,"Ë™øÂ∫¶Âô®ÁãÄÊÖã",-1)),t("div",{class:w(["status-indicator",i.schedulerStatusClass])},l(i.schedulerStatus),3)]),t("div",Uf,[t("div",Vf,[e[21]||(e[21]=t("span",{class:"label"},"ÈÅãË°åÁãÄÊÖã:",-1)),t("span",{class:w(["value",i.schedulerStatusClass])},l(s.status.isRunning?"ÈÅãË°å‰∏≠":"Â∑≤ÂÅúÊ≠¢"),3)]),t("div",Wf,[e[22]||(e[22]=t("span",{class:"label"},"Ê¥ªÂãï‰ªªÂãô:",-1)),t("span",Bf,l(((r=s.status.activeIntervals)==null?void 0:r.length)||0)+" ÂÄã",1)]),t("div",qf,[e[23]||(e[23]=t("span",{class:"label"},"ÂïüÂãïÊôÇÈñì:",-1)),t("span",Hf,l(i.formatTime(s.startTime)),1)])])]),t("div",zf,[t("div",jf,[e[24]||(e[24]=t("h3",null,"ÊäÄË°ìÊåáÊ®ô",-1)),t("div",{class:w(["status-indicator",i.technicalIndicatorsStatusClass])},l(i.technicalIndicatorsStatus),3)]),t("div",Gf,[t("div",Qf,[e[25]||(e[25]=t("span",{class:"label"},"ÊúÄÂæåÊõ¥Êñ∞:",-1)),t("span",Yf,l(i.formatTime(s.technicalIndicatorsLastUpdate)),1)]),t("div",Xf,[e[26]||(e[26]=t("span",{class:"label"},"Êï∏ÊìöÂπ¥ÈΩ°:",-1)),t("span",{class:w(["value",i.getDataAgeClass(s.technicalIndicatorsAge)])},l(i.formatDataAge(s.technicalIndicatorsAge)),3)]),t("div",Kf,[e[27]||(e[27]=t("span",{class:"label"},"‰∏ãÊ¨°Êõ¥Êñ∞:",-1)),t("span",Jf,l(i.formatTime((d=s.status.nextUpdates)==null?void 0:d.technicalIndicators)),1)]),t("div",Zf,[e[28]||(e[28]=t("span",{class:"label"},"ÊàêÂäüÁéá:",-1)),t("span",ep,l(s.technicalIndicatorsSuccessRate)+"%",1)])]),t("div",tp,[t("button",{onClick:e[2]||(e[2]=f=>i.triggerUpdate("technicalIndicators")),class:"btn btn-primary btn-sm",disabled:s.loading}," Ê∏ÖÈô§Á∑©Â≠ò ",8,sp),e[29]||(e[29]=t("div",{class:"update-note"},[t("small",null,"Ë®ª: ÂØ¶ÈöõÈ†êË®àÁÆóÈúÄË¶ÅÂú®ÊúçÂãôÂô®Á´ØÂü∑Ë°å")],-1))])]),t("div",ap,[t("div",np,[e[30]||(e[30]=t("h3",null,"ÂÖÉÊï∏Êìö",-1)),t("div",{class:w(["status-indicator",i.metadataStatusClass])},l(i.metadataStatus),3)]),t("div",ip,[t("div",op,[e[31]||(e[31]=t("span",{class:"label"},"ÊúÄÂæåÊõ¥Êñ∞:",-1)),t("span",rp,l(i.formatTime(s.metadataLastUpdate)),1)]),t("div",lp,[e[32]||(e[32]=t("span",{class:"label"},"Êï∏ÊìöÂπ¥ÈΩ°:",-1)),t("span",{class:w(["value",i.getDataAgeClass(s.metadataAge)])},l(i.formatDataAge(s.metadataAge)),3)]),t("div",cp,[e[33]||(e[33]=t("span",{class:"label"},"‰∏ãÊ¨°Êõ¥Êñ∞:",-1)),t("span",dp,l(i.formatTime((c=s.status.nextUpdates)==null?void 0:c.metadata)),1)]),t("div",up,[e[34]||(e[34]=t("span",{class:"label"},"ËÇ°Á•®Êï∏Èáè:",-1)),t("span",hp,l(s.metadataSymbolCount)+" ÊîØ",1)])]),t("div",gp,[t("button",{onClick:e[3]||(e[3]=f=>i.triggerUpdate("metadata")),class:"btn btn-primary btn-sm",disabled:s.loading}," ÊâãÂãïÊõ¥Êñ∞ ",8,mp)])]),t("div",fp,[t("div",pp,[e[35]||(e[35]=t("h3",null,"Á∑©Â≠òÈ†êÁÜ±",-1)),t("div",{class:w(["status-indicator",i.warmupStatusClass])},l(i.warmupStatus),3)]),t("div",vp,[t("div",yp,[e[36]||(e[36]=t("span",{class:"label"},"È†êÁÜ±ÁãÄÊÖã:",-1)),t("span",{class:w(["value",i.warmupStatusClass])},l(s.warmupInfo.isWarming?"ÈÄ≤Ë°å‰∏≠":"ÂæÖÊ©ü‰∏≠"),3)]),t("div",wp,[e[37]||(e[37]=t("span",{class:"label"},"ÈÄ≤Â∫¶:",-1)),t("span",Sp,l(Math.round(s.warmupInfo.progress))+"%",1)]),t("div",bp,[e[38]||(e[38]=t("span",{class:"label"},"ËøΩËπ§ËÇ°Á•®:",-1)),t("span",_p,l(((g=s.warmupInfo.trackedSymbols)==null?void 0:g.length)||0)+" ÊîØ",1)]),t("div",kp,[e[39]||(e[39]=t("span",{class:"label"},"‰∏äÊ¨°È†êÁÜ±:",-1)),t("span",Cp,l(i.formatTime(s.warmupInfo.lastWarmupTime)),1)])]),t("div",Tp,[t("button",{onClick:e[4]||(e[4]=(...f)=>i.triggerWarmup&&i.triggerWarmup(...f)),class:"btn btn-info btn-sm",disabled:s.loading||s.warmupInfo.isWarming},l(s.warmupInfo.isWarming?"È†êÁÜ±‰∏≠...":"ÊâãÂãïÈ†êÁÜ±"),9,Dp),e[40]||(e[40]=t("div",{class:"update-note"},[t("small",null,"Ë®ª: È†êÁÜ±ÊâÄÊúâËÇ°Á•®ÁöÑÊäÄË°ìÊåáÊ®ôÊï∏Êìö")],-1))])]),t("div",Ap,[t("div",Ip,[e[41]||(e[41]=t("h3",null,"Á∑©Â≠òÁãÄÊÖã",-1)),t("div",xp,l(i.cacheStatus),1)]),t("div",Mp,[t("div",Np,[e[42]||(e[42]=t("span",{class:"label"},"ÂÖßÂ≠òÁ∑©Â≠ò:",-1)),t("span",Lp,l(s.cacheStats.memoryCache)+" È†Ö",1)]),t("div",Pp,[e[43]||(e[43]=t("span",{class:"label"},"Êú¨Âú∞Â≠òÂÑ≤:",-1)),t("span",$p,l(s.cacheStats.localStorage)+" È†Ö",1)]),t("div",Rp,[e[44]||(e[44]=t("span",{class:"label"},"Á∏ΩÂ§ßÂ∞è:",-1)),t("span",Ep,l(s.cacheStats.totalSize)+" È†Ö",1)]),t("div",Fp,[e[45]||(e[45]=t("span",{class:"label"},"‰∏ãÊ¨°Ê∏ÖÁêÜ:",-1)),t("span",Op,l(i.formatTime((v=s.status.nextUpdates)==null?void 0:v.cacheCleanup)),1)])]),t("div",Up,[t("button",{onClick:e[5]||(e[5]=f=>i.triggerUpdate("cache")),class:"btn btn-warning btn-sm",disabled:s.loading}," Ê∏ÖÁêÜÁ∑©Â≠ò ",8,Vp)])])]),t("div",Wp,[t("div",Bp,[e[46]||(e[46]=t("h3",null,"Êõ¥Êñ∞Êó•Ë™å",-1)),t("button",{onClick:e[6]||(e[6]=(...f)=>i.clearLogs&&i.clearLogs(...f)),class:"btn btn-sm btn-outline"},"Ê∏ÖÈô§Êó•Ë™å")]),t("div",qp,[s.logs.length===0?(u(),h("div",Hp," Êö´ÁÑ°Êó•Ë™åË®òÈåÑ ")):(u(),h("div",zp,[(u(!0),h(E,null,F(s.logs,(f,m)=>(u(),h("div",{key:m,class:w(["log-entry",i.getLogLevelClass(f.level)])},[t("span",jp,l(i.formatTime(f.timestamp)),1),t("span",Gp,l(f.level),1),t("span",Qp,l(f.message),1)],2))),128))]))])]),t("div",Yp,[t("div",Xp,[e[47]||(e[47]=t("h3",null,"ÈÖçÁΩÆË®≠ÂÆö",-1)),t("button",{onClick:e[7]||(e[7]=(...f)=>i.saveConfig&&i.saveConfig(...f)),class:"btn btn-success btn-sm",disabled:!s.configChanged}," ‰øùÂ≠òÈÖçÁΩÆ ",8,Kp)]),t("div",Jp,[t("div",Zp,[e[51]||(e[51]=t("h4",null,"ÊäÄË°ìÊåáÊ®ôÊõ¥Êñ∞",-1)),t("div",ev,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=f=>s.config.technicalIndicators.enabled=f),onChange:e[9]||(e[9]=(...f)=>i.onConfigChange&&i.onConfigChange(...f))},null,544),[[le,s.config.technicalIndicators.enabled]]),e[48]||(e[48]=A(" ÂïüÁî®Ëá™ÂãïÊõ¥Êñ∞ ",-1))])]),t("div",tv,[e[49]||(e[49]=t("label",null,"Êõ¥Êñ∞ÈñìÈöî (Â∞èÊôÇ):",-1)),H(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=f=>s.config.technicalIndicators.intervalHours=f),onChange:e[11]||(e[11]=(...f)=>i.onConfigChange&&i.onConfigChange(...f)),min:"1",max:"24"},null,544),[[me,s.config.technicalIndicators.intervalHours,void 0,{number:!0}]])]),t("div",sv,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=f=>s.config.technicalIndicators.marketHoursOnly=f),onChange:e[13]||(e[13]=(...f)=>i.onConfigChange&&i.onConfigChange(...f))},null,544),[[le,s.config.technicalIndicators.marketHoursOnly]]),e[50]||(e[50]=A(" ÂÉÖÂú®Â∏ÇÂ†¥ÊôÇÈñìÊõ¥Êñ∞ ",-1))])])]),t("div",av,[e[54]||(e[54]=t("h4",null,"ÂÖÉÊï∏ÊìöÊõ¥Êñ∞",-1)),t("div",nv,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=f=>s.config.metadata.enabled=f),onChange:e[15]||(e[15]=(...f)=>i.onConfigChange&&i.onConfigChange(...f))},null,544),[[le,s.config.metadata.enabled]]),e[52]||(e[52]=A(" ÂïüÁî®Ëá™ÂãïÊõ¥Êñ∞ ",-1))])]),t("div",iv,[e[53]||(e[53]=t("label",null,"Êõ¥Êñ∞ÈñìÈöî (Â∞èÊôÇ):",-1)),H(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=f=>s.config.metadata.intervalHours=f),onChange:e[17]||(e[17]=(...f)=>i.onConfigChange&&i.onConfigChange(...f)),min:"1",max:"168"},null,544),[[me,s.config.metadata.intervalHours,void 0,{number:!0}]])])])])])])}const rv=R(If,[["render",ov],["__scopeId","data-v-32573d8b"]]),lv={name:"SystemManager",data(){return{loading:!1,testing:!1,showAdvanced:!1,systemHealth:{overall:85,dataSource:90,performance:80,updates:85},dataSourceStatus:null,status:{isRunning:!1,activeIntervals:[],nextUpdates:{}},startTime:null,performanceScore:85,cacheHitRate:78,preferences:{preferPrecomputed:!0,fallbackToRealtime:!0,technicalIndicatorsInterval:30,metadataInterval:24,enablePerformanceMonitoring:!0,enableCacheWarmup:!0},systemLogs:[],logIdCounter:0}},computed:{schedulerStatus(){return this.status.isRunning?"ÈÅãË°å‰∏≠":"Â∑≤ÂÅúÊ≠¢"},schedulerStatusClass(){return this.status.isRunning?"success":"error"},schedulerButtonClass(){return this.status.isRunning?"btn btn-warning":"btn btn-success"},schedulerButtonText(){return this.status.isRunning?"ÂÅúÊ≠¢Ë™øÂ∫¶Âô®":"ÂïüÂãïË™øÂ∫¶Âô®"},technicalIndicatorsStatus(){return"Ê≠£Â∏∏"},technicalIndicatorsStatusClass(){return"success"},technicalIndicatorsLastUpdate(){return new Date().toISOString()},technicalIndicatorsAge(){return 30*60*1e3},technicalIndicatorsSuccessRate(){return 95},metadataStatus(){return"Ê≠£Â∏∏"},metadataStatusClass(){return"success"},metadataLastUpdate(){return new Date().toISOString()},metadataAge(){return 2*60*60*1e3}},async mounted(){await this.initializeSystem(),this.startStatusUpdates()},methods:{async initializeSystem(){this.addLog("info","Á≥ªÁµ±ÁÆ°ÁêÜÈù¢ÊùøÂàùÂßãÂåñ‰∏≠...");try{await this.refreshAllStatus(),this.addLog("info","Á≥ªÁµ±ÁÆ°ÁêÜÈù¢ÊùøÂàùÂßãÂåñÂÆåÊàê")}catch(n){this.addLog("error",`Á≥ªÁµ±ÂàùÂßãÂåñÂ§±Êïó: ${n.message}`)}},async refreshAllStatus(){this.loading=!0,this.addLog("info","ÈñãÂßãÂÖ®Èù¢ÁãÄÊÖãÂà∑Êñ∞...");try{await this.refreshDataSources(),this.refreshSchedulerStatus(),this.updatePerformanceMetrics(),this.updateSystemHealth(),this.addLog("info","ÂÖ®Èù¢ÁãÄÊÖãÂà∑Êñ∞ÂÆåÊàê")}catch(n){this.addLog("error",`ÁãÄÊÖãÂà∑Êñ∞Â§±Êïó: ${n.message}`)}finally{this.loading=!1}},async refreshDataSources(){try{this.dataSourceStatus=await Te.getDataSourceStatus(),this.addLog("info","Êï∏ÊìöÊ∫êÁãÄÊÖãÂ∑≤Êõ¥Êñ∞")}catch(n){this.addLog("error",`Êï∏ÊìöÊ∫êÁãÄÊÖãÊõ¥Êñ∞Â§±Êïó: ${n.message}`)}},refreshSchedulerStatus(){this.status=ne.getStatus(),this.startTime=ne.getStartTime(),this.addLog("info","Ë™øÂ∫¶Âô®ÁãÄÊÖãÂ∑≤Êõ¥Êñ∞")},updatePerformanceMetrics(){const n=X.getStats();Ce.getAllMetrics(),this.performanceScore=Math.min(100,60+n.totalSize*2),this.cacheHitRate=Math.min(100,50+n.totalSize*3),this.addLog("info","ÊïàËÉΩÊåáÊ®ôÂ∑≤Êõ¥Êñ∞")},updateSystemHealth(){var a,o;const n=(o=(a=this.dataSourceStatus)==null?void 0:a.precomputed)!=null&&o.available?100:70,e=this.status.isRunning?100:50;this.systemHealth={overall:Math.round((n+this.performanceScore+e)/3),dataSource:n,performance:this.performanceScore,updates:e}},async toggleScheduler(){this.loading=!0;try{this.status.isRunning?(ne.stop(),this.addLog("info","Ëá™ÂãïÊõ¥Êñ∞Ë™øÂ∫¶Âô®Â∑≤ÂÅúÊ≠¢")):(ne.start(),this.addLog("info","Ëá™ÂãïÊõ¥Êñ∞Ë™øÂ∫¶Âô®Â∑≤ÂïüÂãï")),this.refreshSchedulerStatus()}catch(n){this.addLog("error",`Ë™øÂ∫¶Âô®Êìç‰ΩúÂ§±Êïó: ${n.message}`)}finally{this.loading=!1}},async triggerUpdate(n){this.loading=!0,this.addLog("info",`Ëß∏Áôº ${n} Êõ¥Êñ∞...`);try{n==="technicalIndicators"?(X.clear(),this.addLog("info","ÊäÄË°ìÊåáÊ®ôÂø´ÂèñÂ∑≤Ê∏ÖÈô§")):n==="metadata"&&(X.clear(),this.addLog("info","ÂÖÉÊï∏ÊìöÂø´ÂèñÂ∑≤Ê∏ÖÈô§")),await this.refreshDataSources()}catch(e){this.addLog("error",`${n} Êõ¥Êñ∞Â§±Êïó: ${e.message}`)}finally{this.loading=!1}},async clearAllCaches(){if(confirm("Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÂø´ÂèñÂóéÔºüÈÄôÂ∞áÂΩ±ÈüøÁ≥ªÁµ±ÊïàËÉΩ„ÄÇ")){this.loading=!0,this.addLog("warning","ÈñãÂßãÊ∏ÖÈô§ÊâÄÊúâÂø´Âèñ...");try{X.clear(),localStorage.clear(),sessionStorage.clear(),this.addLog("info","ÊâÄÊúâÂø´ÂèñÂ∑≤Ê∏ÖÈô§"),await this.refreshAllStatus()}catch(n){this.addLog("error",`Ê∏ÖÈô§Âø´ÂèñÂ§±Êïó: ${n.message}`)}finally{this.loading=!1}}},async testSystemHealth(){this.testing=!0,this.addLog("info","ÈñãÂßãÁ≥ªÁµ±ÂÅ•Â∫∑Ê™¢Êü•...");try{await new Promise(e=>setTimeout(e,2e3));const n=Math.floor(Math.random()*20)+80;this.systemHealth.overall=n,this.addLog("info",`Á≥ªÁµ±ÂÅ•Â∫∑Ê™¢Êü•ÂÆåÊàêÔºåÂæóÂàÜ: ${n}%`)}catch(n){this.addLog("error",`Á≥ªÁµ±ÂÅ•Â∫∑Ê™¢Êü•Â§±Êïó: ${n.message}`)}finally{this.testing=!1}},updatePreferences(){Te.setPreferences({preferPrecomputed:this.preferences.preferPrecomputed,fallbackToRealtime:this.preferences.fallbackToRealtime}),this.addLog("info","Á≥ªÁµ±ÂÅèÂ•ΩË®≠ÂÆöÂ∑≤Êõ¥Êñ∞")},startStatusUpdates(){setInterval(()=>{this.loading||(this.refreshSchedulerStatus(),this.updatePerformanceMetrics(),this.updateSystemHealth())},3e4)},getHealthStatus(n){return n>=90?"ÂÑ™ÁßÄ":n>=80?"ËâØÂ•Ω":n>=70?"‰∏ÄËà¨":"ÈúÄË¶ÅÈóúÊ≥®"},getDataAgeClass(n){const e=n/36e5;return e<1?"fresh":e<6?"stale":"very-stale"},formatTime(n){return n?new Date(n).toLocaleString("zh-TW"):"N/A"},formatDataAge(n){if(!n)return"N/A";const e=Math.floor(n/(1e3*60)),a=Math.floor(e/60),o=Math.floor(a/24);return o>0?`${o} Â§©Ââç`:a>0?`${a} Â∞èÊôÇÂâç`:`${e} ÂàÜÈêòÂâç`},addLog(n,e){this.systemLogs.push({id:++this.logIdCounter,timestamp:new Date().toISOString(),level:n,message:e}),this.systemLogs.length>100&&(this.systemLogs=this.systemLogs.slice(-100))},clearLogs(){this.systemLogs=[],this.logIdCounter=0}}},cv={class:"system-manager"},dv={class:"overview-section"},uv={class:"overview-grid"},hv={class:"card-content"},gv={class:"health-score"},mv={class:"health-status"},fv={class:"overview-card"},pv={class:"card-content"},vv={class:"data-sources"},yv={class:"overview-card"},wv={class:"card-content"},Sv={class:"update-info"},bv={class:"overview-card"},_v={class:"card-content"},kv={class:"performance-score"},Cv={class:"performance-info"},Tv={class:"details-section"},Dv={class:"details-grid"},Av={class:"detail-card"},Iv={class:"card-header"},xv=["disabled"],Mv={class:"data-source-list"},Nv={class:"source-header"},Lv={key:0,class:"source-details"},Pv={class:"detail-row"},$v={class:"detail-row"},Rv={class:"detail-row"},Ev={class:"source-item available"},Fv={class:"source-details"},Ov={class:"detail-row"},Uv={class:"detail-row"},Vv={class:"detail-row"},Wv={class:"detail-card"},Bv={class:"card-header"},qv=["disabled"],Hv={class:"update-details"},zv={class:"update-item"},jv={class:"update-header"},Gv={class:"update-info"},Qv={class:"detail-row"},Yv={class:"detail-row"},Xv={class:"detail-row"},Kv={class:"update-actions"},Jv=["disabled"],Zv={class:"update-item"},ey={class:"update-header"},ty={class:"update-info"},sy={class:"detail-row"},ay={class:"detail-row"},ny={class:"update-actions"},iy=["disabled"],oy={class:"control-section"},ry={class:"control-grid"},ly=["disabled"],cy=["disabled"],dy={key:0,class:"advanced-section"},uy={class:"settings-grid"},hy={class:"setting-group"},gy={class:"setting-item"},my={class:"setting-item"},fy={class:"setting-group"},py={class:"setting-item"},vy={class:"setting-item"},yy={class:"setting-group"},wy={class:"setting-item"},Sy={class:"setting-item"},by={class:"logs-section"},_y={class:"logs-header"},ky={class:"logs-container"},Cy={class:"log-time"},Ty={class:"log-level"},Dy={class:"log-message"},Ay={key:0,class:"no-logs"};function Iy(n,e,a,o,s,i){var r,d,c,g,v,f,m,T,S,D,b,P,I,L,y,O,C,M;return u(),h("div",cv,[e[66]||(e[66]=t("div",{class:"manager-header"},[t("h2",null,"Control Panel"),t("p",null,"Áõ£ÊéßÂíåÁÆ°ÁêÜÊäïË≥áÂÑÄË°®ÊùøÁöÑÂêÑÈ†ÖÁ≥ªÁµ±ÂäüËÉΩ")],-1)),t("div",dv,[t("div",uv,[t("div",{class:w(["overview-card",{healthy:s.systemHealth.overall>=80}])},[e[22]||(e[22]=t("div",{class:"card-icon"},"üéØ",-1)),t("div",hv,[e[21]||(e[21]=t("h3",null,"Á≥ªÁµ±ÂÅ•Â∫∑Â∫¶",-1)),t("div",gv,l(s.systemHealth.overall)+"%",1),t("div",mv,l(i.getHealthStatus(s.systemHealth.overall)),1)])],2),t("div",fv,[e[26]||(e[26]=t("div",{class:"card-icon"},"üìä",-1)),t("div",pv,[e[25]||(e[25]=t("h3",null,"Êï∏ÊìöÊ∫êÁãÄÊÖã",-1)),t("div",vv,[t("span",{class:w(["source-item",{active:(d=(r=s.dataSourceStatus)==null?void 0:r.precomputed)==null?void 0:d.available}])}," È†êË®àÁÆó "+l((g=(c=s.dataSourceStatus)==null?void 0:c.precomputed)!=null&&g.available?"‚úÖ":"‚ùå"),3),e[23]||(e[23]=t("span",{class:"source-item active"},"Âø´Âèñ ‚úÖ",-1)),e[24]||(e[24]=t("span",{class:"source-item active"},"ÂØ¶ÊôÇ ‚úÖ",-1))])])]),t("div",yv,[e[28]||(e[28]=t("div",{class:"card-icon"},"üîÑ",-1)),t("div",wv,[e[27]||(e[27]=t("h3",null,"Ëá™ÂãïÊõ¥Êñ∞",-1)),t("div",{class:w(["update-status",i.schedulerStatusClass])},l(s.status.isRunning?"ÈÅãË°å‰∏≠":"Â∑≤ÂÅúÊ≠¢"),3),t("div",Sv," Ê¥ªÂãï‰ªªÂãô: "+l(((v=s.status.activeIntervals)==null?void 0:v.length)||0)+" ÂÄã ",1)])]),t("div",bv,[e[30]||(e[30]=t("div",{class:"card-icon"},"‚ö°",-1)),t("div",_v,[e[29]||(e[29]=t("h3",null,"ÊïàËÉΩÁãÄÊÖã",-1)),t("div",kv,l(s.performanceScore)+"%",1),t("div",Cv," Âø´ÂèñÂëΩ‰∏≠Áéá: "+l(s.cacheHitRate)+"% ",1)])])])]),t("div",Tv,[t("div",Dv,[t("div",Av,[t("div",Iv,[e[31]||(e[31]=t("h3",null,"üìä Êï∏ÊìöÊ∫êÁÆ°ÁêÜ",-1)),t("button",{onClick:e[0]||(e[0]=(...p)=>i.refreshDataSources&&i.refreshDataSources(...p)),class:"btn btn-sm",disabled:s.loading},l((s.loading,"üîÑ"))+" Âà∑Êñ∞ ",9,xv)]),t("div",Mv,[t("div",{class:w(["source-item",{available:(m=(f=s.dataSourceStatus)==null?void 0:f.precomputed)==null?void 0:m.available}])},[t("div",Nv,[e[32]||(e[32]=t("h4",null,"È†êË®àÁÆóÊï∏Êìö",-1)),t("span",{class:w(["status-badge",(S=(T=s.dataSourceStatus)==null?void 0:T.precomputed)!=null&&S.available?"success":"error"])},l((b=(D=s.dataSourceStatus)==null?void 0:D.precomputed)!=null&&b.available?"ÂèØÁî®":"‰∏çÂèØÁî®"),3)]),(I=(P=s.dataSourceStatus)==null?void 0:P.precomputed)!=null&&I.available?(u(),h("div",Lv,[t("div",Pv,[e[33]||(e[33]=t("span",null,"ËÇ°Á•®Êï∏Èáè:",-1)),t("span",null,l(((L=s.dataSourceStatus.precomputed.symbols)==null?void 0:L.length)||0),1)]),t("div",$v,[e[34]||(e[34]=t("span",null,"ÊàêÂäü/Â§±Êïó:",-1)),t("span",null,l(s.dataSourceStatus.precomputed.successful||0)+"/"+l(s.dataSourceStatus.precomputed.failed||0),1)]),t("div",Rv,[e[35]||(e[35]=t("span",null,"ÊúÄÂæåÊõ¥Êñ∞:",-1)),t("span",null,l(i.formatTime(s.dataSourceStatus.precomputed.lastUpdate)),1)])])):_("",!0)],2),t("div",Ev,[e[39]||(e[39]=t("div",{class:"source-header"},[t("h4",null,"Âø´ÂèñÁ≥ªÁµ±"),t("span",{class:"status-badge success"},"Ê≠£Â∏∏")],-1)),t("div",Fv,[t("div",Ov,[e[36]||(e[36]=t("span",null,"ÂÖßÂ≠òÂø´Âèñ:",-1)),t("span",null,l(((O=(y=s.dataSourceStatus)==null?void 0:y.cache)==null?void 0:O.memoryCache)||0)+" È†ÖÁõÆ",1)]),t("div",Uv,[e[37]||(e[37]=t("span",null,"Êú¨Âú∞Â≠òÂÑ≤:",-1)),t("span",null,l(((M=(C=s.dataSourceStatus)==null?void 0:C.cache)==null?void 0:M.localStorageCache)||0)+" È†ÖÁõÆ",1)]),t("div",Vv,[e[38]||(e[38]=t("span",null,"ÂëΩ‰∏≠Áéá:",-1)),t("span",null,l(s.cacheHitRate)+"%",1)])])])])]),t("div",Wv,[t("div",Bv,[e[40]||(e[40]=t("h3",null,"üîÑ Ëá™ÂãïÊõ¥Êñ∞ÁÆ°ÁêÜ",-1)),t("button",{onClick:e[1]||(e[1]=(...p)=>i.toggleScheduler&&i.toggleScheduler(...p)),class:w(i.schedulerButtonClass),disabled:s.loading},l(i.schedulerButtonText),11,qv)]),t("div",Hv,[t("div",zv,[t("div",jv,[e[41]||(e[41]=t("h4",null,"ÊäÄË°ìÊåáÊ®ô",-1)),t("div",{class:w(["status-indicator",i.technicalIndicatorsStatusClass])},l(i.technicalIndicatorsStatus),3)]),t("div",Gv,[t("div",Qv,[e[42]||(e[42]=t("span",null,"ÊúÄÂæåÊõ¥Êñ∞:",-1)),t("span",null,l(i.formatTime(i.technicalIndicatorsLastUpdate)),1)]),t("div",Yv,[e[43]||(e[43]=t("span",null,"Êï∏ÊìöÂπ¥ÈΩ°:",-1)),t("span",{class:w(i.getDataAgeClass(i.technicalIndicatorsAge))},l(i.formatDataAge(i.technicalIndicatorsAge)),3)]),t("div",Xv,[e[44]||(e[44]=t("span",null,"ÊàêÂäüÁéá:",-1)),t("span",null,l(i.technicalIndicatorsSuccessRate)+"%",1)])]),t("div",Kv,[t("button",{onClick:e[2]||(e[2]=p=>i.triggerUpdate("technicalIndicators")),class:"btn btn-sm btn-primary",disabled:s.loading}," Ê∏ÖÈô§Âø´Âèñ ",8,Jv)])]),t("div",Zv,[t("div",ey,[e[45]||(e[45]=t("h4",null,"ÂÖÉÊï∏Êìö",-1)),t("div",{class:w(["status-indicator",i.metadataStatusClass])},l(i.metadataStatus),3)]),t("div",ty,[t("div",sy,[e[46]||(e[46]=t("span",null,"ÊúÄÂæåÊõ¥Êñ∞:",-1)),t("span",null,l(i.formatTime(i.metadataLastUpdate)),1)]),t("div",ay,[e[47]||(e[47]=t("span",null,"Êï∏ÊìöÂπ¥ÈΩ°:",-1)),t("span",{class:w(i.getDataAgeClass(i.metadataAge))},l(i.formatDataAge(i.metadataAge)),3)])]),t("div",ny,[t("button",{onClick:e[3]||(e[3]=p=>i.triggerUpdate("metadata")),class:"btn btn-sm btn-primary",disabled:s.loading}," Ê∏ÖÈô§Âø´Âèñ ",8,iy)])])])])])]),t("div",oy,[e[52]||(e[52]=t("div",{class:"control-header"},[t("h3",null,"üéõÔ∏è Á≥ªÁµ±ÊéßÂà∂")],-1)),t("div",ry,[t("button",{onClick:e[4]||(e[4]=(...p)=>i.refreshAllStatus&&i.refreshAllStatus(...p)),class:"control-btn primary",disabled:s.loading},[e[48]||(e[48]=t("span",{class:"btn-icon"},"üîÑ",-1)),A(" "+l(s.loading?"Âà∑Êñ∞‰∏≠...":"ÂÖ®Èù¢Âà∑Êñ∞"),1)],8,ly),t("button",{onClick:e[5]||(e[5]=(...p)=>i.clearAllCaches&&i.clearAllCaches(...p)),class:"control-btn warning"},[...e[49]||(e[49]=[t("span",{class:"btn-icon"},"üóëÔ∏è",-1),A(" Ê∏ÖÈô§ÊâÄÊúâÂø´Âèñ ",-1)])]),t("button",{onClick:e[6]||(e[6]=(...p)=>i.testSystemHealth&&i.testSystemHealth(...p)),class:"control-btn info",disabled:s.testing},[e[50]||(e[50]=t("span",{class:"btn-icon"},"üîç",-1)),A(" "+l(s.testing?"Ê∏¨Ë©¶‰∏≠...":"Á≥ªÁµ±ÂÅ•Ê™¢"),1)],8,cy),t("button",{onClick:e[7]||(e[7]=p=>s.showAdvanced=!s.showAdvanced),class:"control-btn secondary"},[e[51]||(e[51]=t("span",{class:"btn-icon"},"‚öôÔ∏è",-1)),A(" "+l(s.showAdvanced?"Èö±ËóèÈÄ≤Èöé":"ÈÄ≤ÈöéË®≠ÂÆö"),1)])])]),s.showAdvanced?(u(),h("div",dy,[e[64]||(e[64]=t("div",{class:"advanced-header"},[t("h3",null,"‚öôÔ∏è ÈÄ≤ÈöéË®≠ÂÆö")],-1)),t("div",uy,[t("div",hy,[e[55]||(e[55]=t("h4",null,"Êï∏ÊìöÊ∫êÂÅèÂ•Ω",-1)),t("div",gy,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=p=>s.preferences.preferPrecomputed=p),onChange:e[9]||(e[9]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.preferPrecomputed]]),e[53]||(e[53]=A(" ÂÑ™ÂÖà‰ΩøÁî®È†êË®àÁÆóÊï∏Êìö ",-1))])]),t("div",my,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=p=>s.preferences.fallbackToRealtime=p),onChange:e[11]||(e[11]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.fallbackToRealtime]]),e[54]||(e[54]=A(" ÂÖÅË®±ÂõûÈÄÄÂà∞ÂØ¶ÊôÇË®àÁÆó ",-1))])])]),t("div",fy,[e[60]||(e[60]=t("h4",null,"Êõ¥Êñ∞È†ªÁéá",-1)),t("div",py,[e[57]||(e[57]=t("label",null,"ÊäÄË°ìÊåáÊ®ôÊõ¥Êñ∞ÈñìÈöî (ÂàÜÈêò):",-1)),H(t("select",{"onUpdate:modelValue":e[12]||(e[12]=p=>s.preferences.technicalIndicatorsInterval=p),onChange:e[13]||(e[13]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},[...e[56]||(e[56]=[t("option",{value:"5"},"5 ÂàÜÈêò",-1),t("option",{value:"15"},"15 ÂàÜÈêò",-1),t("option",{value:"30"},"30 ÂàÜÈêò",-1),t("option",{value:"60"},"1 Â∞èÊôÇ",-1)])],544),[[ht,s.preferences.technicalIndicatorsInterval]])]),t("div",vy,[e[59]||(e[59]=t("label",null,"ÂÖÉÊï∏ÊìöÊõ¥Êñ∞ÈñìÈöî (Â∞èÊôÇ):",-1)),H(t("select",{"onUpdate:modelValue":e[14]||(e[14]=p=>s.preferences.metadataInterval=p),onChange:e[15]||(e[15]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},[...e[58]||(e[58]=[t("option",{value:"6"},"6 Â∞èÊôÇ",-1),t("option",{value:"12"},"12 Â∞èÊôÇ",-1),t("option",{value:"24"},"24 Â∞èÊôÇ",-1),t("option",{value:"168"},"1 ÈÄ±",-1)])],544),[[ht,s.preferences.metadataInterval]])])]),t("div",yy,[e[63]||(e[63]=t("h4",null,"ÊïàËÉΩË®≠ÂÆö",-1)),t("div",wy,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=p=>s.preferences.enablePerformanceMonitoring=p),onChange:e[17]||(e[17]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.enablePerformanceMonitoring]]),e[61]||(e[61]=A(" ÂïüÁî®ÊïàËÉΩÁõ£Êéß ",-1))])]),t("div",Sy,[t("label",null,[H(t("input",{type:"checkbox","onUpdate:modelValue":e[18]||(e[18]=p=>s.preferences.enableCacheWarmup=p),onChange:e[19]||(e[19]=(...p)=>i.updatePreferences&&i.updatePreferences(...p))},null,544),[[le,s.preferences.enableCacheWarmup]]),e[62]||(e[62]=A(" ÂïüÁî®Âø´ÂèñÈ†êÁÜ± ",-1))])])])])])):_("",!0),t("div",by,[t("div",_y,[e[65]||(e[65]=t("h3",null,"üìã Á≥ªÁµ±Êó•Ë™å",-1)),t("button",{onClick:e[20]||(e[20]=(...p)=>i.clearLogs&&i.clearLogs(...p)),class:"btn btn-sm"},"Ê∏ÖÈô§Êó•Ë™å")]),t("div",ky,[(u(!0),h(E,null,F(s.systemLogs.slice(-10),p=>(u(),h("div",{key:p.id,class:w(["log-entry",p.level])},[t("span",Cy,l(i.formatTime(p.timestamp)),1),t("span",Ty,l(p.level.toUpperCase()),1),t("span",Dy,l(p.message),1)],2))),128)),s.systemLogs.length===0?(u(),h("div",Ay," Êö´ÁÑ°Á≥ªÁµ±Êó•Ë™å ")):_("",!0)])])])}const xy=R(lv,[["render",Iy],["__scopeId","data-v-729e0df5"]]),My=[{path:"/",redirect:"/market-overview"},{path:"/market-overview",component:Hn,name:"market-overview"},{path:"/stock-overview",component:Dr,name:"stock-overview"},{path:"/stock-overview/symbols/:symbol",component:uu,name:"stock-detail"},{path:"/market-dashboard",redirect:"/market-overview"},{path:"/stock-dashboard",redirect:"/stock-overview"},{path:"/stock-dashboard/symbols/:symbol",redirect:n=>`/stock-overview/symbols/${n.params.symbol}`},{path:"/settings",component:Mr,name:"settings"},{path:"/top-stories-test",component:Ru,name:"top-stories-test"},{path:"/stock-market-insight-test",component:hh,name:"stock-market-insight-test"},{path:"/yahoo-finance-test",component:fg,name:"yahoo-finance-test"},{path:"/proxy-diagnostic",component:Ym,name:"proxy-diagnostic"},{path:"/technical-validation",component:Eg,name:"technical-validation"},{path:"/metadata-test",component:vm,name:"metadata-test"},{path:"/technical-manager",component:Af,name:"technical-manager"},{path:"/auto-update-monitor",component:rv,name:"auto-update-monitor"},{path:"/system-manager",component:xy,name:"system-manager"},{path:"/:pathMatch(.*)*",redirect:"/market-overview"}],Ny=xs({history:Ms(),routes:My}),_s=Ns(Gs);_s.use(Ny);_s.mount("#app");setTimeout(()=>{console.log("üöÄ Initializing auto-update scheduler..."),ne.start()},1e4);setTimeout(()=>{console.log("üî• Initializing cache warmup service..."),mt.start()},5e3);export{ot as p};
//# sourceMappingURL=index-Cx0f3ccs.js.map
